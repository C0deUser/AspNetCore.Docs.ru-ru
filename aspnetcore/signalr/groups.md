---
title: Управление пользователями и группами вSignalR
author: bradygaster
description: Общие сведения о SignalR ASP.NET Core управлении пользователями и группами.
monikerRange: '>= aspnetcore-2.1'
ms.author: bradyg
ms.custom: mvc
ms.date: 11/12/2019
no-loc:
- Blazor
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: signalr/groups
ms.openlocfilehash: af498575899fcfa407aba9f9f49c0bfeabadc7a7
ms.sourcegitcommit: 70e5f982c218db82aa54aa8b8d96b377cfc7283f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2020
ms.locfileid: "82776302"
---
# <a name="manage-users-and-groups-in-signalr"></a>Управление пользователями и группами вSignalR

По [Бреннан Конрой](https://github.com/BrennanConroy)

SignalRразрешает отправлять сообщения всем соединениям, связанным с конкретным пользователем, а также именованным группам подключений.

[Просмотр или скачивание образца кода](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/signalr/groups/sample/) [(Загрузка)](xref:index#how-to-download-a-sample)

## <a name="users-in-signalr"></a>Пользователи вSignalR

SignalRпозволяет передавать сообщения всем соединениям, связанным с конкретным пользователем. По умолчанию SignalR использует `ClaimTypes.NameIdentifier` из из, `ClaimsPrincipal` связанного с соединением, в качестве идентификатора пользователя. Один пользователь может иметь несколько подключений к SignalR приложению. Например, пользователь может подключаться к рабочему столу, а также по телефону. Каждое устройство имеет отдельное SignalR соединение, но все они связаны с одним и тем же пользователем. При отправке пользователю сообщения все соединения, связанные с этим пользователем, получают сообщение. Доступ к идентификатору пользователя для подключения можно получить с помощью `Context.UserIdentifier` свойства в центре.

Отправьте сообщение определенному пользователю, передав идентификатор пользователя в `User` функцию в методе Hub, как показано в следующем примере:

> [!NOTE]
> В идентификаторе пользователя учитывается регистр.

[!code-csharp[Configure service](groups/sample/hubs/chathub.cs?range=29-32)]

## <a name="groups-in-signalr"></a>Группы вSignalR

Группа — это коллекция соединений, связанных с именем. Сообщения могут отправляться всем подключениям в группе. Группы — это рекомендуемый способ отправки на подключение или несколько подключений, так как группы управляются приложением. Соединение может быть членом нескольких групп. Это делает группы идеальными для чего-то вроде приложения для разговора, где каждая комната может быть представлена группой. Соединения можно добавлять в группы или удалять из них с помощью `AddToGroupAsync` методов `RemoveFromGroupAsync` и.

[!code-csharp[Hub methods](groups/sample/hubs/chathub.cs?range=15-27)]

Членство в группе не сохраняется при повторном подключении подключения. Соединение должно повторно присоединиться к группе, когда она будет восстановлена. Невозможно подсчитать членов группы, так как эта информация недоступна, если приложение масштабируется до нескольких серверов.

Чтобы защитить доступ к ресурсам при использовании групп, используйте функции [проверки подлинности и авторизации](xref:signalr/authn-and-authz) в ASP.NET Core. Если вы добавляете пользователей в группу только в том случае, если учетные данные действительны для этой группы, сообщения, отправленные в эту группу, будут отправляться только полномочным пользователям. Однако группы не являются функцией безопасности. Утверждения проверки подлинности имеют функции, которые не являются группами, например срок действия и отзыв. Если разрешение пользователя на доступ к группе отменено, необходимо вручную определить его и удалить из группы.

> [!NOTE]
> В именах групп учитывается регистр.

## <a name="related-resources"></a>Связанные ресурсы

* [Начало работы](xref:tutorials/signalr)
* [Концентраторы](xref:signalr/hubs)
* [Публикация в Azure](xref:signalr/publish-to-azure-web-app)
