---
title: Устранение неполадок ASP.NET Core в Службе приложений Azure и IIS
author: rick-anderson
description: Сведения о диагностике проблем с развертываниями приложений ASP.NET Core с помощью служб IIS и Службы приложений Azure.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 02/07/2020
uid: test/troubleshoot-azure-iis
ms.openlocfilehash: 671f68da2ea261cb8ae32a9d5ef875217859054d
ms.sourcegitcommit: f7886fd2e219db9d7ce27b16c0dc5901e658d64e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "78644884"
---
# <a name="troubleshoot-aspnet-core-on-azure-app-service-and-iis"></a><span data-ttu-id="28ee7-103">Устранение неполадок ASP.NET Core в Службе приложений Azure и IIS</span><span class="sxs-lookup"><span data-stu-id="28ee7-103">Troubleshoot ASP.NET Core on Azure App Service and IIS</span></span>

<span data-ttu-id="28ee7-104">Автор [Джастин Коталик (Justin Kotalik)](https://github.com/jkotalik)</span><span class="sxs-lookup"><span data-stu-id="28ee7-104">By [Justin Kotalik](https://github.com/jkotalik)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="28ee7-105">В этой статье содержатся сведения об общих ошибках запуска приложений и инструкции по диагностике ошибок при развертывании приложения в Службе приложений Azure или службах IIS:</span><span class="sxs-lookup"><span data-stu-id="28ee7-105">This article provides information on common app startup errors and instructions on how to diagnose errors when an app is deployed to Azure App Service or IIS:</span></span>

[<span data-ttu-id="28ee7-106">Ошибки при запуске приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-106">App startup errors</span></span>](#app-startup-errors)  
<span data-ttu-id="28ee7-107">Описание распространенных сценариев кода состояния HTTP для запуска.</span><span class="sxs-lookup"><span data-stu-id="28ee7-107">Explains common startup HTTP status code scenarios.</span></span>

[<span data-ttu-id="28ee7-108">Устранение неполадок в Службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-108">Troubleshoot on Azure App Service</span></span>](#troubleshoot-on-azure-app-service)  
<span data-ttu-id="28ee7-109">Рекомендации по устранению неполадок для приложений, развернутых в Службе приложений Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-109">Provides troubleshooting advice for apps deployed to Azure App Service.</span></span>

[<span data-ttu-id="28ee7-110">Устранение неполадок в IIS</span><span class="sxs-lookup"><span data-stu-id="28ee7-110">Troubleshoot on IIS</span></span>](#troubleshoot-on-iis)  
<span data-ttu-id="28ee7-111">Рекомендации по устранению неполадок для приложений, развернутых в службах IIS или запущенных на IIS Express локально.</span><span class="sxs-lookup"><span data-stu-id="28ee7-111">Provides troubleshooting advice for apps deployed to IIS or running on IIS Express locally.</span></span> <span data-ttu-id="28ee7-112">Руководство относится к развертываниям Windows Server и Windows Desktop.</span><span class="sxs-lookup"><span data-stu-id="28ee7-112">The guidance applies to both Windows Server and Windows desktop deployments.</span></span>

[<span data-ttu-id="28ee7-113">Очистка кэшей пакетов</span><span class="sxs-lookup"><span data-stu-id="28ee7-113">Clear package caches</span></span>](#clear-package-caches)  
<span data-ttu-id="28ee7-114">Рекомендации о том, что делать, когда несогласованные пакеты нарушают работу приложения при установке основных обновлений или изменении версий пакета.</span><span class="sxs-lookup"><span data-stu-id="28ee7-114">Explains what to do when incoherent packages break an app when performing major upgrades or changing package versions.</span></span>

[<span data-ttu-id="28ee7-115">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="28ee7-115">Additional resources</span></span>](#additional-resources)  
<span data-ttu-id="28ee7-116">Дополнительные статьи по устранению неполадок.</span><span class="sxs-lookup"><span data-stu-id="28ee7-116">Lists additional troubleshooting topics.</span></span>

## <a name="app-startup-errors"></a><span data-ttu-id="28ee7-117">Ошибки при запуске приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-117">App startup errors</span></span>

<span data-ttu-id="28ee7-118">В Visual Studio проект ASP.NET Core по умолчанию использует размещение в [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview) на период отладки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-118">In Visual Studio, an ASP.NET Core project defaults to [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview) hosting during debugging.</span></span> <span data-ttu-id="28ee7-119">Рекомендации в этой статье позволяют диагностировать неполадки, проявляющиеся как *502.5 — ошибка процесса* или *500.30 — ошибка запуска* при локальной отладке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-119">A *502.5 - Process Failure* or a *500.30 - Start Failure* that occurs when debugging locally can be diagnosed using the advice in this topic.</span></span>

### <a name="40314-forbidden"></a><span data-ttu-id="28ee7-120">403.14 (Запрещено)</span><span class="sxs-lookup"><span data-stu-id="28ee7-120">403.14 Forbidden</span></span>

<span data-ttu-id="28ee7-121">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-121">The app fails to start.</span></span> <span data-ttu-id="28ee7-122">В журнал записывается следующая ошибка:</span><span class="sxs-lookup"><span data-stu-id="28ee7-122">The following error is logged:</span></span>

```
The Web server is configured to not list the contents of this directory.
```

<span data-ttu-id="28ee7-123">Эта ошибка обычно вызвана неработающим развертыванием в системе размещения в следующих сценариях:</span><span class="sxs-lookup"><span data-stu-id="28ee7-123">The error is usually caused by a broken deployment on the hosting system, which includes any of the following scenarios:</span></span>

* <span data-ttu-id="28ee7-124">Приложение развертывается в неверной папке в системе размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-124">The app is deployed to the wrong folder on the hosting system.</span></span>
* <span data-ttu-id="28ee7-125">Процессу развертывания не удалось переместить все файлы и папки приложения в папку развертывания в системе размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-125">The deployment process failed to move all of the app's files and folders to the deployment folder on the hosting system.</span></span>
* <span data-ttu-id="28ee7-126">Файл *web.config* отсутствует в развертывании, или содержимое файла *web.config* имеет неправильную структуру.</span><span class="sxs-lookup"><span data-stu-id="28ee7-126">The *web.config* file is missing from the deployment, or the *web.config* file contents are malformed.</span></span>

<span data-ttu-id="28ee7-127">Выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="28ee7-127">Perform the following steps:</span></span>

1. <span data-ttu-id="28ee7-128">Удалите все файлы и папки из папки развертывания в системе размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-128">Delete all of the files and folders from the deployment folder on the hosting system.</span></span>
1. <span data-ttu-id="28ee7-129">Повторно разверните содержимое папки *publish* приложения в системе размещения с помощью обычного метода развертывания, например Visual Studio, PowerShell или развертывание вручную:</span><span class="sxs-lookup"><span data-stu-id="28ee7-129">Redeploy the contents of the app's *publish* folder to the hosting system using your normal method of deployment, such as Visual Studio, PowerShell, or manual deployment:</span></span>
   * <span data-ttu-id="28ee7-130">Убедитесь, что файл *web.config* находится в развертывании и имеет правильное содержимое.</span><span class="sxs-lookup"><span data-stu-id="28ee7-130">Confirm that the *web.config* file is present in the deployment and that its contents are correct.</span></span>
   * <span data-ttu-id="28ee7-131">При размещении в Службе приложений Azure убедитесь, что приложение развернуто в папке `D:\home\site\wwwroot`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-131">When hosting on Azure App Service, confirm that the app is deployed to the `D:\home\site\wwwroot` folder.</span></span>
   * <span data-ttu-id="28ee7-132">Если приложение размещено в IIS, убедитесь, что оно развернуто по **физическому пути** служб IIS, указанному в **базовых параметрах** в **диспетчере IIS**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-132">When the app is hosted by IIS, confirm that the app is deployed to the IIS **Physical path** shown in **IIS Manager**'s **Basic Settings**.</span></span>
1. <span data-ttu-id="28ee7-133">Убедитесь, что все файлы и папки приложения развернуты путем сравнения развертывания в системе размещения с содержимым папки проекта *publish*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-133">Confirm that all of the app's files and folders are deployed by comparing the deployment on the hosting system to the contents of the project's *publish* folder.</span></span>

<span data-ttu-id="28ee7-134">Дополнительные сведения о макете опубликованного приложения ASP.NET Core см. в разделе <xref:host-and-deploy/directory-structure>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-134">For more information on the layout of a published ASP.NET Core app, see <xref:host-and-deploy/directory-structure>.</span></span> <span data-ttu-id="28ee7-135">Дополнительные сведения о файле *web.config* см. в разделе <xref:host-and-deploy/aspnet-core-module#configuration-with-webconfig>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-135">For more information on the *web.config* file, see <xref:host-and-deploy/aspnet-core-module#configuration-with-webconfig>.</span></span>

### <a name="500-internal-server-error"></a><span data-ttu-id="28ee7-136">500 Internal Server Error (внутренняя ошибка сервера)</span><span class="sxs-lookup"><span data-stu-id="28ee7-136">500 Internal Server Error</span></span>

<span data-ttu-id="28ee7-137">Приложение запускается, но ошибка не позволяет серверу выполнить запрос.</span><span class="sxs-lookup"><span data-stu-id="28ee7-137">The app starts, but an error prevents the server from fulfilling the request.</span></span>

<span data-ttu-id="28ee7-138">Эта ошибка возникает в коде приложения при запуске или при создании ответа.</span><span class="sxs-lookup"><span data-stu-id="28ee7-138">This error occurs within the app's code during startup or while creating a response.</span></span> <span data-ttu-id="28ee7-139">Ответ может не иметь содержимого или ответ в браузере может выглядеть как *500 — внутренняя ошибка сервера*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-139">The response may contain no content, or the response may appear as a *500 Internal Server Error* in the browser.</span></span> <span data-ttu-id="28ee7-140">Как правило, в журнале событий приложения указывается, что приложение запускается в обычном режиме.</span><span class="sxs-lookup"><span data-stu-id="28ee7-140">The Application Event Log usually states that the app started normally.</span></span> <span data-ttu-id="28ee7-141">Сервер действует правильно.</span><span class="sxs-lookup"><span data-stu-id="28ee7-141">From the server's perspective, that's correct.</span></span> <span data-ttu-id="28ee7-142">Приложение запустилось, но оно не может генерировать действительный ответ.</span><span class="sxs-lookup"><span data-stu-id="28ee7-142">The app did start, but it can't generate a valid response.</span></span> <span data-ttu-id="28ee7-143">Чтобы устранить проблему, запустите приложение в командной строке на сервере или включите журнал вывода stdout для модуля ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-143">Run the app at a command prompt on the server or enable the ASP.NET Core Module stdout log to troubleshoot the problem.</span></span>

### <a name="5000-in-process-handler-load-failure"></a><span data-ttu-id="28ee7-144">500.0 In-Process Handler Load Failure (ошибка загрузки внутрипроцессного обработчика)</span><span class="sxs-lookup"><span data-stu-id="28ee7-144">500.0 In-Process Handler Load Failure</span></span>

<span data-ttu-id="28ee7-145">Рабочий процесс завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="28ee7-145">The worker process fails.</span></span> <span data-ttu-id="28ee7-146">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-146">The app doesn't start.</span></span>

<span data-ttu-id="28ee7-147">При загрузке компонентов [модуля ASP.NET Core](xref:host-and-deploy/aspnet-core-module) произошла неизвестная ошибка.</span><span class="sxs-lookup"><span data-stu-id="28ee7-147">An unknown error occurred loading [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) components.</span></span> <span data-ttu-id="28ee7-148">Выполните одно из указанных ниже действий.</span><span class="sxs-lookup"><span data-stu-id="28ee7-148">Take one of the following actions:</span></span>

* <span data-ttu-id="28ee7-149">Обратитесь в [службу поддержки Майкрософт](https://support.microsoft.com/oas/default.aspx?prid=15832) (выберите **Средства разработчика**, а затем — **ASP.NET Core**).</span><span class="sxs-lookup"><span data-stu-id="28ee7-149">Contact [Microsoft Support](https://support.microsoft.com/oas/default.aspx?prid=15832) (select **Developer Tools** then **ASP.NET Core**).</span></span>
* <span data-ttu-id="28ee7-150">Задайте вопрос на сайте Stack Overflow.</span><span class="sxs-lookup"><span data-stu-id="28ee7-150">Ask a question on Stack Overflow.</span></span>
* <span data-ttu-id="28ee7-151">Сообщите о проблеме в нашем [репозитории GitHub](https://github.com/dotnet/AspNetCore).</span><span class="sxs-lookup"><span data-stu-id="28ee7-151">File an issue on our [GitHub repository](https://github.com/dotnet/AspNetCore).</span></span>

### <a name="50030-in-process-startup-failure"></a><span data-ttu-id="28ee7-152">500.30 In-Process Startup Failure (ошибка внутрипроцессного запуска)</span><span class="sxs-lookup"><span data-stu-id="28ee7-152">500.30 In-Process Startup Failure</span></span>

<span data-ttu-id="28ee7-153">Рабочий процесс завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="28ee7-153">The worker process fails.</span></span> <span data-ttu-id="28ee7-154">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-154">The app doesn't start.</span></span>

<span data-ttu-id="28ee7-155">[Модуль ASP.NET Core](xref:host-and-deploy/aspnet-core-module) пытается запустить среду CLR .NET Core внутри процесса, но она не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-155">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) attempts to start the .NET Core CLR in-process, but it fails to start.</span></span> <span data-ttu-id="28ee7-156">Обычно причину сбоя при запуске процесса можно определить по записям в журнале событий приложения и журнале вывода stdout модуля ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-156">The cause of a process startup failure can usually be determined from entries in the Application Event Log and the ASP.NET Core Module stdout log.</span></span>

<span data-ttu-id="28ee7-157">Распространенные причины сбоя:</span><span class="sxs-lookup"><span data-stu-id="28ee7-157">Common failure conditions:</span></span>

* <span data-ttu-id="28ee7-158">В приложении указана отсутствующая версия общей платформы ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-158">The app is misconfigured due to targeting a version of the ASP.NET Core shared framework that isn't present.</span></span> <span data-ttu-id="28ee7-159">Проверьте, какие версии общей платформы ASP.NET Core установлены на целевом компьютере.</span><span class="sxs-lookup"><span data-stu-id="28ee7-159">Check which versions of the ASP.NET Core shared framework are installed on the target machine.</span></span>
* <span data-ttu-id="28ee7-160">При использовании Azure Key Vault не хватает разрешений на Key Vault.</span><span class="sxs-lookup"><span data-stu-id="28ee7-160">Using Azure Key Vault, lack of permissions to the Key Vault.</span></span> <span data-ttu-id="28ee7-161">Проверьте политики доступа в целевое хранилище Key Vault, чтобы убедиться, что предоставлены правильные разрешения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-161">Check the access policies in the targeted Key Vault to ensure that the correct permissions are granted.</span></span>

### <a name="50031-ancm-failed-to-find-native-dependencies"></a><span data-ttu-id="28ee7-162">500.31 ANCM Failed to Find Native Dependencies (ANCM не удалось найти собственные зависимости)</span><span class="sxs-lookup"><span data-stu-id="28ee7-162">500.31 ANCM Failed to Find Native Dependencies</span></span>

<span data-ttu-id="28ee7-163">Рабочий процесс завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="28ee7-163">The worker process fails.</span></span> <span data-ttu-id="28ee7-164">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-164">The app doesn't start.</span></span>

<span data-ttu-id="28ee7-165">[Модуль ASP.NET Core](xref:host-and-deploy/aspnet-core-module) пытается запустить среду выполнения .NET Core внутри процесса, но она не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-165">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) attempts to start the .NET Core runtime in-process, but it fails to start.</span></span> <span data-ttu-id="28ee7-166">Наиболее распространенная причина этой ошибки в том, что среда выполнения `Microsoft.NETCore.App` или `Microsoft.AspNetCore.App` не установлена.</span><span class="sxs-lookup"><span data-stu-id="28ee7-166">The most common cause of this startup failure is when the `Microsoft.NETCore.App` or `Microsoft.AspNetCore.App` runtime isn't installed.</span></span> <span data-ttu-id="28ee7-167">Если целевой платформой развернутого приложения является ASP.NET Core 3.0, но эта версия отсутствует на компьютере, происходит данная ошибка.</span><span class="sxs-lookup"><span data-stu-id="28ee7-167">If the app is deployed to target ASP.NET Core 3.0 and that version doesn't exist on the machine, this error occurs.</span></span> <span data-ttu-id="28ee7-168">Пример сообщения об ошибке:</span><span class="sxs-lookup"><span data-stu-id="28ee7-168">An example error message follows:</span></span>

```
The specified framework 'Microsoft.NETCore.App', version '3.0.0' was not found.
  - The following frameworks were found:
      2.2.1 at [C:\Program Files\dotnet\x64\shared\Microsoft.NETCore.App]
      3.0.0-preview5-27626-15 at [C:\Program Files\dotnet\x64\shared\Microsoft.NETCore.App]
      3.0.0-preview6-27713-13 at [C:\Program Files\dotnet\x64\shared\Microsoft.NETCore.App]
      3.0.0-preview6-27714-15 at [C:\Program Files\dotnet\x64\shared\Microsoft.NETCore.App]
      3.0.0-preview6-27723-08 at [C:\Program Files\dotnet\x64\shared\Microsoft.NETCore.App]
```

<span data-ttu-id="28ee7-169">В сообщении об ошибке перечислены все установленные версии .NET Core и указывается версия, которая требуется приложению.</span><span class="sxs-lookup"><span data-stu-id="28ee7-169">The error message lists all the installed .NET Core versions and the version requested by the app.</span></span> <span data-ttu-id="28ee7-170">Чтобы устранить эту ошибку, выполните одно из указанных ниже действий.</span><span class="sxs-lookup"><span data-stu-id="28ee7-170">To fix this error, either:</span></span>

* <span data-ttu-id="28ee7-171">Установите соответствующую версию .NET Core на компьютере.</span><span class="sxs-lookup"><span data-stu-id="28ee7-171">Install the appropriate version of .NET Core on the machine.</span></span>
* <span data-ttu-id="28ee7-172">Измените целевую версию .NET Core приложения на версию, имеющуюся на компьютере.</span><span class="sxs-lookup"><span data-stu-id="28ee7-172">Change the app to target a version of .NET Core that's present on the machine.</span></span>
* <span data-ttu-id="28ee7-173">Опубликуйте приложение как [автономное развертывание](/dotnet/core/deploying/#self-contained-deployments-scd).</span><span class="sxs-lookup"><span data-stu-id="28ee7-173">Publish the app as a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd).</span></span>

<span data-ttu-id="28ee7-174">При запуске в среде разработки (переменная среды `ASPNETCORE_ENVIRONMENT` имеет значение `Development`) ошибка записывается в ответ HTTP.</span><span class="sxs-lookup"><span data-stu-id="28ee7-174">When running in development (the `ASPNETCORE_ENVIRONMENT` environment variable is set to `Development`), the specific error is written to the HTTP response.</span></span> <span data-ttu-id="28ee7-175">Причину сбоя при запуске процесса можно также узнать в журнале событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-175">The cause of a process startup failure is also found in the Application Event Log.</span></span>

### <a name="50032-ancm-failed-to-load-dll"></a><span data-ttu-id="28ee7-176">500.32 ANCM Failed to Load dll (ANCM не удалось загрузить библиотеку DLL)</span><span class="sxs-lookup"><span data-stu-id="28ee7-176">500.32 ANCM Failed to Load dll</span></span>

<span data-ttu-id="28ee7-177">Рабочий процесс завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="28ee7-177">The worker process fails.</span></span> <span data-ttu-id="28ee7-178">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-178">The app doesn't start.</span></span>

<span data-ttu-id="28ee7-179">Наиболее распространенная причина этой ошибки в том, что приложение опубликовано для несовместимой архитектуры процессора.</span><span class="sxs-lookup"><span data-stu-id="28ee7-179">The most common cause for this error is that the app is published for an incompatible processor architecture.</span></span> <span data-ttu-id="28ee7-180">Если рабочий процесс выполняется как 32-разрядное приложение, но приложение было опубликовано для 64-разрядной архитектуры, происходит эта ошибка.</span><span class="sxs-lookup"><span data-stu-id="28ee7-180">If the worker process is running as a 32-bit app and the app was published to target 64-bit, this error occurs.</span></span>

<span data-ttu-id="28ee7-181">Чтобы устранить эту ошибку, выполните одно из указанных ниже действий.</span><span class="sxs-lookup"><span data-stu-id="28ee7-181">To fix this error, either:</span></span>

* <span data-ttu-id="28ee7-182">Повторно опубликуйте приложение для той же архитектуры процессора, для которой предназначен рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="28ee7-182">Republish the app for the same processor architecture as the worker process.</span></span>
* <span data-ttu-id="28ee7-183">Опубликуйте приложение как [зависящее от платформы развертывание](/dotnet/core/deploying/#framework-dependent-executables-fde).</span><span class="sxs-lookup"><span data-stu-id="28ee7-183">Publish the app as a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-executables-fde).</span></span>

### <a name="50033-ancm-request-handler-load-failure"></a><span data-ttu-id="28ee7-184">500.33 ANCM Request Handler Load Failure (Ошибка загрузки обработчика запросов ANCM)</span><span class="sxs-lookup"><span data-stu-id="28ee7-184">500.33 ANCM Request Handler Load Failure</span></span>

<span data-ttu-id="28ee7-185">Рабочий процесс завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="28ee7-185">The worker process fails.</span></span> <span data-ttu-id="28ee7-186">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-186">The app doesn't start.</span></span>

<span data-ttu-id="28ee7-187">Приложение не ссылается на платформу `Microsoft.AspNetCore.App`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-187">The app didn't reference the `Microsoft.AspNetCore.App` framework.</span></span> <span data-ttu-id="28ee7-188">В [модуле ASP.NET Core](xref:host-and-deploy/aspnet-core-module) могут размещаться только приложения, предназначенные для платформы `Microsoft.AspNetCore.App`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-188">Only apps targeting the `Microsoft.AspNetCore.App` framework can be hosted by the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span>

<span data-ttu-id="28ee7-189">Для устранения этой ошибки убедитесь в том, что приложение предназначено для платформы `Microsoft.AspNetCore.App`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-189">To fix this error, confirm that the app is targeting the `Microsoft.AspNetCore.App` framework.</span></span> <span data-ttu-id="28ee7-190">В файле `.runtimeconfig.json` проверьте, является ли эта платформа целевой для приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-190">Check the `.runtimeconfig.json` to verify the framework targeted by the app.</span></span>

### <a name="50034-ancm-mixed-hosting-models-not-supported"></a><span data-ttu-id="28ee7-191">500.34 ANCM Mixed Hosting Models Not Supported (Смешанные модели размещения ANCM не поддерживаются)</span><span class="sxs-lookup"><span data-stu-id="28ee7-191">500.34 ANCM Mixed Hosting Models Not Supported</span></span>

<span data-ttu-id="28ee7-192">В одном рабочем процессе не могут выполняться одновременно внутрипроцессное приложение и внепроцессное приложение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-192">The worker process can't run both an in-process app and an out-of-process app in the same process.</span></span>

<span data-ttu-id="28ee7-193">Для устранения этой ошибки запускайте приложения в отдельных пулах приложений IIS.</span><span class="sxs-lookup"><span data-stu-id="28ee7-193">To fix this error, run apps in separate IIS application pools.</span></span>

### <a name="50035-ancm-multiple-in-process-applications-in-same-process"></a><span data-ttu-id="28ee7-194">500.35 ANCM Multiple In-Process Applications in same Process (Несколько внутрипроцессных приложений ANCM в одном процессе)</span><span class="sxs-lookup"><span data-stu-id="28ee7-194">500.35 ANCM Multiple In-Process Applications in same Process</span></span>

<span data-ttu-id="28ee7-195">Рабочий процесс не может запускать несколько внутрипроцессных приложений в одном процессе.</span><span class="sxs-lookup"><span data-stu-id="28ee7-195">The worker process can't run multiple in-process apps in the same process.</span></span>

<span data-ttu-id="28ee7-196">Для устранения этой ошибки запускайте приложения в отдельных пулах приложений IIS.</span><span class="sxs-lookup"><span data-stu-id="28ee7-196">To fix this error, run apps in separate IIS application pools.</span></span>

### <a name="50036-ancm-out-of-process-handler-load-failure"></a><span data-ttu-id="28ee7-197">500.36 ANCM Out-Of-Process Handler Load Failure (Ошибка загрузки внепроцессного обработчика ANCM)</span><span class="sxs-lookup"><span data-stu-id="28ee7-197">500.36 ANCM Out-Of-Process Handler Load Failure</span></span>

<span data-ttu-id="28ee7-198">Рядом с файлом *aspnetcorev2.dll* нет внепроцессного обработчика запросов *aspnetcorev2_outofprocess.dll*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-198">The out-of-process request handler, *aspnetcorev2_outofprocess.dll*, isn't next to the *aspnetcorev2.dll* file.</span></span> <span data-ttu-id="28ee7-199">Это свидетельствует о поврежденной установке [модуля ASP.NET Core](xref:host-and-deploy/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="28ee7-199">This indicates a corrupted installation of the [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module).</span></span>

<span data-ttu-id="28ee7-200">Для устранения этой ошибки восстановите установку [пакета размещения .NET Core](xref:host-and-deploy/iis/index#install-the-net-core-hosting-bundle) (для служб IIS) или Visual Studio (для IIS Express).</span><span class="sxs-lookup"><span data-stu-id="28ee7-200">To fix this error, repair the installation of the [.NET Core Hosting Bundle](xref:host-and-deploy/iis/index#install-the-net-core-hosting-bundle) (for IIS) or Visual Studio (for IIS Express).</span></span>

### <a name="50037-ancm-failed-to-start-within-startup-time-limit"></a><span data-ttu-id="28ee7-201">500.37 ANCM Failed to Start Within Startup Time Limit (Модуль ANCM не запустился в течение предельного времени запуска)</span><span class="sxs-lookup"><span data-stu-id="28ee7-201">500.37 ANCM Failed to Start Within Startup Time Limit</span></span>

<span data-ttu-id="28ee7-202">Модуль ANCM не запустился в течение заданного предельного времени запуска.</span><span class="sxs-lookup"><span data-stu-id="28ee7-202">ANCM failed to start within the provied startup time limit.</span></span> <span data-ttu-id="28ee7-203">По умолчанию время ожидания составляет 120 секунд.</span><span class="sxs-lookup"><span data-stu-id="28ee7-203">By default, the timeout is 120 seconds.</span></span>

<span data-ttu-id="28ee7-204">Эта ошибка может произойти, если на одном компьютере запускается много приложений.</span><span class="sxs-lookup"><span data-stu-id="28ee7-204">This error can occur when starting a large number of apps on the same machine.</span></span> <span data-ttu-id="28ee7-205">Обратите внимание на пики использования ЦП и памяти на сервере во время запуска.</span><span class="sxs-lookup"><span data-stu-id="28ee7-205">Check for CPU/Memory usage spikes on the server during startup.</span></span> <span data-ttu-id="28ee7-206">Возможно, потребуется регулировать процесс запуска нескольких приложений.</span><span class="sxs-lookup"><span data-stu-id="28ee7-206">You may need to stagger the startup process of multiple apps.</span></span>

### <a name="5025-process-failure"></a><span data-ttu-id="28ee7-207">502.5 Process Failure (ошибка процесса)</span><span class="sxs-lookup"><span data-stu-id="28ee7-207">502.5 Process Failure</span></span>

<span data-ttu-id="28ee7-208">Рабочий процесс завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="28ee7-208">The worker process fails.</span></span> <span data-ttu-id="28ee7-209">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-209">The app doesn't start.</span></span>

<span data-ttu-id="28ee7-210">[Модуль ASP.NET Core](xref:host-and-deploy/aspnet-core-module) пытается запустить рабочий процесс, но он не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-210">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) attempts to start the worker process but it fails to start.</span></span> <span data-ttu-id="28ee7-211">Обычно причину сбоя при запуске процесса можно определить по записям в журнале событий приложения и журнале вывода stdout модуля ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-211">The cause of a process startup failure can usually be determined from entries in the Application Event Log and the ASP.NET Core Module stdout log.</span></span>

<span data-ttu-id="28ee7-212">Распространенной причиной сбоя является неправильная настройка приложения с выбором отсутствующей версии общей платформы ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-212">A common failure condition is the app is misconfigured due to targeting a version of the ASP.NET Core shared framework that isn't present.</span></span> <span data-ttu-id="28ee7-213">Проверьте, какие версии общей платформы ASP.NET Core установлены на целевом компьютере.</span><span class="sxs-lookup"><span data-stu-id="28ee7-213">Check which versions of the ASP.NET Core shared framework are installed on the target machine.</span></span> <span data-ttu-id="28ee7-214">*Общая платформа* — это набор сборок (*DLLl*-файлы), которые установлены на компьютере и на которые ссылается метапакет, например `Microsoft.AspNetCore.App`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-214">The *shared framework* is the set of assemblies (*.dll* files) that are installed on the machine and referenced by a metapackage such as `Microsoft.AspNetCore.App`.</span></span> <span data-ttu-id="28ee7-215">В ссылках метапакета может быть указана минимальная требуемая версия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-215">The metapackage reference can specify a minimum required version.</span></span> <span data-ttu-id="28ee7-216">Дополнительную информацию см. в этой публикации об [общей платформе](https://natemcmaster.com/blog/2018/08/29/netcore-primitives-2/).</span><span class="sxs-lookup"><span data-stu-id="28ee7-216">For more information, see [The shared framework](https://natemcmaster.com/blog/2018/08/29/netcore-primitives-2/).</span></span>

<span data-ttu-id="28ee7-217">Когда ошибки в конфигурации размещения или приложения приводят к сбою рабочего процесса, возвращается страница ошибки *502.5 — ошибка процесса*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-217">The *502.5 Process Failure* error page is returned when a hosting or app misconfiguration causes the worker process to fail:</span></span>

### <a name="failed-to-start-application-errorcode-0x800700c1"></a><span data-ttu-id="28ee7-218">Не удалось запустить приложение (код ошибки "0x800700c1")</span><span class="sxs-lookup"><span data-stu-id="28ee7-218">Failed to start application (ErrorCode '0x800700c1')</span></span>

```
EventID: 1010
Source: IIS AspNetCore Module V2
Failed to start application '/LM/W3SVC/6/ROOT/', ErrorCode '0x800700c1'.
```

<span data-ttu-id="28ee7-219">Не удалось запустить приложение, так как не удалось загрузить сборку приложения ( *.dll*).</span><span class="sxs-lookup"><span data-stu-id="28ee7-219">The app failed to start because the app's assembly (*.dll*) couldn't be loaded.</span></span>

<span data-ttu-id="28ee7-220">Эта ошибка возникает, если существует несоответствие разрядности опубликованного приложения и процесса w3wp/iisexpress.</span><span class="sxs-lookup"><span data-stu-id="28ee7-220">This error occurs when there's a bitness mismatch between the published app and the w3wp/iisexpress process.</span></span>

<span data-ttu-id="28ee7-221">Убедитесь, что параметр 32-разрядности пула приложений указан правильно:</span><span class="sxs-lookup"><span data-stu-id="28ee7-221">Confirm that the app pool's 32-bit setting is correct:</span></span>

1. <span data-ttu-id="28ee7-222">Выберите пул приложений в диспетчере служб IIS в разделе **Пулы приложений**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-222">Select the app pool in IIS Manager's **Application Pools**.</span></span>
1. <span data-ttu-id="28ee7-223">Выберите **Дополнительные параметры** в разделе **Изменение пула приложений** панели **Действия**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-223">Select **Advanced Settings** under **Edit Application Pool** in the **Actions** panel.</span></span>
1. <span data-ttu-id="28ee7-224">Установите параметр **Включить 32-разрядные приложения**:</span><span class="sxs-lookup"><span data-stu-id="28ee7-224">Set **Enable 32-Bit Applications**:</span></span>
   * <span data-ttu-id="28ee7-225">При развертывании 32-разрядного (x86) приложения задайте значение `True`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-225">If deploying a 32-bit (x86) app, set the value to `True`.</span></span>
   * <span data-ttu-id="28ee7-226">При развертывании 64-разрядного (x64) приложения задайте значение `False`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-226">If deploying a 64-bit (x64) app, set the value to `False`.</span></span>

<span data-ttu-id="28ee7-227">Убедитесь в отсутствии конфликта между свойством `<Platform>` MSBuild в файле проекта и опубликованной разрядностью приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-227">Confirm that there isn't a conflict between a `<Platform>` MSBuild property in the project file and the published bitness of the app.</span></span>

### <a name="connection-reset"></a><span data-ttu-id="28ee7-228">Сброс подключения</span><span class="sxs-lookup"><span data-stu-id="28ee7-228">Connection reset</span></span>

<span data-ttu-id="28ee7-229">Если ошибка возникает после отправки заголовков, сервер уже не может отправить страницу **500 — внутренняя ошибка сервера**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-229">If an error occurs after the headers are sent, it's too late for the server to send a **500 Internal Server Error** when an error occurs.</span></span> <span data-ttu-id="28ee7-230">Это часто происходит, когда ошибка возникает во время сериализации составных объектов ответа.</span><span class="sxs-lookup"><span data-stu-id="28ee7-230">This often happens when an error occurs during the serialization of complex objects for a response.</span></span> <span data-ttu-id="28ee7-231">Этот тип ошибки отображается на стороне клиента как ошибка *Сброс подключения*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-231">This type of error appears as a *connection reset* error on the client.</span></span> <span data-ttu-id="28ee7-232">[Ведение журналов для приложений](xref:fundamentals/logging/index) может помочь устранить эти ошибки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-232">[Application logging](xref:fundamentals/logging/index) can help troubleshoot these types of errors.</span></span>

### <a name="default-startup-limits"></a><span data-ttu-id="28ee7-233">Ограничения по умолчанию при запуске</span><span class="sxs-lookup"><span data-stu-id="28ee7-233">Default startup limits</span></span>

<span data-ttu-id="28ee7-234">Для параметра *startupTimeLimit* [модуля ASP.NET Core](xref:host-and-deploy/aspnet-core-module) установлено значение по умолчанию 120 секунд.</span><span class="sxs-lookup"><span data-stu-id="28ee7-234">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) is configured with a default *startupTimeLimit* of 120 seconds.</span></span> <span data-ttu-id="28ee7-235">Если оставить значение по умолчанию, то прежде чем журнал модуля зарегистрирует ошибку запуска приложения, может пройти до двух минут.</span><span class="sxs-lookup"><span data-stu-id="28ee7-235">When left at the default value, an app may take up to two minutes to start before the module logs a process failure.</span></span> <span data-ttu-id="28ee7-236">Сведения о настройке модуля см. в разделе [Атрибуты элемента aspNetCore](xref:host-and-deploy/aspnet-core-module#attributes-of-the-aspnetcore-element).</span><span class="sxs-lookup"><span data-stu-id="28ee7-236">For information on configuring the module, see [Attributes of the aspNetCore element](xref:host-and-deploy/aspnet-core-module#attributes-of-the-aspnetcore-element).</span></span>

## <a name="troubleshoot-on-azure-app-service"></a><span data-ttu-id="28ee7-237">Устранение неполадок в Службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-237">Troubleshoot on Azure App Service</span></span>

[!INCLUDE [Azure App Service Preview Notice](~/includes/azure-apps-preview-notice.md)]

### <a name="application-event-log-azure-app-service"></a><span data-ttu-id="28ee7-238">Журнал событий приложений (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-238">Application Event Log (Azure App Service)</span></span>

<span data-ttu-id="28ee7-239">Чтобы получить доступ к журналу событий приложения, используйте колонку **Диагностика и решение проблем** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-239">To access the Application Event Log, use the **Diagnose and solve problems** blade in the Azure portal:</span></span>

1. <span data-ttu-id="28ee7-240">На портале Azure откройте приложение в колонке **Службы приложений**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-240">In the Azure portal, open the app in **App Services**.</span></span>
1. <span data-ttu-id="28ee7-241">Выберите колонку **Диагностика и решение проблем**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-241">Select **Diagnose and solve problems**.</span></span>
1. <span data-ttu-id="28ee7-242">Щелкните заголовок **Средства диагностики**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-242">Select the **Diagnostic Tools** heading.</span></span>
1. <span data-ttu-id="28ee7-243">В разделе **Средства поддержки** нажмите кнопку **События приложений**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-243">Under **Support Tools**, select the **Application Events** button.</span></span>
1. <span data-ttu-id="28ee7-244">Изучите последние ошибки из журнала *IIS AspNetCoreModule* или *IIS AspNetCoreModule V2* в столбце **Источник**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-244">Examine the latest error provided by the *IIS AspNetCoreModule* or *IIS AspNetCoreModule V2* entry in the **Source** column.</span></span>

<span data-ttu-id="28ee7-245">Вместо использования колонки **Диагностика и решение проблем** можно изучить файл журнала событий приложения непосредственно с помощью консоли [Kudu](https://github.com/projectkudu/kudu/wiki).</span><span class="sxs-lookup"><span data-stu-id="28ee7-245">An alternative to using the **Diagnose and solve problems** blade is to examine the Application Event Log file directly using [Kudu](https://github.com/projectkudu/kudu/wiki):</span></span>

1. <span data-ttu-id="28ee7-246">В области **Средства разработки** откройте колонку **Дополнительные инструменты**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-246">Open **Advanced Tools** in the **Development Tools** area.</span></span> <span data-ttu-id="28ee7-247">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-247">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-248">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-248">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-249">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-249">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-250">Откройте папку **LogFiles**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-250">Open the **LogFiles** folder.</span></span>
1. <span data-ttu-id="28ee7-251">Выберите значок с карандашом рядом с файлом *eventlog.xml*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-251">Select the pencil icon next to the *eventlog.xml* file.</span></span>
1. <span data-ttu-id="28ee7-252">Изучите журнал.</span><span class="sxs-lookup"><span data-stu-id="28ee7-252">Examine the log.</span></span> <span data-ttu-id="28ee7-253">Прокрутите список до нижней части журнала, чтобы просмотреть последние события.</span><span class="sxs-lookup"><span data-stu-id="28ee7-253">Scroll to the bottom of the log to see the most recent events.</span></span>

### <a name="run-the-app-in-the-kudu-console"></a><span data-ttu-id="28ee7-254">Запуск приложения в консоли Kudu</span><span class="sxs-lookup"><span data-stu-id="28ee7-254">Run the app in the Kudu console</span></span>

<span data-ttu-id="28ee7-255">Многие ошибки запуска не создают полезные сведения в журнале событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-255">Many startup errors don't produce useful information in the Application Event Log.</span></span> <span data-ttu-id="28ee7-256">Чтобы обнаружить ошибку, можно запустить приложение в удаленной консоли выполнения [Kudu](https://github.com/projectkudu/kudu/wiki).</span><span class="sxs-lookup"><span data-stu-id="28ee7-256">You can run the app in the [Kudu](https://github.com/projectkudu/kudu/wiki) Remote Execution Console to discover the error:</span></span>

1. <span data-ttu-id="28ee7-257">В области **Средства разработки** откройте колонку **Дополнительные инструменты**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-257">Open **Advanced Tools** in the **Development Tools** area.</span></span> <span data-ttu-id="28ee7-258">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-258">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-259">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-259">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-260">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-260">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>

#### <a name="test-a-32-bit-x86-app"></a><span data-ttu-id="28ee7-261">Тестирование 32-разрядного (x86) приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-261">Test a 32-bit (x86) app</span></span>

<span data-ttu-id="28ee7-262">**Текущий выпуск**</span><span class="sxs-lookup"><span data-stu-id="28ee7-262">**Current release**</span></span>

1. `cd d:\home\site\wwwroot`
1. <span data-ttu-id="28ee7-263">Запустите приложение:</span><span class="sxs-lookup"><span data-stu-id="28ee7-263">Run the app:</span></span>
   * <span data-ttu-id="28ee7-264">Если развертываемое приложение [зависит от платформы](/dotnet/core/deploying/#framework-dependent-deployments-fdd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-264">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span></span>

     ```dotnetcli
     dotnet .\{ASSEMBLY NAME}.dll
     ```

   * <span data-ttu-id="28ee7-265">Если приложение [развертывается автономно](/dotnet/core/deploying/#self-contained-deployments-scd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-265">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd):</span></span>

     ```console
     {ASSEMBLY NAME}.exe
     ```

<span data-ttu-id="28ee7-266">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-266">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

<span data-ttu-id="28ee7-267">**Зависимое от платформы развертывание, выполняющееся в предварительном выпуске**</span><span class="sxs-lookup"><span data-stu-id="28ee7-267">**Framework-dependent deployment running on a preview release**</span></span>

<span data-ttu-id="28ee7-268">*Требует установки расширения сайта для среды выполнения ASP.NET Core {VERSION} (x86).*</span><span class="sxs-lookup"><span data-stu-id="28ee7-268">*Requires installing the ASP.NET Core {VERSION} (x86) Runtime site extension.*</span></span>

1. <span data-ttu-id="28ee7-269">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x32` (`{X.Y}` — это версия среды выполнения).</span><span class="sxs-lookup"><span data-stu-id="28ee7-269">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x32` (`{X.Y}` is the runtime version)</span></span>
1. <span data-ttu-id="28ee7-270">Запустите приложение: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-270">Run the app: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`</span></span>

<span data-ttu-id="28ee7-271">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-271">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

#### <a name="test-a-64-bit-x64-app"></a><span data-ttu-id="28ee7-272">Тестирование 64-разрядного (x64) приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-272">Test a 64-bit (x64) app</span></span>

<span data-ttu-id="28ee7-273">**Текущий выпуск**</span><span class="sxs-lookup"><span data-stu-id="28ee7-273">**Current release**</span></span>

* <span data-ttu-id="28ee7-274">Если приложение является 64-разрядным (x64) [зависимым от платформы развертыванием](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span><span class="sxs-lookup"><span data-stu-id="28ee7-274">If the app is a 64-bit (x64) [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span></span>
  1. `cd D:\Program Files\dotnet`
  1. <span data-ttu-id="28ee7-275">Запустите приложение: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-275">Run the app: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`</span></span>
* <span data-ttu-id="28ee7-276">Если приложение [развертывается автономно](/dotnet/core/deploying/#self-contained-deployments-scd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-276">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd):</span></span>
  1. `cd D:\home\site\wwwroot`
  1. <span data-ttu-id="28ee7-277">Запустите приложение: `{ASSEMBLY NAME}.exe`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-277">Run the app: `{ASSEMBLY NAME}.exe`</span></span>

<span data-ttu-id="28ee7-278">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-278">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

<span data-ttu-id="28ee7-279">**Зависимое от платформы развертывание, выполняющееся в предварительном выпуске**</span><span class="sxs-lookup"><span data-stu-id="28ee7-279">**Framework-dependent deployment running on a preview release**</span></span>

<span data-ttu-id="28ee7-280">*Требует установки расширения сайта для среды выполнения ASP.NET Core {VERSION} (x64).*</span><span class="sxs-lookup"><span data-stu-id="28ee7-280">*Requires installing the ASP.NET Core {VERSION} (x64) Runtime site extension.*</span></span>

1. <span data-ttu-id="28ee7-281">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x64` (`{X.Y}` — это версия среды выполнения).</span><span class="sxs-lookup"><span data-stu-id="28ee7-281">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x64` (`{X.Y}` is the runtime version)</span></span>
1. <span data-ttu-id="28ee7-282">Запустите приложение: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-282">Run the app: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`</span></span>

<span data-ttu-id="28ee7-283">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-283">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

### <a name="aspnet-core-module-stdout-log-azure-app-service"></a><span data-ttu-id="28ee7-284">Журнал вывода stdout модуля ASP.NET Core (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-284">ASP.NET Core Module stdout log (Azure App Service)</span></span>

<span data-ttu-id="28ee7-285">В журнале stdout модуля ASP.NET Core часто записываются полезные сообщения, которые не удается найти в журнале событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-285">The ASP.NET Core Module stdout log often records useful error messages not found in the Application Event Log.</span></span> <span data-ttu-id="28ee7-286">Чтобы включить и просмотреть журналы stdout выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-286">To enable and view stdout logs:</span></span>

1. <span data-ttu-id="28ee7-287">Перейдите к колонке **Диагностика и решение проблем** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-287">Navigate to the **Diagnose and solve problems** blade in the Azure portal.</span></span>
1. <span data-ttu-id="28ee7-288">В разделе **Выберите категорию проблемы** нажмите кнопку **Веб-приложение не работает**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-288">Under **SELECT PROBLEM CATEGORY**, select the **Web App Down** button.</span></span>
1. <span data-ttu-id="28ee7-289">В разделе **Предлагаемые решения** > **Включить перенаправление журнала stdout** нажмите кнопку **Открыть консоль Kudu для редактирования файла Web.Config**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-289">Under **Suggested Solutions** > **Enable Stdout Log Redirection**, select the button to **Open Kudu Console to edit Web.Config**.</span></span>
1. <span data-ttu-id="28ee7-290">В **консоли диагностики** Kudu откройте папки на пути **веб-сайт** > **wwwroot**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-290">In the Kudu **Diagnostic Console**, open the folders to the path **site** > **wwwroot**.</span></span> <span data-ttu-id="28ee7-291">Прокрутите список вниз, чтобы в его нижней части показался файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-291">Scroll down to reveal the *web.config* file at the bottom of the list.</span></span>
1. <span data-ttu-id="28ee7-292">Щелкните значок карандаша рядом с файлом *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-292">Click the pencil icon next to the *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-293">Установите для параметра **stdoutLogEnabled** значение `true` и измените путь **stdoutLogFile** на `\\?\%home%\LogFiles\stdout`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-293">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to: `\\?\%home%\LogFiles\stdout`.</span></span>
1. <span data-ttu-id="28ee7-294">Выберите **Сохранить** для сохранения обновленного файла *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-294">Select **Save** to save the updated *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-295">Сделайте запрос к приложению.</span><span class="sxs-lookup"><span data-stu-id="28ee7-295">Make a request to the app.</span></span>
1. <span data-ttu-id="28ee7-296">Вернитесь на портал Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-296">Return to the Azure portal.</span></span> <span data-ttu-id="28ee7-297">Выберите колонку **Дополнительные инструменты** в области **Средства разработки**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-297">Select the **Advanced Tools** blade in the **DEVELOPMENT TOOLS** area.</span></span> <span data-ttu-id="28ee7-298">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-298">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-299">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-299">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-300">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-300">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-301">Выберите папку **LogFiles**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-301">Select the **LogFiles** folder.</span></span>
1. <span data-ttu-id="28ee7-302">Изучите столбец **Изменено** и выберите значок карандаша, чтобы отредактировать журнал stdout для последней даты изменения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-302">Inspect the **Modified** column and select the pencil icon to edit the stdout log with the latest modification date.</span></span>
1. <span data-ttu-id="28ee7-303">При открытии файла журнала отображается сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-303">When the log file opens, the error is displayed.</span></span>

<span data-ttu-id="28ee7-304">Завершив устранение неполадок, отключите ведение журнала stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-304">Disable stdout logging when troubleshooting is complete:</span></span>

1. <span data-ttu-id="28ee7-305">В **консоли диагностики** Kudu вернитесь к пути **веб-сайт** > **wwwroot**, чтобы открыть файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-305">In the Kudu **Diagnostic Console**, return to the path **site** > **wwwroot** to reveal the *web.config* file.</span></span> <span data-ttu-id="28ee7-306">Выбрав значок карандаша, снова откройте файл **web.config**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-306">Open the **web.config** file again by selecting the pencil icon.</span></span>
1. <span data-ttu-id="28ee7-307">Задайте параметру **stdoutLogEnabled** значение `false`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-307">Set **stdoutLogEnabled** to `false`.</span></span>
1. <span data-ttu-id="28ee7-308">Нажмите кнопку **Сохранить** для сохранения файла.</span><span class="sxs-lookup"><span data-stu-id="28ee7-308">Select **Save** to save the file.</span></span>

<span data-ttu-id="28ee7-309">Для получения дополнительной информации см. <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-309">For more information, see <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-310">Ошибка при отключении журнала stdout может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-310">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-311">Ни размер файла журнала, ни количество создаваемых файлов журналов ничем не ограничены.</span><span class="sxs-lookup"><span data-stu-id="28ee7-311">There's no limit on log file size or the number of log files created.</span></span> <span data-ttu-id="28ee7-312">Для устранения неполадок при запуске приложения используйте только журнал stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-312">Only use stdout logging to troubleshoot app startup problems.</span></span>
>
> <span data-ttu-id="28ee7-313">После запуска в приложении ASP.NET Core для ведения общего журнала используйте библиотеку ведения журналов, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-313">For general logging in an ASP.NET Core app after startup, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-314">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-314">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

### <a name="aspnet-core-module-debug-log-azure-app-service"></a><span data-ttu-id="28ee7-315">Журнал отладки модуля ASP.NET Core (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-315">ASP.NET Core Module debug log (Azure App Service)</span></span>

<span data-ttu-id="28ee7-316">В журнал отладки модуля ASP.NET записываются дополнительные и более подробные сообщения, относящиеся к модулю ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-316">The ASP.NET Core Module debug log provides additional, deeper logging from the ASP.NET Core Module.</span></span> <span data-ttu-id="28ee7-317">Чтобы включить и просмотреть журналы stdout, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-317">To enable and view stdout logs:</span></span>

1. <span data-ttu-id="28ee7-318">Чтобы включить ведение расширенного журнала диагностики, выполните одно из следующих действий.</span><span class="sxs-lookup"><span data-stu-id="28ee7-318">To enable the enhanced diagnostic log, perform either of the following:</span></span>
   * <span data-ttu-id="28ee7-319">Следуйте инструкциям по настройке приложения для ведения расширенных журналов диагностики, приведенным в разделе [Расширенные журналы диагностики](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs).</span><span class="sxs-lookup"><span data-stu-id="28ee7-319">Follow the instructions in [Enhanced diagnostic logs](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs) to configure the app for an enhanced diagnostic logging.</span></span> <span data-ttu-id="28ee7-320">Повторно разверните приложение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-320">Redeploy the app.</span></span>
   * <span data-ttu-id="28ee7-321">С помощью консоли Kudu добавьте раздел `<handlerSettings>` в файл *web.config* приложения, как показано в разделе [Расширенные журналы диагностики](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs).</span><span class="sxs-lookup"><span data-stu-id="28ee7-321">Add the `<handlerSettings>` shown in [Enhanced diagnostic logs](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs) to the live app's *web.config* file using the Kudu console:</span></span>
     1. <span data-ttu-id="28ee7-322">В области **Средства разработки** откройте колонку **Дополнительные инструменты**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-322">Open **Advanced Tools** in the **Development Tools** area.</span></span> <span data-ttu-id="28ee7-323">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-323">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-324">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-324">The Kudu console opens in a new browser tab or window.</span></span>
     1. <span data-ttu-id="28ee7-325">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-325">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
     1. <span data-ttu-id="28ee7-326">Откройте папки на пути **веб-сайт** > **wwwroot**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-326">Open the folders to the path **site** > **wwwroot**.</span></span> <span data-ttu-id="28ee7-327">Нажмите кнопку с изображением карандаша и внесите изменения в файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-327">Edit the *web.config* file by selecting the pencil button.</span></span> <span data-ttu-id="28ee7-328">Добавьте раздел `<handlerSettings>`, как описано в разделе [Расширенные журналы диагностики](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs).</span><span class="sxs-lookup"><span data-stu-id="28ee7-328">Add the `<handlerSettings>` section as shown in [Enhanced diagnostic logs](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs).</span></span> <span data-ttu-id="28ee7-329">Нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-329">Select the **Save** button.</span></span>
1. <span data-ttu-id="28ee7-330">В области **Средства разработки** откройте колонку **Дополнительные инструменты**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-330">Open **Advanced Tools** in the **Development Tools** area.</span></span> <span data-ttu-id="28ee7-331">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-331">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-332">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-332">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-333">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-333">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-334">Откройте папки на пути **веб-сайт** > **wwwroot**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-334">Open the folders to the path **site** > **wwwroot**.</span></span> <span data-ttu-id="28ee7-335">Если вы не указали путь к файлу *aspnetcore-debug.log*, файл появится в списке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-335">If you didn't supply a path for the *aspnetcore-debug.log* file, the file appears in the list.</span></span> <span data-ttu-id="28ee7-336">Если путь указан, перейдите к расположению файла журнала.</span><span class="sxs-lookup"><span data-stu-id="28ee7-336">If you supplied a path, navigate to the location of the log file.</span></span>
1. <span data-ttu-id="28ee7-337">Откройте файл журнала, нажав кнопку с изображением карандаша рядом с именем файла.</span><span class="sxs-lookup"><span data-stu-id="28ee7-337">Open the log file with the pencil button next to the file name.</span></span>

<span data-ttu-id="28ee7-338">Завершив устранение неполадок, отключите ведение журнала отладки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-338">Disable debug logging when troubleshooting is complete:</span></span>

<span data-ttu-id="28ee7-339">Чтобы отключить ведение расширенных журналов отладки, выполните одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="28ee7-339">To disable the enhanced debug log, perform either of the following:</span></span>

* <span data-ttu-id="28ee7-340">Удалите раздел `<handlerSettings>` из файла *web.config* локально и повторно разверните приложение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-340">Remove the `<handlerSettings>` from the *web.config* file locally and redeploy the app.</span></span>
* <span data-ttu-id="28ee7-341">С помощью консоли Kudu внесите изменения в файл *web.config* и удалите раздел `<handlerSettings>`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-341">Use the Kudu console to edit the *web.config* file and remove the `<handlerSettings>` section.</span></span> <span data-ttu-id="28ee7-342">Сохраните файл.</span><span class="sxs-lookup"><span data-stu-id="28ee7-342">Save the file.</span></span>

<span data-ttu-id="28ee7-343">Для получения дополнительной информации см. <xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-343">For more information, see <xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs>.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-344">Ошибка при отключении журнала отладки может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-344">Failure to disable the debug log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-345">Ограничения на размер файла журнала отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="28ee7-345">There's no limit on log file size.</span></span> <span data-ttu-id="28ee7-346">Для устранения неполадок при запуске приложения используйте только журнал отладки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-346">Only use debug logging to troubleshoot app startup problems.</span></span>
>
> <span data-ttu-id="28ee7-347">После запуска в приложении ASP.NET Core для ведения общего журнала используйте библиотеку ведения журналов, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-347">For general logging in an ASP.NET Core app after startup, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-348">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-348">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

### <a name="slow-or-hanging-app-azure-app-service"></a><span data-ttu-id="28ee7-349">Медленное или зависающее приложение (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-349">Slow or hanging app (Azure App Service)</span></span>

<span data-ttu-id="28ee7-350">Если приложение медленно реагирует на запрос или зависает при его обработке, см. следующие статьи:</span><span class="sxs-lookup"><span data-stu-id="28ee7-350">When an app responds slowly or hangs on a request, see the following articles:</span></span>

* [<span data-ttu-id="28ee7-351">Устранение проблем с производительностью медленных веб приложений в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-351">Troubleshoot slow web app performance issues in Azure App Service</span></span>](/azure/app-service/app-service-web-troubleshoot-performance-degradation)
* <span data-ttu-id="28ee7-352">[Use Crash Diagnoser Site Extension to Capture Dump for Intermittent Exception issues or performance issues on Azure Web App (Использование расширения сайта средства диагностики сбоев для записи дампа при периодических проблемах с исключением или проблемах с производительностью в веб-приложении Azure)](https://blogs.msdn.microsoft.com/asiatech/2015/12/28/use-crash-diagnoser-site-extension-to-capture-dump-for-intermittent-exception-issues-or-performance-issues-on-azure-web-app/).</span><span class="sxs-lookup"><span data-stu-id="28ee7-352">[Use Crash Diagnoser Site Extension to Capture Dump for Intermittent Exception issues or performance issues on Azure Web App](https://blogs.msdn.microsoft.com/asiatech/2015/12/28/use-crash-diagnoser-site-extension-to-capture-dump-for-intermittent-exception-issues-or-performance-issues-on-azure-web-app/)</span></span>

### <a name="monitoring-blades"></a><span data-ttu-id="28ee7-353">Мониторинг колонок</span><span class="sxs-lookup"><span data-stu-id="28ee7-353">Monitoring blades</span></span>

<span data-ttu-id="28ee7-354">Мониторинг колонок обеспечивает альтернативный поиск неисправностей методам, описанным ранее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="28ee7-354">Monitoring blades provide an alternative troubleshooting experience to the methods described earlier in the topic.</span></span> <span data-ttu-id="28ee7-355">Эти колонки можно использовать для диагностики ошибок 500-й серии.</span><span class="sxs-lookup"><span data-stu-id="28ee7-355">These blades can be used to diagnose 500-series errors.</span></span>

<span data-ttu-id="28ee7-356">Убедитесь, что установлены расширения ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-356">Confirm that the ASP.NET Core Extensions are installed.</span></span> <span data-ttu-id="28ee7-357">Если расширения не установлены, установите их вручную, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-357">If the extensions aren't installed, install them manually:</span></span>

1. <span data-ttu-id="28ee7-358">В колонке **Средства разработки** выберите колонку **Расширения**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-358">In the **DEVELOPMENT TOOLS** blade section, select the **Extensions** blade.</span></span>
1. <span data-ttu-id="28ee7-359">В списке должны появиться **Расширения ASP.NET Core**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-359">The **ASP.NET Core Extensions** should appear in the list.</span></span>
1. <span data-ttu-id="28ee7-360">Если расширения не установлены, нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-360">If the extensions aren't installed, select the **Add** button.</span></span>
1. <span data-ttu-id="28ee7-361">Выберите из списка **Расширения ASP.NET Core**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-361">Choose the **ASP.NET Core Extensions** from the list.</span></span>
1. <span data-ttu-id="28ee7-362">Для принятия условий нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-362">Select **OK** to accept the legal terms.</span></span>
1. <span data-ttu-id="28ee7-363">Нажмите кнопку **ОК** в колонке **Добавить расширение**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-363">Select **OK** on the **Add extension** blade.</span></span>
1. <span data-ttu-id="28ee7-364">Информационное всплывающее сообщение указывает, когда расширения успешно установятся.</span><span class="sxs-lookup"><span data-stu-id="28ee7-364">An informational pop-up message indicates when the extensions are successfully installed.</span></span>

<span data-ttu-id="28ee7-365">Если ведение журнала stdout не включено, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-365">If stdout logging isn't enabled, follow these steps:</span></span>

1. <span data-ttu-id="28ee7-366">На портале Azure выберите колонку **Дополнительные инструменты** в области **Средства разработки**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-366">In the Azure portal, select the **Advanced Tools** blade in the **DEVELOPMENT TOOLS** area.</span></span> <span data-ttu-id="28ee7-367">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-367">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-368">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-368">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-369">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-369">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-370">Откройте папки на пути **сайт** > **wwwroot** и прокрутите список вниз, пока в нижней части не появится файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-370">Open the folders to the path **site** > **wwwroot** and scroll down to reveal the *web.config* file at the bottom of the list.</span></span>
1. <span data-ttu-id="28ee7-371">Щелкните значок карандаша рядом с файлом *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-371">Click the pencil icon next to the *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-372">Установите для параметра **stdoutLogEnabled** значение `true` и измените путь **stdoutLogFile** на `\\?\%home%\LogFiles\stdout`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-372">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to: `\\?\%home%\LogFiles\stdout`.</span></span>
1. <span data-ttu-id="28ee7-373">Выберите **Сохранить** для сохранения обновленного файла *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-373">Select **Save** to save the updated *web.config* file.</span></span>

<span data-ttu-id="28ee7-374">Перейдите к активации ведения журнала диагностики, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-374">Proceed to activate diagnostic logging:</span></span>

1. <span data-ttu-id="28ee7-375">На портале Azure выберите колонку **Журналы диагностики**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-375">In the Azure portal, select the **Diagnostics logs** blade.</span></span>
1. <span data-ttu-id="28ee7-376">Выберите положение переключателя **Вкл.** для **Вход в приложения (файловая система)** и **Подробные сообщения об ошибках**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-376">Select the **On** switch for **Application Logging (Filesystem)** and **Detailed error messages**.</span></span> <span data-ttu-id="28ee7-377">В верхней части колонки нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-377">Select the **Save** button at the top of the blade.</span></span>
1. <span data-ttu-id="28ee7-378">Чтобы включить трассировку неудачно завершенных запросов, также известную как ведение журнала буферизации событий неудачных запросов (FREB), установите положение переключателя **Вкл.** для **Трассировки неудачно завершенных запросов**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-378">To include failed request tracing, also known as Failed Request Event Buffering (FREB) logging, select the **On** switch for **Failed request tracing**.</span></span>
1. <span data-ttu-id="28ee7-379">На портале выберите колонку **Поток журнала**, которая в списке отображается сразу под колонкой **Журналы диагностики**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-379">Select the **Log stream** blade, which is listed immediately under the **Diagnostics logs** blade in the portal.</span></span>
1. <span data-ttu-id="28ee7-380">Сделайте запрос к приложению.</span><span class="sxs-lookup"><span data-stu-id="28ee7-380">Make a request to the app.</span></span>
1. <span data-ttu-id="28ee7-381">В пределах данных потока журнала указывается причина ошибки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-381">Within the log stream data, the cause of the error is indicated.</span></span>

<span data-ttu-id="28ee7-382">После завершения устранения неполадок обязательно отключите ведение журнала stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-382">Be sure to disable stdout logging when troubleshooting is complete.</span></span>

<span data-ttu-id="28ee7-383">Чтобы просмотреть журналы трассировки неудачно завершенных запросов (журналы FREB), выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-383">To view the failed request tracing logs (FREB logs):</span></span>

1. <span data-ttu-id="28ee7-384">Перейдите к колонке **Диагностика и решение проблем** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-384">Navigate to the **Diagnose and solve problems** blade in the Azure portal.</span></span>
1. <span data-ttu-id="28ee7-385">Выберите **Журналы трассировки неудачно завершенных запросов** из области боковой панели **Средства поддержки**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-385">Select **Failed Request Tracing Logs** from the **SUPPORT TOOLS** area of the sidebar.</span></span>

<span data-ttu-id="28ee7-386">Для получения дополнительной информации см. [Раздел "Трассировка неудачно завершенных запросов" раздела "Включение ведения журналов диагностики для веб-приложений в службе приложений Azure"](/azure/app-service/web-sites-enable-diagnostic-log#failed-request-traces) и ["Вопросы и ответы о производительности приложений для веб-приложений в Azure: как включить трассировку неудачно завершенных запросов?"](/azure/app-service/app-service-web-availability-performance-application-issues-faq#how-do-i-turn-on-failed-request-tracing)</span><span class="sxs-lookup"><span data-stu-id="28ee7-386">See [Failed request traces section of the Enable diagnostics logging for web apps in Azure App Service topic](/azure/app-service/web-sites-enable-diagnostic-log#failed-request-traces) and the [Application performance FAQs for Web Apps in Azure: How do I turn on failed request tracing?](/azure/app-service/app-service-web-availability-performance-application-issues-faq#how-do-i-turn-on-failed-request-tracing) for more information.</span></span>

<span data-ttu-id="28ee7-387">Дополнительные сведения см. в разделе [Включение функции ведения журналов диагностики для веб-приложений в службе приложений Azure](/azure/app-service/web-sites-enable-diagnostic-log).</span><span class="sxs-lookup"><span data-stu-id="28ee7-387">For more information, see [Enable diagnostics logging for web apps in Azure App Service](/azure/app-service/web-sites-enable-diagnostic-log).</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-388">Ошибка при отключении журнала stdout может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-388">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-389">Ни размер файла журнала, ни количество создаваемых файлов журналов ничем не ограничены.</span><span class="sxs-lookup"><span data-stu-id="28ee7-389">There's no limit on log file size or the number of log files created.</span></span>
>
> <span data-ttu-id="28ee7-390">Для обычного ведения журналов для приложения ASP.NET Core используйте библиотеку, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-390">For routine logging in an ASP.NET Core app, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-391">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-391">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

## <a name="troubleshoot-on-iis"></a><span data-ttu-id="28ee7-392">Устранение неполадок в IIS</span><span class="sxs-lookup"><span data-stu-id="28ee7-392">Troubleshoot on IIS</span></span>

### <a name="application-event-log-iis"></a><span data-ttu-id="28ee7-393">Журнал событий приложений (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-393">Application Event Log (IIS)</span></span>

<span data-ttu-id="28ee7-394">Доступ к журналу событий приложений</span><span class="sxs-lookup"><span data-stu-id="28ee7-394">Access the Application Event Log:</span></span>

1. <span data-ttu-id="28ee7-395">Откройте меню "Пуск", выполните поиск по фразе *Просмотр событий* и выберите приложение **Просмотр событий**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-395">Open the Start menu, search for *Event Viewer*, and select the **Event Viewer** app.</span></span>
1. <span data-ttu-id="28ee7-396">В **средстве просмотра событий** откройте узел **Журналы Windows**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-396">In **Event Viewer**, open the **Windows Logs** node.</span></span>
1. <span data-ttu-id="28ee7-397">Выберите **Приложение**, чтобы открыть журнал событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-397">Select **Application** to open the Application Event Log.</span></span>
1. <span data-ttu-id="28ee7-398">Проверьте здесь наличие ошибок, связанных с проблемным приложением.</span><span class="sxs-lookup"><span data-stu-id="28ee7-398">Search for errors associated with the failing app.</span></span> <span data-ttu-id="28ee7-399">Нам нужны ошибки со значениями *Модуль IIS AspNetCore* или *Модуль IIS Express AspNetCore* в столбце *Источник*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-399">Errors have a value of *IIS AspNetCore Module* or *IIS Express AspNetCore Module* in the *Source* column.</span></span>

### <a name="run-the-app-at-a-command-prompt"></a><span data-ttu-id="28ee7-400">Запуск приложения в командной строке</span><span class="sxs-lookup"><span data-stu-id="28ee7-400">Run the app at a command prompt</span></span>

<span data-ttu-id="28ee7-401">Многие ошибки запуска не создают полезные сведения в журнале событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-401">Many startup errors don't produce useful information in the Application Event Log.</span></span> <span data-ttu-id="28ee7-402">Для некоторых ошибок можно найти причину, запустив приложение в командной строке на компьютере размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-402">You can find the cause of some errors by running the app at a command prompt on the hosting system.</span></span>

#### <a name="framework-dependent-deployment"></a><span data-ttu-id="28ee7-403">развертывание, зависящее от платформы;</span><span class="sxs-lookup"><span data-stu-id="28ee7-403">Framework-dependent deployment</span></span>

<span data-ttu-id="28ee7-404">Если развертываемое приложение [зависит от платформы](/dotnet/core/deploying/#framework-dependent-deployments-fdd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-404">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span></span>

1. <span data-ttu-id="28ee7-405">В командной строке перейдите в папку развертывания и запустите приложение, выполнив команду *dotnet.exe* для сборки приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-405">At a command prompt, navigate to the deployment folder and run the app by executing the app's assembly with *dotnet.exe*.</span></span> <span data-ttu-id="28ee7-406">В следующей команде укажите нужное имя сборки вместо заполнителя \<assembly_name>: `dotnet .\<assembly_name>.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-406">In the following command, substitute the name of the app's assembly for \<assembly_name>: `dotnet .\<assembly_name>.dll`.</span></span>
1. <span data-ttu-id="28ee7-407">Выходные данные приложения, в том числе любые ошибки, будут выведены в окно консоли.</span><span class="sxs-lookup"><span data-stu-id="28ee7-407">The console output from the app, showing any errors, is written to the console window.</span></span>
1. <span data-ttu-id="28ee7-408">Если ошибки возникают при выполнении запроса к приложению, выполните запрос к узлу и порту, где Kestrel ожидает передачи данных.</span><span class="sxs-lookup"><span data-stu-id="28ee7-408">If the errors occur when making a request to the app, make a request to the host and port where Kestrel listens.</span></span> <span data-ttu-id="28ee7-409">Создайте запрос к `http://localhost:5000/`, используя узел и порт по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="28ee7-409">Using the default host and post, make a request to `http://localhost:5000/`.</span></span> <span data-ttu-id="28ee7-410">Если приложение отвечает на запросы по адресу конечной точки Kestrel как обычно, то проблема, вероятнее, связана с конфигурацией размещения, а не с самим приложением.</span><span class="sxs-lookup"><span data-stu-id="28ee7-410">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the hosting configuration and less likely within the app.</span></span>

#### <a name="self-contained-deployment"></a><span data-ttu-id="28ee7-411">автономное развертывание;</span><span class="sxs-lookup"><span data-stu-id="28ee7-411">Self-contained deployment</span></span>

<span data-ttu-id="28ee7-412">Если приложение [развертывается автономно](/dotnet/core/deploying/#self-contained-deployments-scd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-412">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd):</span></span>

1. <span data-ttu-id="28ee7-413">В командной строке перейдите в папку развертывания и запустите исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-413">At a command prompt, navigate to the deployment folder and run the app's executable.</span></span> <span data-ttu-id="28ee7-414">В следующей команде укажите нужное имя сборки вместо заполнителя \<assembly_name>: `<assembly_name>.exe`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-414">In the following command, substitute the name of the app's assembly for \<assembly_name>: `<assembly_name>.exe`.</span></span>
1. <span data-ttu-id="28ee7-415">Выходные данные приложения, в том числе любые ошибки, будут выведены в окно консоли.</span><span class="sxs-lookup"><span data-stu-id="28ee7-415">The console output from the app, showing any errors, is written to the console window.</span></span>
1. <span data-ttu-id="28ee7-416">Если ошибки возникают при выполнении запроса к приложению, выполните запрос к узлу и порту, где Kestrel ожидает передачи данных.</span><span class="sxs-lookup"><span data-stu-id="28ee7-416">If the errors occur when making a request to the app, make a request to the host and port where Kestrel listens.</span></span> <span data-ttu-id="28ee7-417">Создайте запрос к `http://localhost:5000/`, используя узел и порт по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="28ee7-417">Using the default host and post, make a request to `http://localhost:5000/`.</span></span> <span data-ttu-id="28ee7-418">Если приложение отвечает на запросы по адресу конечной точки Kestrel как обычно, то проблема, вероятнее, связана с конфигурацией размещения, а не с самим приложением.</span><span class="sxs-lookup"><span data-stu-id="28ee7-418">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the hosting configuration and less likely within the app.</span></span>

### <a name="aspnet-core-module-stdout-log-iis"></a><span data-ttu-id="28ee7-419">Журнал вывода stdout модуля ASP.NET Core (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-419">ASP.NET Core Module stdout log (IIS)</span></span>

<span data-ttu-id="28ee7-420">Чтобы включить и просмотреть журналы stdout, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-420">To enable and view stdout logs:</span></span>

1. <span data-ttu-id="28ee7-421">Перейдите в папку развертывания сайта на компьютере размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-421">Navigate to the site's deployment folder on the hosting system.</span></span>
1. <span data-ttu-id="28ee7-422">Если здесь нет папки *logs*, создайте ее.</span><span class="sxs-lookup"><span data-stu-id="28ee7-422">If the *logs* folder isn't present, create the folder.</span></span> <span data-ttu-id="28ee7-423">Сведения о том, как настроить в MSBuild автоматическое создание папки *logs* в развертывании, см. в статье [о структуре каталогов](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="28ee7-423">For instructions on how to enable MSBuild to create the *logs* folder in the deployment automatically, see the [Directory structure](xref:host-and-deploy/directory-structure) topic.</span></span>
1. <span data-ttu-id="28ee7-424">Измените файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-424">Edit the *web.config* file.</span></span> <span data-ttu-id="28ee7-425">Задайте для параметра **stdoutLogEnabled** значение `true` и измените путь **stdoutLogFile** так, чтобы он указывал на папку *logs* (например, `.\logs\stdout`).</span><span class="sxs-lookup"><span data-stu-id="28ee7-425">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to point to the *logs* folder (for example, `.\logs\stdout`).</span></span> <span data-ttu-id="28ee7-426">В этом пути `stdout` обозначает префикс имени для файла журнала.</span><span class="sxs-lookup"><span data-stu-id="28ee7-426">`stdout` in the path is the log file name prefix.</span></span> <span data-ttu-id="28ee7-427">При создании файла журнала автоматически добавляются метка времени, идентификатор процесса и расширение файла.</span><span class="sxs-lookup"><span data-stu-id="28ee7-427">A timestamp, process id, and file extension are added automatically when the log is created.</span></span> <span data-ttu-id="28ee7-428">Если указан префикс файла `stdout`, стандартный файл журнала будет иметь примерно такое имя: *stdout_20180205184032_5412.log*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-428">Using `stdout` as the file name prefix, a typical log file is named *stdout_20180205184032_5412.log*.</span></span>
1. <span data-ttu-id="28ee7-429">Убедитесь, что удостоверение пула приложений имеет разрешения на запись в папку *logs*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-429">Ensure your application pool's identity has write permissions to the *logs* folder.</span></span>
1. <span data-ttu-id="28ee7-430">Сохраните обновленный файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-430">Save the updated *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-431">Сделайте запрос к приложению.</span><span class="sxs-lookup"><span data-stu-id="28ee7-431">Make a request to the app.</span></span>
1. <span data-ttu-id="28ee7-432">Перейдите в папку *logs*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-432">Navigate to the *logs* folder.</span></span> <span data-ttu-id="28ee7-433">Найдите и откройте последний журнал вывода stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-433">Find and open the most recent stdout log.</span></span>
1. <span data-ttu-id="28ee7-434">Проверьте, нет ли в нем ошибок.</span><span class="sxs-lookup"><span data-stu-id="28ee7-434">Study the log for errors.</span></span>

<span data-ttu-id="28ee7-435">Завершив устранение неполадок, отключите ведение журнала stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-435">Disable stdout logging when troubleshooting is complete:</span></span>

1. <span data-ttu-id="28ee7-436">Измените файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-436">Edit the *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-437">Задайте параметру **stdoutLogEnabled** значение `false`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-437">Set **stdoutLogEnabled** to `false`.</span></span>
1. <span data-ttu-id="28ee7-438">Сохраните файл.</span><span class="sxs-lookup"><span data-stu-id="28ee7-438">Save the file.</span></span>

<span data-ttu-id="28ee7-439">Для получения дополнительной информации см. <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-439">For more information, see <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-440">Ошибка при отключении журнала stdout может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-440">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-441">Ни размер файла журнала, ни количество создаваемых файлов журналов ничем не ограничены.</span><span class="sxs-lookup"><span data-stu-id="28ee7-441">There's no limit on log file size or the number of log files created.</span></span>
>
> <span data-ttu-id="28ee7-442">Для обычного ведения журналов для приложения ASP.NET Core используйте библиотеку, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-442">For routine logging in an ASP.NET Core app, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-443">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-443">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

### <a name="aspnet-core-module-debug-log-iis"></a><span data-ttu-id="28ee7-444">Журнал отладки модуля ASP.NET Core (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-444">ASP.NET Core Module debug log (IIS)</span></span>

<span data-ttu-id="28ee7-445">Добавьте следующие параметры обработчика в файл *web.config* приложения, чтобы включить журнал отладки модулей ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="28ee7-445">Add the following handler settings to the app's *web.config* file to enable ASP.NET Core Module debug log:</span></span>

```xml
<aspNetCore ...>
  <handlerSettings>
    <handlerSetting name="debugLevel" value="file" />
    <handlerSetting name="debugFile" value="c:\temp\ancm.log" />
  </handlerSettings>
</aspNetCore>
```

<span data-ttu-id="28ee7-446">Убедитесь, что указанный для журнала путь существует и удостоверение пула приложений имеет разрешения на запись в это расположение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-446">Confirm that the path specified for the log exists and that the app pool's identity has write permissions to the location.</span></span>

<span data-ttu-id="28ee7-447">Для получения дополнительной информации см. <xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-447">For more information, see <xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs>.</span></span>

### <a name="enable-the-developer-exception-page"></a><span data-ttu-id="28ee7-448">Включение страницы исключений для разработчика</span><span class="sxs-lookup"><span data-stu-id="28ee7-448">Enable the Developer Exception Page</span></span>

<span data-ttu-id="28ee7-449">Можно добавить переменную среды `ASPNETCORE_ENVIRONMENT` [в файл web.config](xref:host-and-deploy/aspnet-core-module#setting-environment-variables), чтобы запустить приложение в среде разработки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-449">The `ASPNETCORE_ENVIRONMENT` [environment variable can be added to web.config](xref:host-and-deploy/aspnet-core-module#setting-environment-variables) to run the app in the Development environment.</span></span> <span data-ttu-id="28ee7-450">Если среда не переопределяется при запуске приложения использованием `UseEnvironment` в конструкторе узла, эта переменная среды позволяет отображать [страницу исключения для разработчика](xref:fundamentals/error-handling) при запуске приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-450">As long as the environment isn't overridden in app startup by `UseEnvironment` on the host builder, setting the environment variable allows the [Developer Exception Page](xref:fundamentals/error-handling) to appear when the app is run.</span></span>

```xml
<aspNetCore processPath="dotnet"
      arguments=".\MyApp.dll"
      stdoutLogEnabled="false"
      stdoutLogFile=".\logs\stdout"
      hostingModel="InProcess">
  <environmentVariables>
    <environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Development" />
  </environmentVariables>
</aspNetCore>
```

<span data-ttu-id="28ee7-451">Настройка переменной среды `ASPNETCORE_ENVIRONMENT` рекомендуется только на промежуточных и тестовых серверах, доступ к которым из Интернета закрыт.</span><span class="sxs-lookup"><span data-stu-id="28ee7-451">Setting the environment variable for `ASPNETCORE_ENVIRONMENT` is only recommended for use on staging and testing servers that aren't exposed to the Internet.</span></span> <span data-ttu-id="28ee7-452">Завершив устранение неполадок, удалите эту переменную среды из файла *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-452">Remove the environment variable from the *web.config* file after troubleshooting.</span></span> <span data-ttu-id="28ee7-453">Сведения о настройке переменных среды в файле *web.config* см. в статье о [дочернем элементе environmentVariables в aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span><span class="sxs-lookup"><span data-stu-id="28ee7-453">For information on setting environment variables in *web.config*, see [environmentVariables child element of aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span></span>

### <a name="obtain-data-from-an-app"></a><span data-ttu-id="28ee7-454">Получение данных из приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-454">Obtain data from an app</span></span>

<span data-ttu-id="28ee7-455">Если приложение способно отвечать на запросы, получите данные о запросе, подключении и дополнительные данные из приложений с помощью встроенного терминала ПО промежуточного слоя.</span><span class="sxs-lookup"><span data-stu-id="28ee7-455">If an app is capable of responding to requests, obtain request, connection, and additional data from the app using terminal inline middleware.</span></span> <span data-ttu-id="28ee7-456">Дополнительные сведения и примеры с кодом см. здесь: <xref:test/troubleshoot#obtain-data-from-an-app>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-456">For more information and sample code, see <xref:test/troubleshoot#obtain-data-from-an-app>.</span></span>

### <a name="slow-or-hanging-app-iis"></a><span data-ttu-id="28ee7-457">Медленное или зависающее приложение (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-457">Slow or hanging app (IIS)</span></span>

<span data-ttu-id="28ee7-458">*Аварийный дамп* — это моментальный снимок системной памяти, который может помочь определить причину аварийного завершения, сбоя запуска или медленной работы приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-458">A *crash dump* is a snapshot of the system's memory and can help determine the cause of an app crash, startup failure, or slow app.</span></span>

#### <a name="app-crashes-or-encounters-an-exception"></a><span data-ttu-id="28ee7-459">Аварийное завершение работы приложения или исключение</span><span class="sxs-lookup"><span data-stu-id="28ee7-459">App crashes or encounters an exception</span></span>

<span data-ttu-id="28ee7-460">Получите и проанализируйте дамп из [отчетов об ошибках Windows (WER)](/windows/desktop/wer/windows-error-reporting):</span><span class="sxs-lookup"><span data-stu-id="28ee7-460">Obtain and analyze a dump from [Windows Error Reporting (WER)](/windows/desktop/wer/windows-error-reporting):</span></span>

1. <span data-ttu-id="28ee7-461">Создайте папку для хранения файлов аварийного дампа в `c:\dumps`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-461">Create a folder to hold crash dump files at `c:\dumps`.</span></span> <span data-ttu-id="28ee7-462">Пул приложений должен иметь доступ на запись к папке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-462">The app pool must have write access to the folder.</span></span>
1. <span data-ttu-id="28ee7-463">Запустите [скрипт PowerShell EnableDumps](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/EnableDumps.ps1):</span><span class="sxs-lookup"><span data-stu-id="28ee7-463">Run the [EnableDumps PowerShell script](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/EnableDumps.ps1):</span></span>
   * <span data-ttu-id="28ee7-464">Если приложение использует [модель размещения в процессе](xref:host-and-deploy/iis/index#in-process-hosting-model), выполните скрипт для *w3wp.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-464">If the app uses the [in-process hosting model](xref:host-and-deploy/iis/index#in-process-hosting-model), run the script for *w3wp.exe*:</span></span>

     ```console
     .\EnableDumps w3wp.exe c:\dumps
     ```

   * <span data-ttu-id="28ee7-465">Если приложение использует [модель размещения вне процесса](xref:host-and-deploy/iis/index#out-of-process-hosting-model), выполните скрипт для *dotnet.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-465">If the app uses the [out-of-process hosting model](xref:host-and-deploy/iis/index#out-of-process-hosting-model), run the script for *dotnet.exe*:</span></span>

     ```console
     .\EnableDumps dotnet.exe c:\dumps
     ```

1. <span data-ttu-id="28ee7-466">Запустите приложение в условиях, вызывающих аварийное завершение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-466">Run the app under the conditions that cause the crash to occur.</span></span>
1. <span data-ttu-id="28ee7-467">После аварийного завершения запустите [скрипт PowerShell DisableDumps](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/DisableDumps.ps1):</span><span class="sxs-lookup"><span data-stu-id="28ee7-467">After the crash has occurred, run the [DisableDumps PowerShell script](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/DisableDumps.ps1):</span></span>
   * <span data-ttu-id="28ee7-468">Если приложение использует [модель размещения в процессе](xref:host-and-deploy/iis/index#in-process-hosting-model), выполните скрипт для *w3wp.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-468">If the app uses the [in-process hosting model](xref:host-and-deploy/iis/index#in-process-hosting-model), run the script for *w3wp.exe*:</span></span>

     ```console
     .\DisableDumps w3wp.exe
     ```

   * <span data-ttu-id="28ee7-469">Если приложение использует [модель размещения вне процесса](xref:host-and-deploy/iis/index#out-of-process-hosting-model), выполните скрипт для *dotnet.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-469">If the app uses the [out-of-process hosting model](xref:host-and-deploy/iis/index#out-of-process-hosting-model), run the script for *dotnet.exe*:</span></span>

     ```console
     .\DisableDumps dotnet.exe
     ```

<span data-ttu-id="28ee7-470">Когда приложение аварийно завершит работу и сбор дампов будет выполнен, приложение сможет завершить работу обычным образом.</span><span class="sxs-lookup"><span data-stu-id="28ee7-470">After an app crashes and dump collection is complete, the app is allowed to terminate normally.</span></span> <span data-ttu-id="28ee7-471">Скрипт PowerShell настраивает отчеты об ошибках Windows для сбора до пяти дампов для приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-471">The PowerShell script configures WER to collect up to five dumps per app.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-472">Аварийные дампы могут занимать много места на диске (до нескольких гигабайтов каждый).</span><span class="sxs-lookup"><span data-stu-id="28ee7-472">Crash dumps might take up a large amount of disk space (up to several gigabytes each).</span></span>

#### <a name="app-hangs-fails-during-startup-or-runs-normally"></a><span data-ttu-id="28ee7-473">Приложение перестает отвечать на запросы, не запускается или работает в обычном режиме</span><span class="sxs-lookup"><span data-stu-id="28ee7-473">App hangs, fails during startup, or runs normally</span></span>

<span data-ttu-id="28ee7-474">Когда приложение *перестает отвечать на запросы* (но аварийное завершение не происходит), не запускается или работает в обычном режиме, см. раздел [Файлы дампа пользовательского режима: выбор лучшего инструмента](/windows-hardware/drivers/debugger/user-mode-dump-files#choosing-the-best-tool), чтобы выбрать подходящий инструмент для создания дампа.</span><span class="sxs-lookup"><span data-stu-id="28ee7-474">When an app *hangs* (stops responding but doesn't crash), fails during startup, or runs normally, see [User-Mode Dump Files: Choosing the Best Tool](/windows-hardware/drivers/debugger/user-mode-dump-files#choosing-the-best-tool) to select an appropriate tool to produce the dump.</span></span>

#### <a name="analyze-the-dump"></a><span data-ttu-id="28ee7-475">Анализ дампа</span><span class="sxs-lookup"><span data-stu-id="28ee7-475">Analyze the dump</span></span>

<span data-ttu-id="28ee7-476">Дамп можно проанализировать несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="28ee7-476">A dump can be analyzed using several approaches.</span></span> <span data-ttu-id="28ee7-477">Дополнительные сведения см. в разделе [Анализ файла дампа пользовательского режима](/windows-hardware/drivers/debugger/analyzing-a-user-mode-dump-file).</span><span class="sxs-lookup"><span data-stu-id="28ee7-477">For more information, see [Analyzing a User-Mode Dump File](/windows-hardware/drivers/debugger/analyzing-a-user-mode-dump-file).</span></span>

## <a name="clear-package-caches"></a><span data-ttu-id="28ee7-478">Очистка кэшей пакетов</span><span class="sxs-lookup"><span data-stu-id="28ee7-478">Clear package caches</span></span>

<span data-ttu-id="28ee7-479">Приложения-функции могут перестать работать сразу после обновления пакета SDK для .NET Core на компьютере разработки или обновления версии пакетов в самом приложении.</span><span class="sxs-lookup"><span data-stu-id="28ee7-479">A functioning app may fail immediately after upgrading either the .NET Core SDK on the development machine or changing package versions within the app.</span></span> <span data-ttu-id="28ee7-480">В некоторых случаях в результате важного обновления несогласованные версии пакетов могут привести к нарушению работы приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-480">In some cases, incoherent packages may break an app when performing major upgrades.</span></span> <span data-ttu-id="28ee7-481">Большинство этих проблем можно исправить следующим образом:</span><span class="sxs-lookup"><span data-stu-id="28ee7-481">Most of these issues can be fixed by following these instructions:</span></span>

1. <span data-ttu-id="28ee7-482">Удалите папки *bin* и *obj*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-482">Delete the *bin* and *obj* folders.</span></span>
1. <span data-ttu-id="28ee7-483">Очистите кэши пакетов, выполнив команду [dotnet nuget locals all --clear](/dotnet/core/tools/dotnet-nuget-locals) из командной оболочки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-483">Clear the package caches by executing [dotnet nuget locals all --clear](/dotnet/core/tools/dotnet-nuget-locals) from a command shell.</span></span>

   <span data-ttu-id="28ee7-484">Очистку кэшей пакетов также можно выполнить с помощью средства [nuget.exe](https://www.nuget.org/downloads) или команды `nuget locals all -clear`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-484">Clearing package caches can also be accomplished with the [nuget.exe](https://www.nuget.org/downloads) tool and executing the command `nuget locals all -clear`.</span></span> <span data-ttu-id="28ee7-485">*NuGet.exe* не входит в пакет установки операционной системы Windows для настольных компьютеров и его нужно получить отдельно на [веб-сайте NuGet](https://www.nuget.org/downloads).</span><span class="sxs-lookup"><span data-stu-id="28ee7-485">*nuget.exe* isn't a bundled install with the Windows desktop operating system and must be obtained separately from the [NuGet website](https://www.nuget.org/downloads).</span></span>

1. <span data-ttu-id="28ee7-486">Восстановите и перестройте проект.</span><span class="sxs-lookup"><span data-stu-id="28ee7-486">Restore and rebuild the project.</span></span>
1. <span data-ttu-id="28ee7-487">Удалите все файлы из папки развертывания на сервере, прежде чем повторно развернуть приложение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-487">Delete all of the files in the deployment folder on the server prior to redeploying the app.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="28ee7-488">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="28ee7-488">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:host-and-deploy/azure-iis-errors-reference>
* <xref:fundamentals/error-handling>
* <xref:host-and-deploy/aspnet-core-module>

### <a name="azure-documentation"></a><span data-ttu-id="28ee7-489">Документация по Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-489">Azure documentation</span></span>

* [<span data-ttu-id="28ee7-490">Application Insights для ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="28ee7-490">Application Insights for ASP.NET Core</span></span>](/azure/application-insights/app-insights-asp-net-core)
* [<span data-ttu-id="28ee7-491">Раздел "Веб-приложения удаленной отладки" статьи "Устранение неполадок веб-приложения в Службе приложений Azure с помощью Visual Studio"</span><span class="sxs-lookup"><span data-stu-id="28ee7-491">Remote debugging web apps section of Troubleshoot a web app in Azure App Service using Visual Studio</span></span>](/azure/app-service/web-sites-dotnet-troubleshoot-visual-studio#remotedebug)
* [<span data-ttu-id="28ee7-492">Общие сведения о диагностике в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-492">Azure App Service diagnostics overview</span></span>](/azure/app-service/app-service-diagnostics)
* [<span data-ttu-id="28ee7-493">Практическое руководство. Мониторинг приложений в Службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-493">How to: Monitor Apps in Azure App Service</span></span>](/azure/app-service/web-sites-monitor)
* [<span data-ttu-id="28ee7-494">Устранение неполадок веб-приложения в службе приложений Azure с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="28ee7-494">Troubleshoot a web app in Azure App Service using Visual Studio</span></span>](/azure/app-service/web-sites-dotnet-troubleshoot-visual-studio)
* [<span data-ttu-id="28ee7-495">Устранение ошибок HTTP "502 — недопустимый шлюз" и "503 — служба недоступна" в веб-приложениях Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-495">Troubleshoot HTTP errors of "502 bad gateway" and "503 service unavailable" in your Azure web apps</span></span>](/azure/app-service/app-service-web-troubleshoot-http-502-http-503)
* [<span data-ttu-id="28ee7-496">Устранение проблем с производительностью медленных веб приложений в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-496">Troubleshoot slow web app performance issues in Azure App Service</span></span>](/azure/app-service/app-service-web-troubleshoot-performance-degradation)
* [<span data-ttu-id="28ee7-497">Вопросы и ответы о производительности приложений для веб-приложений в Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-497">Application performance FAQs for Web Apps in Azure</span></span>](/azure/app-service/app-service-web-availability-performance-application-issues-faq)
* [<span data-ttu-id="28ee7-498">"Песочница" веб-приложений Azure (ограничения работы среды выполнения службы приложений)</span><span class="sxs-lookup"><span data-stu-id="28ee7-498">Azure Web App sandbox (App Service runtime execution limitations)</span></span>](https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox)
* [<span data-ttu-id="28ee7-499">Пятница с Azure. Практика диагностики и устранения неполадок в Службе приложений Azure (12-минутное видео)</span><span class="sxs-lookup"><span data-stu-id="28ee7-499">Azure Friday: Azure App Service Diagnostic and Troubleshooting Experience (12-minute video)</span></span>](https://channel9.msdn.com/Shows/Azure-Friday/Azure-App-Service-Diagnostic-and-Troubleshooting-Experience)

### <a name="visual-studio-documentation"></a><span data-ttu-id="28ee7-500">Документация по Visual Studio</span><span class="sxs-lookup"><span data-stu-id="28ee7-500">Visual Studio documentation</span></span>

* [<span data-ttu-id="28ee7-501">Удаленная отладка ASP.NET Core в IIS в Azure в Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="28ee7-501">Remote Debug ASP.NET Core on IIS in Azure in Visual Studio 2017</span></span>](/visualstudio/debugger/remote-debugging-azure)
* [<span data-ttu-id="28ee7-502">Удаленная отладка ASP.NET Core на удаленном компьютере IIS в Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="28ee7-502">Remote Debug ASP.NET Core on a Remote IIS Computer in Visual Studio 2017</span></span>](/visualstudio/debugger/remote-debugging-aspnet-on-a-remote-iis-computer)
* [<span data-ttu-id="28ee7-503">Сведения об отладке с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="28ee7-503">Learn to debug using Visual Studio</span></span>](/visualstudio/debugger/getting-started-with-the-debugger)

### <a name="visual-studio-code-documentation"></a><span data-ttu-id="28ee7-504">Документация по Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="28ee7-504">Visual Studio Code documentation</span></span>

* [<span data-ttu-id="28ee7-505">Отладка с помощью Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="28ee7-505">Debugging with Visual Studio Code</span></span>](https://code.visualstudio.com/docs/editor/debugging)

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="28ee7-506">В этой статье содержатся сведения об общих ошибках запуска приложений и инструкции по диагностике ошибок при развертывании приложения в Службе приложений Azure или службах IIS:</span><span class="sxs-lookup"><span data-stu-id="28ee7-506">This article provides information on common app startup errors and instructions on how to diagnose errors when an app is deployed to Azure App Service or IIS:</span></span>

[<span data-ttu-id="28ee7-507">Ошибки при запуске приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-507">App startup errors</span></span>](#app-startup-errors)  
<span data-ttu-id="28ee7-508">Описание распространенных сценариев кода состояния HTTP для запуска.</span><span class="sxs-lookup"><span data-stu-id="28ee7-508">Explains common startup HTTP status code scenarios.</span></span>

[<span data-ttu-id="28ee7-509">Устранение неполадок в Службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-509">Troubleshoot on Azure App Service</span></span>](#troubleshoot-on-azure-app-service)  
<span data-ttu-id="28ee7-510">Рекомендации по устранению неполадок для приложений, развернутых в Службе приложений Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-510">Provides troubleshooting advice for apps deployed to Azure App Service.</span></span>

[<span data-ttu-id="28ee7-511">Устранение неполадок в IIS</span><span class="sxs-lookup"><span data-stu-id="28ee7-511">Troubleshoot on IIS</span></span>](#troubleshoot-on-iis)  
<span data-ttu-id="28ee7-512">Рекомендации по устранению неполадок для приложений, развернутых в службах IIS или запущенных на IIS Express локально.</span><span class="sxs-lookup"><span data-stu-id="28ee7-512">Provides troubleshooting advice for apps deployed to IIS or running on IIS Express locally.</span></span> <span data-ttu-id="28ee7-513">Руководство относится к развертываниям Windows Server и Windows Desktop.</span><span class="sxs-lookup"><span data-stu-id="28ee7-513">The guidance applies to both Windows Server and Windows desktop deployments.</span></span>

[<span data-ttu-id="28ee7-514">Очистка кэшей пакетов</span><span class="sxs-lookup"><span data-stu-id="28ee7-514">Clear package caches</span></span>](#clear-package-caches)  
<span data-ttu-id="28ee7-515">Рекомендации о том, что делать, когда несогласованные пакеты нарушают работу приложения при установке основных обновлений или изменении версий пакета.</span><span class="sxs-lookup"><span data-stu-id="28ee7-515">Explains what to do when incoherent packages break an app when performing major upgrades or changing package versions.</span></span>

[<span data-ttu-id="28ee7-516">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="28ee7-516">Additional resources</span></span>](#additional-resources)  
<span data-ttu-id="28ee7-517">Дополнительные статьи по устранению неполадок.</span><span class="sxs-lookup"><span data-stu-id="28ee7-517">Lists additional troubleshooting topics.</span></span>

## <a name="app-startup-errors"></a><span data-ttu-id="28ee7-518">Ошибки при запуске приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-518">App startup errors</span></span>

<span data-ttu-id="28ee7-519">В Visual Studio проект ASP.NET Core по умолчанию использует размещение в [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview) на период отладки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-519">In Visual Studio, an ASP.NET Core project defaults to [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview) hosting during debugging.</span></span> <span data-ttu-id="28ee7-520">Рекомендации в этой статье позволяют диагностировать неполадки, проявляющиеся как *502.5 — ошибка процесса* или *500.30 — ошибка запуска* при локальной отладке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-520">A *502.5 - Process Failure* or a *500.30 - Start Failure* that occurs when debugging locally can be diagnosed using the advice in this topic.</span></span>

### <a name="40314-forbidden"></a><span data-ttu-id="28ee7-521">403.14 (Запрещено)</span><span class="sxs-lookup"><span data-stu-id="28ee7-521">403.14 Forbidden</span></span>

<span data-ttu-id="28ee7-522">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-522">The app fails to start.</span></span> <span data-ttu-id="28ee7-523">В журнал записывается следующая ошибка:</span><span class="sxs-lookup"><span data-stu-id="28ee7-523">The following error is logged:</span></span>

```
The Web server is configured to not list the contents of this directory.
```

<span data-ttu-id="28ee7-524">Эта ошибка обычно вызвана неработающим развертыванием в системе размещения в следующих сценариях:</span><span class="sxs-lookup"><span data-stu-id="28ee7-524">The error is usually caused by a broken deployment on the hosting system, which includes any of the following scenarios:</span></span>

* <span data-ttu-id="28ee7-525">Приложение развертывается в неверной папке в системе размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-525">The app is deployed to the wrong folder on the hosting system.</span></span>
* <span data-ttu-id="28ee7-526">Процессу развертывания не удалось переместить все файлы и папки приложения в папку развертывания в системе размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-526">The deployment process failed to move all of the app's files and folders to the deployment folder on the hosting system.</span></span>
* <span data-ttu-id="28ee7-527">Файл *web.config* отсутствует в развертывании, или содержимое файла *web.config* имеет неправильную структуру.</span><span class="sxs-lookup"><span data-stu-id="28ee7-527">The *web.config* file is missing from the deployment, or the *web.config* file contents are malformed.</span></span>

<span data-ttu-id="28ee7-528">Выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="28ee7-528">Perform the following steps:</span></span>

1. <span data-ttu-id="28ee7-529">Удалите все файлы и папки из папки развертывания в системе размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-529">Delete all of the files and folders from the deployment folder on the hosting system.</span></span>
1. <span data-ttu-id="28ee7-530">Повторно разверните содержимое папки *publish* приложения в системе размещения с помощью обычного метода развертывания, например Visual Studio, PowerShell или развертывание вручную:</span><span class="sxs-lookup"><span data-stu-id="28ee7-530">Redeploy the contents of the app's *publish* folder to the hosting system using your normal method of deployment, such as Visual Studio, PowerShell, or manual deployment:</span></span>
   * <span data-ttu-id="28ee7-531">Убедитесь, что файл *web.config* находится в развертывании и имеет правильное содержимое.</span><span class="sxs-lookup"><span data-stu-id="28ee7-531">Confirm that the *web.config* file is present in the deployment and that its contents are correct.</span></span>
   * <span data-ttu-id="28ee7-532">При размещении в Службе приложений Azure убедитесь, что приложение развернуто в папке `D:\home\site\wwwroot`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-532">When hosting on Azure App Service, confirm that the app is deployed to the `D:\home\site\wwwroot` folder.</span></span>
   * <span data-ttu-id="28ee7-533">Если приложение размещено в IIS, убедитесь, что оно развернуто по **физическому пути** служб IIS, указанному в **базовых параметрах** в **диспетчере IIS**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-533">When the app is hosted by IIS, confirm that the app is deployed to the IIS **Physical path** shown in **IIS Manager**'s **Basic Settings**.</span></span>
1. <span data-ttu-id="28ee7-534">Убедитесь, что все файлы и папки приложения развернуты путем сравнения развертывания в системе размещения с содержимым папки проекта *publish*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-534">Confirm that all of the app's files and folders are deployed by comparing the deployment on the hosting system to the contents of the project's *publish* folder.</span></span>

<span data-ttu-id="28ee7-535">Дополнительные сведения о макете опубликованного приложения ASP.NET Core см. в разделе <xref:host-and-deploy/directory-structure>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-535">For more information on the layout of a published ASP.NET Core app, see <xref:host-and-deploy/directory-structure>.</span></span> <span data-ttu-id="28ee7-536">Дополнительные сведения о файле *web.config* см. в разделе <xref:host-and-deploy/aspnet-core-module#configuration-with-webconfig>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-536">For more information on the *web.config* file, see <xref:host-and-deploy/aspnet-core-module#configuration-with-webconfig>.</span></span>

### <a name="500-internal-server-error"></a><span data-ttu-id="28ee7-537">500 Internal Server Error (внутренняя ошибка сервера)</span><span class="sxs-lookup"><span data-stu-id="28ee7-537">500 Internal Server Error</span></span>

<span data-ttu-id="28ee7-538">Приложение запускается, но ошибка не позволяет серверу выполнить запрос.</span><span class="sxs-lookup"><span data-stu-id="28ee7-538">The app starts, but an error prevents the server from fulfilling the request.</span></span>

<span data-ttu-id="28ee7-539">Эта ошибка возникает в коде приложения при запуске или при создании ответа.</span><span class="sxs-lookup"><span data-stu-id="28ee7-539">This error occurs within the app's code during startup or while creating a response.</span></span> <span data-ttu-id="28ee7-540">Ответ может не иметь содержимого или ответ в браузере может выглядеть как *500 — внутренняя ошибка сервера*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-540">The response may contain no content, or the response may appear as a *500 Internal Server Error* in the browser.</span></span> <span data-ttu-id="28ee7-541">Как правило, в журнале событий приложения указывается, что приложение запускается в обычном режиме.</span><span class="sxs-lookup"><span data-stu-id="28ee7-541">The Application Event Log usually states that the app started normally.</span></span> <span data-ttu-id="28ee7-542">Сервер действует правильно.</span><span class="sxs-lookup"><span data-stu-id="28ee7-542">From the server's perspective, that's correct.</span></span> <span data-ttu-id="28ee7-543">Приложение запустилось, но оно не может генерировать действительный ответ.</span><span class="sxs-lookup"><span data-stu-id="28ee7-543">The app did start, but it can't generate a valid response.</span></span> <span data-ttu-id="28ee7-544">Чтобы устранить проблему, запустите приложение в командной строке на сервере или включите журнал вывода stdout для модуля ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-544">Run the app at a command prompt on the server or enable the ASP.NET Core Module stdout log to troubleshoot the problem.</span></span>

### <a name="5000-in-process-handler-load-failure"></a><span data-ttu-id="28ee7-545">500.0 In-Process Handler Load Failure (ошибка загрузки внутрипроцессного обработчика)</span><span class="sxs-lookup"><span data-stu-id="28ee7-545">500.0 In-Process Handler Load Failure</span></span>

<span data-ttu-id="28ee7-546">Рабочий процесс завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="28ee7-546">The worker process fails.</span></span> <span data-ttu-id="28ee7-547">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-547">The app doesn't start.</span></span>

<span data-ttu-id="28ee7-548">[Модулю ASP.NET Core](xref:host-and-deploy/aspnet-core-module) не удается найти среду CLR .NET Core и внутрипроцессный обработчик запросов (*aspnetcorev2_inprocess.dll*).</span><span class="sxs-lookup"><span data-stu-id="28ee7-548">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) fails to find the .NET Core CLR and find the in-process request handler (*aspnetcorev2_inprocess.dll*).</span></span> <span data-ttu-id="28ee7-549">Проверьте следующие моменты:</span><span class="sxs-lookup"><span data-stu-id="28ee7-549">Check that:</span></span>

* <span data-ttu-id="28ee7-550">приложение предназначено для пакета NuGet [Microsoft.AspNetCore.Server.IIS](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IIS) или [метапакета Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app);</span><span class="sxs-lookup"><span data-stu-id="28ee7-550">The app targets either the [Microsoft.AspNetCore.Server.IIS](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IIS) NuGet package or the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app).</span></span>
* <span data-ttu-id="28ee7-551">версия общей платформы ASP.NET Core, для которой предназначено приложение, установлена на целевом компьютере.</span><span class="sxs-lookup"><span data-stu-id="28ee7-551">The version of the ASP.NET Core shared framework that the app targets is installed on the target machine.</span></span>

### <a name="5000-out-of-process-handler-load-failure"></a><span data-ttu-id="28ee7-552">500.0 Out-Of-Process Handler Load Failure (ошибка загрузки внепроцессного обработчика)</span><span class="sxs-lookup"><span data-stu-id="28ee7-552">500.0 Out-Of-Process Handler Load Failure</span></span>

<span data-ttu-id="28ee7-553">Рабочий процесс завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="28ee7-553">The worker process fails.</span></span> <span data-ttu-id="28ee7-554">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-554">The app doesn't start.</span></span>

<span data-ttu-id="28ee7-555">[Модулю ASP.NET Core](xref:host-and-deploy/aspnet-core-module) не удается найти внепроцессный обработчик запросов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-555">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) fails to find the out-of-process hosting request handler.</span></span> <span data-ttu-id="28ee7-556">Убедитесь, что *aspnetcorev2_outofprocess.dll* находится во вложенной папке рядом с *aspnetcorev2.dll*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-556">Make sure the *aspnetcorev2_outofprocess.dll* is present in a subfolder next to *aspnetcorev2.dll*.</span></span>

### <a name="5025-process-failure"></a><span data-ttu-id="28ee7-557">502.5 Process Failure (ошибка процесса)</span><span class="sxs-lookup"><span data-stu-id="28ee7-557">502.5 Process Failure</span></span>

<span data-ttu-id="28ee7-558">Рабочий процесс завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="28ee7-558">The worker process fails.</span></span> <span data-ttu-id="28ee7-559">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-559">The app doesn't start.</span></span>

<span data-ttu-id="28ee7-560">[Модуль ASP.NET Core](xref:host-and-deploy/aspnet-core-module) пытается запустить рабочий процесс, но он не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-560">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) attempts to start the worker process but it fails to start.</span></span> <span data-ttu-id="28ee7-561">Обычно причину сбоя при запуске процесса можно определить по записям в журнале событий приложения и журнале вывода stdout модуля ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-561">The cause of a process startup failure can usually be determined from entries in the Application Event Log and the ASP.NET Core Module stdout log.</span></span>

<span data-ttu-id="28ee7-562">Распространенной причиной сбоя является неправильная настройка приложения с выбором отсутствующей версии общей платформы ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-562">A common failure condition is the app is misconfigured due to targeting a version of the ASP.NET Core shared framework that isn't present.</span></span> <span data-ttu-id="28ee7-563">Проверьте, какие версии общей платформы ASP.NET Core установлены на целевом компьютере.</span><span class="sxs-lookup"><span data-stu-id="28ee7-563">Check which versions of the ASP.NET Core shared framework are installed on the target machine.</span></span> <span data-ttu-id="28ee7-564">*Общая платформа* — это набор сборок (*DLLl*-файлы), которые установлены на компьютере и на которые ссылается метапакет, например `Microsoft.AspNetCore.App`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-564">The *shared framework* is the set of assemblies (*.dll* files) that are installed on the machine and referenced by a metapackage such as `Microsoft.AspNetCore.App`.</span></span> <span data-ttu-id="28ee7-565">В ссылках метапакета может быть указана минимальная требуемая версия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-565">The metapackage reference can specify a minimum required version.</span></span> <span data-ttu-id="28ee7-566">Дополнительную информацию см. в этой публикации об [общей платформе](https://natemcmaster.com/blog/2018/08/29/netcore-primitives-2/).</span><span class="sxs-lookup"><span data-stu-id="28ee7-566">For more information, see [The shared framework](https://natemcmaster.com/blog/2018/08/29/netcore-primitives-2/).</span></span>

<span data-ttu-id="28ee7-567">Когда ошибки в конфигурации размещения или приложения приводят к сбою рабочего процесса, возвращается страница ошибки *502.5 — ошибка процесса*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-567">The *502.5 Process Failure* error page is returned when a hosting or app misconfiguration causes the worker process to fail:</span></span>

### <a name="failed-to-start-application-errorcode-0x800700c1"></a><span data-ttu-id="28ee7-568">Не удалось запустить приложение (код ошибки "0x800700c1")</span><span class="sxs-lookup"><span data-stu-id="28ee7-568">Failed to start application (ErrorCode '0x800700c1')</span></span>

```
EventID: 1010
Source: IIS AspNetCore Module V2
Failed to start application '/LM/W3SVC/6/ROOT/', ErrorCode '0x800700c1'.
```

<span data-ttu-id="28ee7-569">Не удалось запустить приложение, так как не удалось загрузить сборку приложения ( *.dll*).</span><span class="sxs-lookup"><span data-stu-id="28ee7-569">The app failed to start because the app's assembly (*.dll*) couldn't be loaded.</span></span>

<span data-ttu-id="28ee7-570">Эта ошибка возникает, если существует несоответствие разрядности опубликованного приложения и процесса w3wp/iisexpress.</span><span class="sxs-lookup"><span data-stu-id="28ee7-570">This error occurs when there's a bitness mismatch between the published app and the w3wp/iisexpress process.</span></span>

<span data-ttu-id="28ee7-571">Убедитесь, что параметр 32-разрядности пула приложений указан правильно:</span><span class="sxs-lookup"><span data-stu-id="28ee7-571">Confirm that the app pool's 32-bit setting is correct:</span></span>

1. <span data-ttu-id="28ee7-572">Выберите пул приложений в диспетчере служб IIS в разделе **Пулы приложений**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-572">Select the app pool in IIS Manager's **Application Pools**.</span></span>
1. <span data-ttu-id="28ee7-573">Выберите **Дополнительные параметры** в разделе **Изменение пула приложений** панели **Действия**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-573">Select **Advanced Settings** under **Edit Application Pool** in the **Actions** panel.</span></span>
1. <span data-ttu-id="28ee7-574">Установите параметр **Включить 32-разрядные приложения**:</span><span class="sxs-lookup"><span data-stu-id="28ee7-574">Set **Enable 32-Bit Applications**:</span></span>
   * <span data-ttu-id="28ee7-575">При развертывании 32-разрядного (x86) приложения задайте значение `True`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-575">If deploying a 32-bit (x86) app, set the value to `True`.</span></span>
   * <span data-ttu-id="28ee7-576">При развертывании 64-разрядного (x64) приложения задайте значение `False`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-576">If deploying a 64-bit (x64) app, set the value to `False`.</span></span>

<span data-ttu-id="28ee7-577">Убедитесь в отсутствии конфликта между свойством `<Platform>` MSBuild в файле проекта и опубликованной разрядностью приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-577">Confirm that there isn't a conflict between a `<Platform>` MSBuild property in the project file and the published bitness of the app.</span></span>

### <a name="connection-reset"></a><span data-ttu-id="28ee7-578">Сброс подключения</span><span class="sxs-lookup"><span data-stu-id="28ee7-578">Connection reset</span></span>

<span data-ttu-id="28ee7-579">Если ошибка возникает после отправки заголовков, сервер уже не может отправить страницу **500 — внутренняя ошибка сервера**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-579">If an error occurs after the headers are sent, it's too late for the server to send a **500 Internal Server Error** when an error occurs.</span></span> <span data-ttu-id="28ee7-580">Это часто происходит, когда ошибка возникает во время сериализации составных объектов ответа.</span><span class="sxs-lookup"><span data-stu-id="28ee7-580">This often happens when an error occurs during the serialization of complex objects for a response.</span></span> <span data-ttu-id="28ee7-581">Этот тип ошибки отображается на стороне клиента как ошибка *Сброс подключения*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-581">This type of error appears as a *connection reset* error on the client.</span></span> <span data-ttu-id="28ee7-582">[Ведение журналов для приложений](xref:fundamentals/logging/index) может помочь устранить эти ошибки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-582">[Application logging](xref:fundamentals/logging/index) can help troubleshoot these types of errors.</span></span>

### <a name="default-startup-limits"></a><span data-ttu-id="28ee7-583">Ограничения по умолчанию при запуске</span><span class="sxs-lookup"><span data-stu-id="28ee7-583">Default startup limits</span></span>

<span data-ttu-id="28ee7-584">Для параметра *startupTimeLimit* [модуля ASP.NET Core](xref:host-and-deploy/aspnet-core-module) установлено значение по умолчанию 120 секунд.</span><span class="sxs-lookup"><span data-stu-id="28ee7-584">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) is configured with a default *startupTimeLimit* of 120 seconds.</span></span> <span data-ttu-id="28ee7-585">Если оставить значение по умолчанию, то прежде чем журнал модуля зарегистрирует ошибку запуска приложения, может пройти до двух минут.</span><span class="sxs-lookup"><span data-stu-id="28ee7-585">When left at the default value, an app may take up to two minutes to start before the module logs a process failure.</span></span> <span data-ttu-id="28ee7-586">Сведения о настройке модуля см. в разделе [Атрибуты элемента aspNetCore](xref:host-and-deploy/aspnet-core-module#attributes-of-the-aspnetcore-element).</span><span class="sxs-lookup"><span data-stu-id="28ee7-586">For information on configuring the module, see [Attributes of the aspNetCore element](xref:host-and-deploy/aspnet-core-module#attributes-of-the-aspnetcore-element).</span></span>

## <a name="troubleshoot-on-azure-app-service"></a><span data-ttu-id="28ee7-587">Устранение неполадок в Службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-587">Troubleshoot on Azure App Service</span></span>

[!INCLUDE [Azure App Service Preview Notice](~/includes/azure-apps-preview-notice.md)]

### <a name="application-event-log-azure-app-service"></a><span data-ttu-id="28ee7-588">Журнал событий приложений (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-588">Application Event Log (Azure App Service)</span></span>

<span data-ttu-id="28ee7-589">Чтобы получить доступ к журналу событий приложения, используйте колонку **Диагностика и решение проблем** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-589">To access the Application Event Log, use the **Diagnose and solve problems** blade in the Azure portal:</span></span>

1. <span data-ttu-id="28ee7-590">На портале Azure откройте приложение в колонке **Службы приложений**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-590">In the Azure portal, open the app in **App Services**.</span></span>
1. <span data-ttu-id="28ee7-591">Выберите колонку **Диагностика и решение проблем**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-591">Select **Diagnose and solve problems**.</span></span>
1. <span data-ttu-id="28ee7-592">Щелкните заголовок **Средства диагностики**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-592">Select the **Diagnostic Tools** heading.</span></span>
1. <span data-ttu-id="28ee7-593">В разделе **Средства поддержки** нажмите кнопку **События приложений**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-593">Under **Support Tools**, select the **Application Events** button.</span></span>
1. <span data-ttu-id="28ee7-594">Изучите последние ошибки из журнала *IIS AspNetCoreModule* или *IIS AspNetCoreModule V2* в столбце **Источник**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-594">Examine the latest error provided by the *IIS AspNetCoreModule* or *IIS AspNetCoreModule V2* entry in the **Source** column.</span></span>

<span data-ttu-id="28ee7-595">Вместо использования колонки **Диагностика и решение проблем** можно изучить файл журнала событий приложения непосредственно с помощью консоли [Kudu](https://github.com/projectkudu/kudu/wiki).</span><span class="sxs-lookup"><span data-stu-id="28ee7-595">An alternative to using the **Diagnose and solve problems** blade is to examine the Application Event Log file directly using [Kudu](https://github.com/projectkudu/kudu/wiki):</span></span>

1. <span data-ttu-id="28ee7-596">В области **Средства разработки** откройте колонку **Дополнительные инструменты**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-596">Open **Advanced Tools** in the **Development Tools** area.</span></span> <span data-ttu-id="28ee7-597">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-597">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-598">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-598">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-599">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-599">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-600">Откройте папку **LogFiles**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-600">Open the **LogFiles** folder.</span></span>
1. <span data-ttu-id="28ee7-601">Выберите значок с карандашом рядом с файлом *eventlog.xml*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-601">Select the pencil icon next to the *eventlog.xml* file.</span></span>
1. <span data-ttu-id="28ee7-602">Изучите журнал.</span><span class="sxs-lookup"><span data-stu-id="28ee7-602">Examine the log.</span></span> <span data-ttu-id="28ee7-603">Прокрутите список до нижней части журнала, чтобы просмотреть последние события.</span><span class="sxs-lookup"><span data-stu-id="28ee7-603">Scroll to the bottom of the log to see the most recent events.</span></span>

### <a name="run-the-app-in-the-kudu-console"></a><span data-ttu-id="28ee7-604">Запуск приложения в консоли Kudu</span><span class="sxs-lookup"><span data-stu-id="28ee7-604">Run the app in the Kudu console</span></span>

<span data-ttu-id="28ee7-605">Многие ошибки запуска не создают полезные сведения в журнале событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-605">Many startup errors don't produce useful information in the Application Event Log.</span></span> <span data-ttu-id="28ee7-606">Чтобы обнаружить ошибку, можно запустить приложение в удаленной консоли выполнения [Kudu](https://github.com/projectkudu/kudu/wiki).</span><span class="sxs-lookup"><span data-stu-id="28ee7-606">You can run the app in the [Kudu](https://github.com/projectkudu/kudu/wiki) Remote Execution Console to discover the error:</span></span>

1. <span data-ttu-id="28ee7-607">В области **Средства разработки** откройте колонку **Дополнительные инструменты**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-607">Open **Advanced Tools** in the **Development Tools** area.</span></span> <span data-ttu-id="28ee7-608">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-608">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-609">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-609">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-610">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-610">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>

#### <a name="test-a-32-bit-x86-app"></a><span data-ttu-id="28ee7-611">Тестирование 32-разрядного (x86) приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-611">Test a 32-bit (x86) app</span></span>

<span data-ttu-id="28ee7-612">**Текущий выпуск**</span><span class="sxs-lookup"><span data-stu-id="28ee7-612">**Current release**</span></span>

1. `cd d:\home\site\wwwroot`
1. <span data-ttu-id="28ee7-613">Запустите приложение:</span><span class="sxs-lookup"><span data-stu-id="28ee7-613">Run the app:</span></span>
   * <span data-ttu-id="28ee7-614">Если развертываемое приложение [зависит от платформы](/dotnet/core/deploying/#framework-dependent-deployments-fdd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-614">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span></span>

     ```dotnetcli
     dotnet .\{ASSEMBLY NAME}.dll
     ```

   * <span data-ttu-id="28ee7-615">Если приложение [развертывается автономно](/dotnet/core/deploying/#self-contained-deployments-scd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-615">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd):</span></span>

     ```console
     {ASSEMBLY NAME}.exe
     ```

<span data-ttu-id="28ee7-616">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-616">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

<span data-ttu-id="28ee7-617">**Зависимое от платформы развертывание, выполняющееся в предварительном выпуске**</span><span class="sxs-lookup"><span data-stu-id="28ee7-617">**Framework-dependent deployment running on a preview release**</span></span>

<span data-ttu-id="28ee7-618">*Требует установки расширения сайта для среды выполнения ASP.NET Core {VERSION} (x86).*</span><span class="sxs-lookup"><span data-stu-id="28ee7-618">*Requires installing the ASP.NET Core {VERSION} (x86) Runtime site extension.*</span></span>

1. <span data-ttu-id="28ee7-619">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x32` (`{X.Y}` — это версия среды выполнения).</span><span class="sxs-lookup"><span data-stu-id="28ee7-619">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x32` (`{X.Y}` is the runtime version)</span></span>
1. <span data-ttu-id="28ee7-620">Запустите приложение: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-620">Run the app: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`</span></span>

<span data-ttu-id="28ee7-621">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-621">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

#### <a name="test-a-64-bit-x64-app"></a><span data-ttu-id="28ee7-622">Тестирование 64-разрядного (x64) приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-622">Test a 64-bit (x64) app</span></span>

<span data-ttu-id="28ee7-623">**Текущий выпуск**</span><span class="sxs-lookup"><span data-stu-id="28ee7-623">**Current release**</span></span>

* <span data-ttu-id="28ee7-624">Если приложение является 64-разрядным (x64) [зависимым от платформы развертыванием](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span><span class="sxs-lookup"><span data-stu-id="28ee7-624">If the app is a 64-bit (x64) [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span></span>
  1. `cd D:\Program Files\dotnet`
  1. <span data-ttu-id="28ee7-625">Запустите приложение: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-625">Run the app: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`</span></span>
* <span data-ttu-id="28ee7-626">Если приложение [развертывается автономно](/dotnet/core/deploying/#self-contained-deployments-scd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-626">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd):</span></span>
  1. `cd D:\home\site\wwwroot`
  1. <span data-ttu-id="28ee7-627">Запустите приложение: `{ASSEMBLY NAME}.exe`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-627">Run the app: `{ASSEMBLY NAME}.exe`</span></span>

<span data-ttu-id="28ee7-628">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-628">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

<span data-ttu-id="28ee7-629">**Зависимое от платформы развертывание, выполняющееся в предварительном выпуске**</span><span class="sxs-lookup"><span data-stu-id="28ee7-629">**Framework-dependent deployment running on a preview release**</span></span>

<span data-ttu-id="28ee7-630">*Требует установки расширения сайта для среды выполнения ASP.NET Core {VERSION} (x64).*</span><span class="sxs-lookup"><span data-stu-id="28ee7-630">*Requires installing the ASP.NET Core {VERSION} (x64) Runtime site extension.*</span></span>

1. <span data-ttu-id="28ee7-631">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x64` (`{X.Y}` — это версия среды выполнения).</span><span class="sxs-lookup"><span data-stu-id="28ee7-631">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x64` (`{X.Y}` is the runtime version)</span></span>
1. <span data-ttu-id="28ee7-632">Запустите приложение: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-632">Run the app: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`</span></span>

<span data-ttu-id="28ee7-633">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-633">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

### <a name="aspnet-core-module-stdout-log-azure-app-service"></a><span data-ttu-id="28ee7-634">Журнал вывода stdout модуля ASP.NET Core (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-634">ASP.NET Core Module stdout log (Azure App Service)</span></span>

<span data-ttu-id="28ee7-635">В журнале stdout модуля ASP.NET Core часто записываются полезные сообщения, которые не удается найти в журнале событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-635">The ASP.NET Core Module stdout log often records useful error messages not found in the Application Event Log.</span></span> <span data-ttu-id="28ee7-636">Чтобы включить и просмотреть журналы stdout выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-636">To enable and view stdout logs:</span></span>

1. <span data-ttu-id="28ee7-637">Перейдите к колонке **Диагностика и решение проблем** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-637">Navigate to the **Diagnose and solve problems** blade in the Azure portal.</span></span>
1. <span data-ttu-id="28ee7-638">В разделе **Выберите категорию проблемы** нажмите кнопку **Веб-приложение не работает**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-638">Under **SELECT PROBLEM CATEGORY**, select the **Web App Down** button.</span></span>
1. <span data-ttu-id="28ee7-639">В разделе **Предлагаемые решения** > **Включить перенаправление журнала stdout** нажмите кнопку **Открыть консоль Kudu для редактирования файла Web.Config**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-639">Under **Suggested Solutions** > **Enable Stdout Log Redirection**, select the button to **Open Kudu Console to edit Web.Config**.</span></span>
1. <span data-ttu-id="28ee7-640">В **консоли диагностики** Kudu откройте папки на пути **веб-сайт** > **wwwroot**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-640">In the Kudu **Diagnostic Console**, open the folders to the path **site** > **wwwroot**.</span></span> <span data-ttu-id="28ee7-641">Прокрутите список вниз, чтобы в его нижней части показался файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-641">Scroll down to reveal the *web.config* file at the bottom of the list.</span></span>
1. <span data-ttu-id="28ee7-642">Щелкните значок карандаша рядом с файлом *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-642">Click the pencil icon next to the *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-643">Установите для параметра **stdoutLogEnabled** значение `true` и измените путь **stdoutLogFile** на `\\?\%home%\LogFiles\stdout`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-643">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to: `\\?\%home%\LogFiles\stdout`.</span></span>
1. <span data-ttu-id="28ee7-644">Выберите **Сохранить** для сохранения обновленного файла *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-644">Select **Save** to save the updated *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-645">Сделайте запрос к приложению.</span><span class="sxs-lookup"><span data-stu-id="28ee7-645">Make a request to the app.</span></span>
1. <span data-ttu-id="28ee7-646">Вернитесь на портал Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-646">Return to the Azure portal.</span></span> <span data-ttu-id="28ee7-647">Выберите колонку **Дополнительные инструменты** в области **Средства разработки**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-647">Select the **Advanced Tools** blade in the **DEVELOPMENT TOOLS** area.</span></span> <span data-ttu-id="28ee7-648">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-648">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-649">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-649">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-650">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-650">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-651">Выберите папку **LogFiles**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-651">Select the **LogFiles** folder.</span></span>
1. <span data-ttu-id="28ee7-652">Изучите столбец **Изменено** и выберите значок карандаша, чтобы отредактировать журнал stdout для последней даты изменения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-652">Inspect the **Modified** column and select the pencil icon to edit the stdout log with the latest modification date.</span></span>
1. <span data-ttu-id="28ee7-653">При открытии файла журнала отображается сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-653">When the log file opens, the error is displayed.</span></span>

<span data-ttu-id="28ee7-654">Завершив устранение неполадок, отключите ведение журнала stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-654">Disable stdout logging when troubleshooting is complete:</span></span>

1. <span data-ttu-id="28ee7-655">В **консоли диагностики** Kudu вернитесь к пути **веб-сайт** > **wwwroot**, чтобы открыть файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-655">In the Kudu **Diagnostic Console**, return to the path **site** > **wwwroot** to reveal the *web.config* file.</span></span> <span data-ttu-id="28ee7-656">Выбрав значок карандаша, снова откройте файл **web.config**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-656">Open the **web.config** file again by selecting the pencil icon.</span></span>
1. <span data-ttu-id="28ee7-657">Задайте параметру **stdoutLogEnabled** значение `false`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-657">Set **stdoutLogEnabled** to `false`.</span></span>
1. <span data-ttu-id="28ee7-658">Нажмите кнопку **Сохранить** для сохранения файла.</span><span class="sxs-lookup"><span data-stu-id="28ee7-658">Select **Save** to save the file.</span></span>

<span data-ttu-id="28ee7-659">Для получения дополнительной информации см. <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-659">For more information, see <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-660">Ошибка при отключении журнала stdout может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-660">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-661">Ни размер файла журнала, ни количество создаваемых файлов журналов ничем не ограничены.</span><span class="sxs-lookup"><span data-stu-id="28ee7-661">There's no limit on log file size or the number of log files created.</span></span> <span data-ttu-id="28ee7-662">Для устранения неполадок при запуске приложения используйте только журнал stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-662">Only use stdout logging to troubleshoot app startup problems.</span></span>
>
> <span data-ttu-id="28ee7-663">После запуска в приложении ASP.NET Core для ведения общего журнала используйте библиотеку ведения журналов, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-663">For general logging in an ASP.NET Core app after startup, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-664">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-664">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

### <a name="aspnet-core-module-debug-log-azure-app-service"></a><span data-ttu-id="28ee7-665">Журнал отладки модуля ASP.NET Core (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-665">ASP.NET Core Module debug log (Azure App Service)</span></span>

<span data-ttu-id="28ee7-666">В журнал отладки модуля ASP.NET записываются дополнительные и более подробные сообщения, относящиеся к модулю ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-666">The ASP.NET Core Module debug log provides additional, deeper logging from the ASP.NET Core Module.</span></span> <span data-ttu-id="28ee7-667">Чтобы включить и просмотреть журналы stdout, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-667">To enable and view stdout logs:</span></span>

1. <span data-ttu-id="28ee7-668">Чтобы включить ведение расширенного журнала диагностики, выполните одно из следующих действий.</span><span class="sxs-lookup"><span data-stu-id="28ee7-668">To enable the enhanced diagnostic log, perform either of the following:</span></span>
   * <span data-ttu-id="28ee7-669">Следуйте инструкциям по настройке приложения для ведения расширенных журналов диагностики, приведенным в разделе [Расширенные журналы диагностики](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs).</span><span class="sxs-lookup"><span data-stu-id="28ee7-669">Follow the instructions in [Enhanced diagnostic logs](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs) to configure the app for an enhanced diagnostic logging.</span></span> <span data-ttu-id="28ee7-670">Повторно разверните приложение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-670">Redeploy the app.</span></span>
   * <span data-ttu-id="28ee7-671">С помощью консоли Kudu добавьте раздел `<handlerSettings>` в файл *web.config* приложения, как показано в разделе [Расширенные журналы диагностики](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs).</span><span class="sxs-lookup"><span data-stu-id="28ee7-671">Add the `<handlerSettings>` shown in [Enhanced diagnostic logs](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs) to the live app's *web.config* file using the Kudu console:</span></span>
     1. <span data-ttu-id="28ee7-672">В области **Средства разработки** откройте колонку **Дополнительные инструменты**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-672">Open **Advanced Tools** in the **Development Tools** area.</span></span> <span data-ttu-id="28ee7-673">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-673">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-674">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-674">The Kudu console opens in a new browser tab or window.</span></span>
     1. <span data-ttu-id="28ee7-675">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-675">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
     1. <span data-ttu-id="28ee7-676">Откройте папки на пути **веб-сайт** > **wwwroot**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-676">Open the folders to the path **site** > **wwwroot**.</span></span> <span data-ttu-id="28ee7-677">Нажмите кнопку с изображением карандаша и внесите изменения в файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-677">Edit the *web.config* file by selecting the pencil button.</span></span> <span data-ttu-id="28ee7-678">Добавьте раздел `<handlerSettings>`, как описано в разделе [Расширенные журналы диагностики](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs).</span><span class="sxs-lookup"><span data-stu-id="28ee7-678">Add the `<handlerSettings>` section as shown in [Enhanced diagnostic logs](xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs).</span></span> <span data-ttu-id="28ee7-679">Нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-679">Select the **Save** button.</span></span>
1. <span data-ttu-id="28ee7-680">В области **Средства разработки** откройте колонку **Дополнительные инструменты**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-680">Open **Advanced Tools** in the **Development Tools** area.</span></span> <span data-ttu-id="28ee7-681">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-681">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-682">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-682">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-683">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-683">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-684">Откройте папки на пути **веб-сайт** > **wwwroot**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-684">Open the folders to the path **site** > **wwwroot**.</span></span> <span data-ttu-id="28ee7-685">Если вы не указали путь к файлу *aspnetcore-debug.log*, файл появится в списке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-685">If you didn't supply a path for the *aspnetcore-debug.log* file, the file appears in the list.</span></span> <span data-ttu-id="28ee7-686">Если путь указан, перейдите к расположению файла журнала.</span><span class="sxs-lookup"><span data-stu-id="28ee7-686">If you supplied a path, navigate to the location of the log file.</span></span>
1. <span data-ttu-id="28ee7-687">Откройте файл журнала, нажав кнопку с изображением карандаша рядом с именем файла.</span><span class="sxs-lookup"><span data-stu-id="28ee7-687">Open the log file with the pencil button next to the file name.</span></span>

<span data-ttu-id="28ee7-688">Завершив устранение неполадок, отключите ведение журнала отладки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-688">Disable debug logging when troubleshooting is complete:</span></span>

<span data-ttu-id="28ee7-689">Чтобы отключить ведение расширенных журналов отладки, выполните одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="28ee7-689">To disable the enhanced debug log, perform either of the following:</span></span>

* <span data-ttu-id="28ee7-690">Удалите раздел `<handlerSettings>` из файла *web.config* локально и повторно разверните приложение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-690">Remove the `<handlerSettings>` from the *web.config* file locally and redeploy the app.</span></span>
* <span data-ttu-id="28ee7-691">С помощью консоли Kudu внесите изменения в файл *web.config* и удалите раздел `<handlerSettings>`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-691">Use the Kudu console to edit the *web.config* file and remove the `<handlerSettings>` section.</span></span> <span data-ttu-id="28ee7-692">Сохраните файл.</span><span class="sxs-lookup"><span data-stu-id="28ee7-692">Save the file.</span></span>

<span data-ttu-id="28ee7-693">Для получения дополнительной информации см. <xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-693">For more information, see <xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs>.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-694">Ошибка при отключении журнала отладки может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-694">Failure to disable the debug log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-695">Ограничения на размер файла журнала отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="28ee7-695">There's no limit on log file size.</span></span> <span data-ttu-id="28ee7-696">Для устранения неполадок при запуске приложения используйте только журнал отладки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-696">Only use debug logging to troubleshoot app startup problems.</span></span>
>
> <span data-ttu-id="28ee7-697">После запуска в приложении ASP.NET Core для ведения общего журнала используйте библиотеку ведения журналов, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-697">For general logging in an ASP.NET Core app after startup, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-698">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-698">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

### <a name="slow-or-hanging-app-azure-app-service"></a><span data-ttu-id="28ee7-699">Медленное или зависающее приложение (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-699">Slow or hanging app (Azure App Service)</span></span>

<span data-ttu-id="28ee7-700">Если приложение медленно реагирует на запрос или зависает при его обработке, см. следующие статьи:</span><span class="sxs-lookup"><span data-stu-id="28ee7-700">When an app responds slowly or hangs on a request, see the following articles:</span></span>

* [<span data-ttu-id="28ee7-701">Устранение проблем с производительностью медленных веб приложений в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-701">Troubleshoot slow web app performance issues in Azure App Service</span></span>](/azure/app-service/app-service-web-troubleshoot-performance-degradation)
* <span data-ttu-id="28ee7-702">[Use Crash Diagnoser Site Extension to Capture Dump for Intermittent Exception issues or performance issues on Azure Web App (Использование расширения сайта средства диагностики сбоев для записи дампа при периодических проблемах с исключением или проблемах с производительностью в веб-приложении Azure)](https://blogs.msdn.microsoft.com/asiatech/2015/12/28/use-crash-diagnoser-site-extension-to-capture-dump-for-intermittent-exception-issues-or-performance-issues-on-azure-web-app/).</span><span class="sxs-lookup"><span data-stu-id="28ee7-702">[Use Crash Diagnoser Site Extension to Capture Dump for Intermittent Exception issues or performance issues on Azure Web App](https://blogs.msdn.microsoft.com/asiatech/2015/12/28/use-crash-diagnoser-site-extension-to-capture-dump-for-intermittent-exception-issues-or-performance-issues-on-azure-web-app/)</span></span>

### <a name="monitoring-blades"></a><span data-ttu-id="28ee7-703">Мониторинг колонок</span><span class="sxs-lookup"><span data-stu-id="28ee7-703">Monitoring blades</span></span>

<span data-ttu-id="28ee7-704">Мониторинг колонок обеспечивает альтернативный поиск неисправностей методам, описанным ранее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="28ee7-704">Monitoring blades provide an alternative troubleshooting experience to the methods described earlier in the topic.</span></span> <span data-ttu-id="28ee7-705">Эти колонки можно использовать для диагностики ошибок 500-й серии.</span><span class="sxs-lookup"><span data-stu-id="28ee7-705">These blades can be used to diagnose 500-series errors.</span></span>

<span data-ttu-id="28ee7-706">Убедитесь, что установлены расширения ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-706">Confirm that the ASP.NET Core Extensions are installed.</span></span> <span data-ttu-id="28ee7-707">Если расширения не установлены, установите их вручную, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-707">If the extensions aren't installed, install them manually:</span></span>

1. <span data-ttu-id="28ee7-708">В колонке **Средства разработки** выберите колонку **Расширения**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-708">In the **DEVELOPMENT TOOLS** blade section, select the **Extensions** blade.</span></span>
1. <span data-ttu-id="28ee7-709">В списке должны появиться **Расширения ASP.NET Core**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-709">The **ASP.NET Core Extensions** should appear in the list.</span></span>
1. <span data-ttu-id="28ee7-710">Если расширения не установлены, нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-710">If the extensions aren't installed, select the **Add** button.</span></span>
1. <span data-ttu-id="28ee7-711">Выберите из списка **Расширения ASP.NET Core**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-711">Choose the **ASP.NET Core Extensions** from the list.</span></span>
1. <span data-ttu-id="28ee7-712">Для принятия условий нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-712">Select **OK** to accept the legal terms.</span></span>
1. <span data-ttu-id="28ee7-713">Нажмите кнопку **ОК** в колонке **Добавить расширение**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-713">Select **OK** on the **Add extension** blade.</span></span>
1. <span data-ttu-id="28ee7-714">Информационное всплывающее сообщение указывает, когда расширения успешно установятся.</span><span class="sxs-lookup"><span data-stu-id="28ee7-714">An informational pop-up message indicates when the extensions are successfully installed.</span></span>

<span data-ttu-id="28ee7-715">Если ведение журнала stdout не включено, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-715">If stdout logging isn't enabled, follow these steps:</span></span>

1. <span data-ttu-id="28ee7-716">На портале Azure выберите колонку **Дополнительные инструменты** в области **Средства разработки**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-716">In the Azure portal, select the **Advanced Tools** blade in the **DEVELOPMENT TOOLS** area.</span></span> <span data-ttu-id="28ee7-717">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-717">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-718">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-718">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-719">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-719">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-720">Откройте папки на пути **сайт** > **wwwroot** и прокрутите список вниз, пока в нижней части не появится файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-720">Open the folders to the path **site** > **wwwroot** and scroll down to reveal the *web.config* file at the bottom of the list.</span></span>
1. <span data-ttu-id="28ee7-721">Щелкните значок карандаша рядом с файлом *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-721">Click the pencil icon next to the *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-722">Установите для параметра **stdoutLogEnabled** значение `true` и измените путь **stdoutLogFile** на `\\?\%home%\LogFiles\stdout`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-722">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to: `\\?\%home%\LogFiles\stdout`.</span></span>
1. <span data-ttu-id="28ee7-723">Выберите **Сохранить** для сохранения обновленного файла *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-723">Select **Save** to save the updated *web.config* file.</span></span>

<span data-ttu-id="28ee7-724">Перейдите к активации ведения журнала диагностики, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-724">Proceed to activate diagnostic logging:</span></span>

1. <span data-ttu-id="28ee7-725">На портале Azure выберите колонку **Журналы диагностики**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-725">In the Azure portal, select the **Diagnostics logs** blade.</span></span>
1. <span data-ttu-id="28ee7-726">Выберите положение переключателя **Вкл.** для **Вход в приложения (файловая система)** и **Подробные сообщения об ошибках**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-726">Select the **On** switch for **Application Logging (Filesystem)** and **Detailed error messages**.</span></span> <span data-ttu-id="28ee7-727">В верхней части колонки нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-727">Select the **Save** button at the top of the blade.</span></span>
1. <span data-ttu-id="28ee7-728">Чтобы включить трассировку неудачно завершенных запросов, также известную как ведение журнала буферизации событий неудачных запросов (FREB), установите положение переключателя **Вкл.** для **Трассировки неудачно завершенных запросов**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-728">To include failed request tracing, also known as Failed Request Event Buffering (FREB) logging, select the **On** switch for **Failed request tracing**.</span></span>
1. <span data-ttu-id="28ee7-729">На портале выберите колонку **Поток журнала**, которая в списке отображается сразу под колонкой **Журналы диагностики**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-729">Select the **Log stream** blade, which is listed immediately under the **Diagnostics logs** blade in the portal.</span></span>
1. <span data-ttu-id="28ee7-730">Сделайте запрос к приложению.</span><span class="sxs-lookup"><span data-stu-id="28ee7-730">Make a request to the app.</span></span>
1. <span data-ttu-id="28ee7-731">В пределах данных потока журнала указывается причина ошибки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-731">Within the log stream data, the cause of the error is indicated.</span></span>

<span data-ttu-id="28ee7-732">После завершения устранения неполадок обязательно отключите ведение журнала stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-732">Be sure to disable stdout logging when troubleshooting is complete.</span></span>

<span data-ttu-id="28ee7-733">Чтобы просмотреть журналы трассировки неудачно завершенных запросов (журналы FREB), выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-733">To view the failed request tracing logs (FREB logs):</span></span>

1. <span data-ttu-id="28ee7-734">Перейдите к колонке **Диагностика и решение проблем** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-734">Navigate to the **Diagnose and solve problems** blade in the Azure portal.</span></span>
1. <span data-ttu-id="28ee7-735">Выберите **Журналы трассировки неудачно завершенных запросов** из области боковой панели **Средства поддержки**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-735">Select **Failed Request Tracing Logs** from the **SUPPORT TOOLS** area of the sidebar.</span></span>

<span data-ttu-id="28ee7-736">Для получения дополнительной информации см. [Раздел "Трассировка неудачно завершенных запросов" раздела "Включение ведения журналов диагностики для веб-приложений в службе приложений Azure"](/azure/app-service/web-sites-enable-diagnostic-log#failed-request-traces) и ["Вопросы и ответы о производительности приложений для веб-приложений в Azure: как включить трассировку неудачно завершенных запросов?"](/azure/app-service/app-service-web-availability-performance-application-issues-faq#how-do-i-turn-on-failed-request-tracing)</span><span class="sxs-lookup"><span data-stu-id="28ee7-736">See [Failed request traces section of the Enable diagnostics logging for web apps in Azure App Service topic](/azure/app-service/web-sites-enable-diagnostic-log#failed-request-traces) and the [Application performance FAQs for Web Apps in Azure: How do I turn on failed request tracing?](/azure/app-service/app-service-web-availability-performance-application-issues-faq#how-do-i-turn-on-failed-request-tracing) for more information.</span></span>

<span data-ttu-id="28ee7-737">Дополнительные сведения см. в разделе [Включение функции ведения журналов диагностики для веб-приложений в службе приложений Azure](/azure/app-service/web-sites-enable-diagnostic-log).</span><span class="sxs-lookup"><span data-stu-id="28ee7-737">For more information, see [Enable diagnostics logging for web apps in Azure App Service](/azure/app-service/web-sites-enable-diagnostic-log).</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-738">Ошибка при отключении журнала stdout может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-738">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-739">Ни размер файла журнала, ни количество создаваемых файлов журналов ничем не ограничены.</span><span class="sxs-lookup"><span data-stu-id="28ee7-739">There's no limit on log file size or the number of log files created.</span></span>
>
> <span data-ttu-id="28ee7-740">Для обычного ведения журналов для приложения ASP.NET Core используйте библиотеку, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-740">For routine logging in an ASP.NET Core app, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-741">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-741">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

## <a name="troubleshoot-on-iis"></a><span data-ttu-id="28ee7-742">Устранение неполадок в IIS</span><span class="sxs-lookup"><span data-stu-id="28ee7-742">Troubleshoot on IIS</span></span>

### <a name="application-event-log-iis"></a><span data-ttu-id="28ee7-743">Журнал событий приложений (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-743">Application Event Log (IIS)</span></span>

<span data-ttu-id="28ee7-744">Доступ к журналу событий приложений</span><span class="sxs-lookup"><span data-stu-id="28ee7-744">Access the Application Event Log:</span></span>

1. <span data-ttu-id="28ee7-745">Откройте меню "Пуск", выполните поиск по фразе *Просмотр событий* и выберите приложение **Просмотр событий**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-745">Open the Start menu, search for *Event Viewer*, and select the **Event Viewer** app.</span></span>
1. <span data-ttu-id="28ee7-746">В **средстве просмотра событий** откройте узел **Журналы Windows**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-746">In **Event Viewer**, open the **Windows Logs** node.</span></span>
1. <span data-ttu-id="28ee7-747">Выберите **Приложение**, чтобы открыть журнал событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-747">Select **Application** to open the Application Event Log.</span></span>
1. <span data-ttu-id="28ee7-748">Проверьте здесь наличие ошибок, связанных с проблемным приложением.</span><span class="sxs-lookup"><span data-stu-id="28ee7-748">Search for errors associated with the failing app.</span></span> <span data-ttu-id="28ee7-749">Нам нужны ошибки со значениями *Модуль IIS AspNetCore* или *Модуль IIS Express AspNetCore* в столбце *Источник*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-749">Errors have a value of *IIS AspNetCore Module* or *IIS Express AspNetCore Module* in the *Source* column.</span></span>

### <a name="run-the-app-at-a-command-prompt"></a><span data-ttu-id="28ee7-750">Запуск приложения в командной строке</span><span class="sxs-lookup"><span data-stu-id="28ee7-750">Run the app at a command prompt</span></span>

<span data-ttu-id="28ee7-751">Многие ошибки запуска не создают полезные сведения в журнале событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-751">Many startup errors don't produce useful information in the Application Event Log.</span></span> <span data-ttu-id="28ee7-752">Для некоторых ошибок можно найти причину, запустив приложение в командной строке на компьютере размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-752">You can find the cause of some errors by running the app at a command prompt on the hosting system.</span></span>

#### <a name="framework-dependent-deployment"></a><span data-ttu-id="28ee7-753">развертывание, зависящее от платформы;</span><span class="sxs-lookup"><span data-stu-id="28ee7-753">Framework-dependent deployment</span></span>

<span data-ttu-id="28ee7-754">Если развертываемое приложение [зависит от платформы](/dotnet/core/deploying/#framework-dependent-deployments-fdd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-754">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span></span>

1. <span data-ttu-id="28ee7-755">В командной строке перейдите в папку развертывания и запустите приложение, выполнив команду *dotnet.exe* для сборки приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-755">At a command prompt, navigate to the deployment folder and run the app by executing the app's assembly with *dotnet.exe*.</span></span> <span data-ttu-id="28ee7-756">В следующей команде укажите нужное имя сборки вместо заполнителя \<assembly_name>: `dotnet .\<assembly_name>.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-756">In the following command, substitute the name of the app's assembly for \<assembly_name>: `dotnet .\<assembly_name>.dll`.</span></span>
1. <span data-ttu-id="28ee7-757">Выходные данные приложения, в том числе любые ошибки, будут выведены в окно консоли.</span><span class="sxs-lookup"><span data-stu-id="28ee7-757">The console output from the app, showing any errors, is written to the console window.</span></span>
1. <span data-ttu-id="28ee7-758">Если ошибки возникают при выполнении запроса к приложению, выполните запрос к узлу и порту, где Kestrel ожидает передачи данных.</span><span class="sxs-lookup"><span data-stu-id="28ee7-758">If the errors occur when making a request to the app, make a request to the host and port where Kestrel listens.</span></span> <span data-ttu-id="28ee7-759">Создайте запрос к `http://localhost:5000/`, используя узел и порт по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="28ee7-759">Using the default host and post, make a request to `http://localhost:5000/`.</span></span> <span data-ttu-id="28ee7-760">Если приложение отвечает на запросы по адресу конечной точки Kestrel как обычно, то проблема, вероятнее, связана с конфигурацией размещения, а не с самим приложением.</span><span class="sxs-lookup"><span data-stu-id="28ee7-760">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the hosting configuration and less likely within the app.</span></span>

#### <a name="self-contained-deployment"></a><span data-ttu-id="28ee7-761">автономное развертывание;</span><span class="sxs-lookup"><span data-stu-id="28ee7-761">Self-contained deployment</span></span>

<span data-ttu-id="28ee7-762">Если приложение [развертывается автономно](/dotnet/core/deploying/#self-contained-deployments-scd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-762">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd):</span></span>

1. <span data-ttu-id="28ee7-763">В командной строке перейдите в папку развертывания и запустите исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-763">At a command prompt, navigate to the deployment folder and run the app's executable.</span></span> <span data-ttu-id="28ee7-764">В следующей команде укажите нужное имя сборки вместо заполнителя \<assembly_name>: `<assembly_name>.exe`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-764">In the following command, substitute the name of the app's assembly for \<assembly_name>: `<assembly_name>.exe`.</span></span>
1. <span data-ttu-id="28ee7-765">Выходные данные приложения, в том числе любые ошибки, будут выведены в окно консоли.</span><span class="sxs-lookup"><span data-stu-id="28ee7-765">The console output from the app, showing any errors, is written to the console window.</span></span>
1. <span data-ttu-id="28ee7-766">Если ошибки возникают при выполнении запроса к приложению, выполните запрос к узлу и порту, где Kestrel ожидает передачи данных.</span><span class="sxs-lookup"><span data-stu-id="28ee7-766">If the errors occur when making a request to the app, make a request to the host and port where Kestrel listens.</span></span> <span data-ttu-id="28ee7-767">Создайте запрос к `http://localhost:5000/`, используя узел и порт по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="28ee7-767">Using the default host and post, make a request to `http://localhost:5000/`.</span></span> <span data-ttu-id="28ee7-768">Если приложение отвечает на запросы по адресу конечной точки Kestrel как обычно, то проблема, вероятнее, связана с конфигурацией размещения, а не с самим приложением.</span><span class="sxs-lookup"><span data-stu-id="28ee7-768">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the hosting configuration and less likely within the app.</span></span>

### <a name="aspnet-core-module-stdout-log-iis"></a><span data-ttu-id="28ee7-769">Журнал вывода stdout модуля ASP.NET Core (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-769">ASP.NET Core Module stdout log (IIS)</span></span>

<span data-ttu-id="28ee7-770">Чтобы включить и просмотреть журналы stdout, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-770">To enable and view stdout logs:</span></span>

1. <span data-ttu-id="28ee7-771">Перейдите в папку развертывания сайта на компьютере размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-771">Navigate to the site's deployment folder on the hosting system.</span></span>
1. <span data-ttu-id="28ee7-772">Если здесь нет папки *logs*, создайте ее.</span><span class="sxs-lookup"><span data-stu-id="28ee7-772">If the *logs* folder isn't present, create the folder.</span></span> <span data-ttu-id="28ee7-773">Сведения о том, как настроить в MSBuild автоматическое создание папки *logs* в развертывании, см. в статье [о структуре каталогов](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="28ee7-773">For instructions on how to enable MSBuild to create the *logs* folder in the deployment automatically, see the [Directory structure](xref:host-and-deploy/directory-structure) topic.</span></span>
1. <span data-ttu-id="28ee7-774">Измените файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-774">Edit the *web.config* file.</span></span> <span data-ttu-id="28ee7-775">Задайте для параметра **stdoutLogEnabled** значение `true` и измените путь **stdoutLogFile** так, чтобы он указывал на папку *logs* (например, `.\logs\stdout`).</span><span class="sxs-lookup"><span data-stu-id="28ee7-775">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to point to the *logs* folder (for example, `.\logs\stdout`).</span></span> <span data-ttu-id="28ee7-776">В этом пути `stdout` обозначает префикс имени для файла журнала.</span><span class="sxs-lookup"><span data-stu-id="28ee7-776">`stdout` in the path is the log file name prefix.</span></span> <span data-ttu-id="28ee7-777">При создании файла журнала автоматически добавляются метка времени, идентификатор процесса и расширение файла.</span><span class="sxs-lookup"><span data-stu-id="28ee7-777">A timestamp, process id, and file extension are added automatically when the log is created.</span></span> <span data-ttu-id="28ee7-778">Если указан префикс файла `stdout`, стандартный файл журнала будет иметь примерно такое имя: *stdout_20180205184032_5412.log*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-778">Using `stdout` as the file name prefix, a typical log file is named *stdout_20180205184032_5412.log*.</span></span>
1. <span data-ttu-id="28ee7-779">Убедитесь, что удостоверение пула приложений имеет разрешения на запись в папку *logs*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-779">Ensure your application pool's identity has write permissions to the *logs* folder.</span></span>
1. <span data-ttu-id="28ee7-780">Сохраните обновленный файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-780">Save the updated *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-781">Сделайте запрос к приложению.</span><span class="sxs-lookup"><span data-stu-id="28ee7-781">Make a request to the app.</span></span>
1. <span data-ttu-id="28ee7-782">Перейдите в папку *logs*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-782">Navigate to the *logs* folder.</span></span> <span data-ttu-id="28ee7-783">Найдите и откройте последний журнал вывода stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-783">Find and open the most recent stdout log.</span></span>
1. <span data-ttu-id="28ee7-784">Проверьте, нет ли в нем ошибок.</span><span class="sxs-lookup"><span data-stu-id="28ee7-784">Study the log for errors.</span></span>

<span data-ttu-id="28ee7-785">Завершив устранение неполадок, отключите ведение журнала stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-785">Disable stdout logging when troubleshooting is complete:</span></span>

1. <span data-ttu-id="28ee7-786">Измените файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-786">Edit the *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-787">Задайте параметру **stdoutLogEnabled** значение `false`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-787">Set **stdoutLogEnabled** to `false`.</span></span>
1. <span data-ttu-id="28ee7-788">Сохраните файл.</span><span class="sxs-lookup"><span data-stu-id="28ee7-788">Save the file.</span></span>

<span data-ttu-id="28ee7-789">Для получения дополнительной информации см. <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-789">For more information, see <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-790">Ошибка при отключении журнала stdout может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-790">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-791">Ни размер файла журнала, ни количество создаваемых файлов журналов ничем не ограничены.</span><span class="sxs-lookup"><span data-stu-id="28ee7-791">There's no limit on log file size or the number of log files created.</span></span>
>
> <span data-ttu-id="28ee7-792">Для обычного ведения журналов для приложения ASP.NET Core используйте библиотеку, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-792">For routine logging in an ASP.NET Core app, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-793">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-793">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

### <a name="aspnet-core-module-debug-log-iis"></a><span data-ttu-id="28ee7-794">Журнал отладки модуля ASP.NET Core (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-794">ASP.NET Core Module debug log (IIS)</span></span>

<span data-ttu-id="28ee7-795">Добавьте следующие параметры обработчика в файл *web.config* приложения, чтобы включить журнал отладки модулей ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="28ee7-795">Add the following handler settings to the app's *web.config* file to enable ASP.NET Core Module debug log:</span></span>

```xml
<aspNetCore ...>
  <handlerSettings>
    <handlerSetting name="debugLevel" value="file" />
    <handlerSetting name="debugFile" value="c:\temp\ancm.log" />
  </handlerSettings>
</aspNetCore>
```

<span data-ttu-id="28ee7-796">Убедитесь, что указанный для журнала путь существует и удостоверение пула приложений имеет разрешения на запись в это расположение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-796">Confirm that the path specified for the log exists and that the app pool's identity has write permissions to the location.</span></span>

<span data-ttu-id="28ee7-797">Для получения дополнительной информации см. <xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-797">For more information, see <xref:host-and-deploy/aspnet-core-module#enhanced-diagnostic-logs>.</span></span>

### <a name="enable-the-developer-exception-page"></a><span data-ttu-id="28ee7-798">Включение страницы исключений для разработчика</span><span class="sxs-lookup"><span data-stu-id="28ee7-798">Enable the Developer Exception Page</span></span>

<span data-ttu-id="28ee7-799">Можно добавить переменную среды `ASPNETCORE_ENVIRONMENT` [в файл web.config](xref:host-and-deploy/aspnet-core-module#setting-environment-variables), чтобы запустить приложение в среде разработки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-799">The `ASPNETCORE_ENVIRONMENT` [environment variable can be added to web.config](xref:host-and-deploy/aspnet-core-module#setting-environment-variables) to run the app in the Development environment.</span></span> <span data-ttu-id="28ee7-800">Если среда не переопределяется при запуске приложения использованием `UseEnvironment` в конструкторе узла, эта переменная среды позволяет отображать [страницу исключения для разработчика](xref:fundamentals/error-handling) при запуске приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-800">As long as the environment isn't overridden in app startup by `UseEnvironment` on the host builder, setting the environment variable allows the [Developer Exception Page](xref:fundamentals/error-handling) to appear when the app is run.</span></span>

```xml
<aspNetCore processPath="dotnet"
      arguments=".\MyApp.dll"
      stdoutLogEnabled="false"
      stdoutLogFile=".\logs\stdout"
      hostingModel="InProcess">
  <environmentVariables>
    <environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Development" />
  </environmentVariables>
</aspNetCore>
```

<span data-ttu-id="28ee7-801">Настройка переменной среды `ASPNETCORE_ENVIRONMENT` рекомендуется только на промежуточных и тестовых серверах, доступ к которым из Интернета закрыт.</span><span class="sxs-lookup"><span data-stu-id="28ee7-801">Setting the environment variable for `ASPNETCORE_ENVIRONMENT` is only recommended for use on staging and testing servers that aren't exposed to the Internet.</span></span> <span data-ttu-id="28ee7-802">Завершив устранение неполадок, удалите эту переменную среды из файла *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-802">Remove the environment variable from the *web.config* file after troubleshooting.</span></span> <span data-ttu-id="28ee7-803">Сведения о настройке переменных среды в файле *web.config* см. в статье о [дочернем элементе environmentVariables в aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span><span class="sxs-lookup"><span data-stu-id="28ee7-803">For information on setting environment variables in *web.config*, see [environmentVariables child element of aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span></span>

### <a name="obtain-data-from-an-app"></a><span data-ttu-id="28ee7-804">Получение данных из приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-804">Obtain data from an app</span></span>

<span data-ttu-id="28ee7-805">Если приложение способно отвечать на запросы, получите данные о запросе, подключении и дополнительные данные из приложений с помощью встроенного терминала ПО промежуточного слоя.</span><span class="sxs-lookup"><span data-stu-id="28ee7-805">If an app is capable of responding to requests, obtain request, connection, and additional data from the app using terminal inline middleware.</span></span> <span data-ttu-id="28ee7-806">Дополнительные сведения и примеры с кодом см. здесь: <xref:test/troubleshoot#obtain-data-from-an-app>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-806">For more information and sample code, see <xref:test/troubleshoot#obtain-data-from-an-app>.</span></span>

### <a name="slow-or-hanging-app-iis"></a><span data-ttu-id="28ee7-807">Медленное или зависающее приложение (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-807">Slow or hanging app (IIS)</span></span>

<span data-ttu-id="28ee7-808">*Аварийный дамп* — это моментальный снимок системной памяти, который может помочь определить причину аварийного завершения, сбоя запуска или медленной работы приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-808">A *crash dump* is a snapshot of the system's memory and can help determine the cause of an app crash, startup failure, or slow app.</span></span>

#### <a name="app-crashes-or-encounters-an-exception"></a><span data-ttu-id="28ee7-809">Аварийное завершение работы приложения или исключение</span><span class="sxs-lookup"><span data-stu-id="28ee7-809">App crashes or encounters an exception</span></span>

<span data-ttu-id="28ee7-810">Получите и проанализируйте дамп из [отчетов об ошибках Windows (WER)](/windows/desktop/wer/windows-error-reporting):</span><span class="sxs-lookup"><span data-stu-id="28ee7-810">Obtain and analyze a dump from [Windows Error Reporting (WER)](/windows/desktop/wer/windows-error-reporting):</span></span>

1. <span data-ttu-id="28ee7-811">Создайте папку для хранения файлов аварийного дампа в `c:\dumps`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-811">Create a folder to hold crash dump files at `c:\dumps`.</span></span> <span data-ttu-id="28ee7-812">Пул приложений должен иметь доступ на запись к папке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-812">The app pool must have write access to the folder.</span></span>
1. <span data-ttu-id="28ee7-813">Запустите [скрипт PowerShell EnableDumps](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/EnableDumps.ps1):</span><span class="sxs-lookup"><span data-stu-id="28ee7-813">Run the [EnableDumps PowerShell script](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/EnableDumps.ps1):</span></span>
   * <span data-ttu-id="28ee7-814">Если приложение использует [модель размещения в процессе](xref:host-and-deploy/iis/index#in-process-hosting-model), выполните скрипт для *w3wp.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-814">If the app uses the [in-process hosting model](xref:host-and-deploy/iis/index#in-process-hosting-model), run the script for *w3wp.exe*:</span></span>

     ```console
     .\EnableDumps w3wp.exe c:\dumps
     ```

   * <span data-ttu-id="28ee7-815">Если приложение использует [модель размещения вне процесса](xref:host-and-deploy/iis/index#out-of-process-hosting-model), выполните скрипт для *dotnet.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-815">If the app uses the [out-of-process hosting model](xref:host-and-deploy/iis/index#out-of-process-hosting-model), run the script for *dotnet.exe*:</span></span>

     ```console
     .\EnableDumps dotnet.exe c:\dumps
     ```

1. <span data-ttu-id="28ee7-816">Запустите приложение в условиях, вызывающих аварийное завершение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-816">Run the app under the conditions that cause the crash to occur.</span></span>
1. <span data-ttu-id="28ee7-817">После аварийного завершения запустите [скрипт PowerShell DisableDumps](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/DisableDumps.ps1):</span><span class="sxs-lookup"><span data-stu-id="28ee7-817">After the crash has occurred, run the [DisableDumps PowerShell script](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/DisableDumps.ps1):</span></span>
   * <span data-ttu-id="28ee7-818">Если приложение использует [модель размещения в процессе](xref:host-and-deploy/iis/index#in-process-hosting-model), выполните скрипт для *w3wp.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-818">If the app uses the [in-process hosting model](xref:host-and-deploy/iis/index#in-process-hosting-model), run the script for *w3wp.exe*:</span></span>

     ```console
     .\DisableDumps w3wp.exe
     ```

   * <span data-ttu-id="28ee7-819">Если приложение использует [модель размещения вне процесса](xref:host-and-deploy/iis/index#out-of-process-hosting-model), выполните скрипт для *dotnet.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-819">If the app uses the [out-of-process hosting model](xref:host-and-deploy/iis/index#out-of-process-hosting-model), run the script for *dotnet.exe*:</span></span>

     ```console
     .\DisableDumps dotnet.exe
     ```

<span data-ttu-id="28ee7-820">Когда приложение аварийно завершит работу и сбор дампов будет выполнен, приложение сможет завершить работу обычным образом.</span><span class="sxs-lookup"><span data-stu-id="28ee7-820">After an app crashes and dump collection is complete, the app is allowed to terminate normally.</span></span> <span data-ttu-id="28ee7-821">Скрипт PowerShell настраивает отчеты об ошибках Windows для сбора до пяти дампов для приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-821">The PowerShell script configures WER to collect up to five dumps per app.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-822">Аварийные дампы могут занимать много места на диске (до нескольких гигабайтов каждый).</span><span class="sxs-lookup"><span data-stu-id="28ee7-822">Crash dumps might take up a large amount of disk space (up to several gigabytes each).</span></span>

#### <a name="app-hangs-fails-during-startup-or-runs-normally"></a><span data-ttu-id="28ee7-823">Приложение перестает отвечать на запросы, не запускается или работает в обычном режиме</span><span class="sxs-lookup"><span data-stu-id="28ee7-823">App hangs, fails during startup, or runs normally</span></span>

<span data-ttu-id="28ee7-824">Когда приложение *перестает отвечать на запросы* (но аварийное завершение не происходит), не запускается или работает в обычном режиме, см. раздел [Файлы дампа пользовательского режима: выбор лучшего инструмента](/windows-hardware/drivers/debugger/user-mode-dump-files#choosing-the-best-tool), чтобы выбрать подходящий инструмент для создания дампа.</span><span class="sxs-lookup"><span data-stu-id="28ee7-824">When an app *hangs* (stops responding but doesn't crash), fails during startup, or runs normally, see [User-Mode Dump Files: Choosing the Best Tool](/windows-hardware/drivers/debugger/user-mode-dump-files#choosing-the-best-tool) to select an appropriate tool to produce the dump.</span></span>

#### <a name="analyze-the-dump"></a><span data-ttu-id="28ee7-825">Анализ дампа</span><span class="sxs-lookup"><span data-stu-id="28ee7-825">Analyze the dump</span></span>

<span data-ttu-id="28ee7-826">Дамп можно проанализировать несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="28ee7-826">A dump can be analyzed using several approaches.</span></span> <span data-ttu-id="28ee7-827">Дополнительные сведения см. в разделе [Анализ файла дампа пользовательского режима](/windows-hardware/drivers/debugger/analyzing-a-user-mode-dump-file).</span><span class="sxs-lookup"><span data-stu-id="28ee7-827">For more information, see [Analyzing a User-Mode Dump File](/windows-hardware/drivers/debugger/analyzing-a-user-mode-dump-file).</span></span>

## <a name="clear-package-caches"></a><span data-ttu-id="28ee7-828">Очистка кэшей пакетов</span><span class="sxs-lookup"><span data-stu-id="28ee7-828">Clear package caches</span></span>

<span data-ttu-id="28ee7-829">Приложения-функции могут перестать работать сразу после обновления пакета SDK для .NET Core на компьютере разработки или обновления версии пакетов в самом приложении.</span><span class="sxs-lookup"><span data-stu-id="28ee7-829">A functioning app may fail immediately after upgrading either the .NET Core SDK on the development machine or changing package versions within the app.</span></span> <span data-ttu-id="28ee7-830">В некоторых случаях в результате важного обновления несогласованные версии пакетов могут привести к нарушению работы приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-830">In some cases, incoherent packages may break an app when performing major upgrades.</span></span> <span data-ttu-id="28ee7-831">Большинство этих проблем можно исправить следующим образом:</span><span class="sxs-lookup"><span data-stu-id="28ee7-831">Most of these issues can be fixed by following these instructions:</span></span>

1. <span data-ttu-id="28ee7-832">Удалите папки *bin* и *obj*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-832">Delete the *bin* and *obj* folders.</span></span>
1. <span data-ttu-id="28ee7-833">Очистите кэши пакетов, выполнив команду [dotnet nuget locals all --clear](/dotnet/core/tools/dotnet-nuget-locals) из командной оболочки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-833">Clear the package caches by executing [dotnet nuget locals all --clear](/dotnet/core/tools/dotnet-nuget-locals) from a command shell.</span></span>

   <span data-ttu-id="28ee7-834">Очистку кэшей пакетов также можно выполнить с помощью средства [nuget.exe](https://www.nuget.org/downloads) или команды `nuget locals all -clear`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-834">Clearing package caches can also be accomplished with the [nuget.exe](https://www.nuget.org/downloads) tool and executing the command `nuget locals all -clear`.</span></span> <span data-ttu-id="28ee7-835">*NuGet.exe* не входит в пакет установки операционной системы Windows для настольных компьютеров и его нужно получить отдельно на [веб-сайте NuGet](https://www.nuget.org/downloads).</span><span class="sxs-lookup"><span data-stu-id="28ee7-835">*nuget.exe* isn't a bundled install with the Windows desktop operating system and must be obtained separately from the [NuGet website](https://www.nuget.org/downloads).</span></span>

1. <span data-ttu-id="28ee7-836">Восстановите и перестройте проект.</span><span class="sxs-lookup"><span data-stu-id="28ee7-836">Restore and rebuild the project.</span></span>
1. <span data-ttu-id="28ee7-837">Удалите все файлы из папки развертывания на сервере, прежде чем повторно развернуть приложение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-837">Delete all of the files in the deployment folder on the server prior to redeploying the app.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="28ee7-838">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="28ee7-838">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:host-and-deploy/azure-iis-errors-reference>
* <xref:fundamentals/error-handling>
* <xref:host-and-deploy/aspnet-core-module>

### <a name="azure-documentation"></a><span data-ttu-id="28ee7-839">Документация по Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-839">Azure documentation</span></span>

* [<span data-ttu-id="28ee7-840">Application Insights для ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="28ee7-840">Application Insights for ASP.NET Core</span></span>](/azure/application-insights/app-insights-asp-net-core)
* [<span data-ttu-id="28ee7-841">Раздел "Веб-приложения удаленной отладки" статьи "Устранение неполадок веб-приложения в Службе приложений Azure с помощью Visual Studio"</span><span class="sxs-lookup"><span data-stu-id="28ee7-841">Remote debugging web apps section of Troubleshoot a web app in Azure App Service using Visual Studio</span></span>](/azure/app-service/web-sites-dotnet-troubleshoot-visual-studio#remotedebug)
* [<span data-ttu-id="28ee7-842">Общие сведения о диагностике в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-842">Azure App Service diagnostics overview</span></span>](/azure/app-service/app-service-diagnostics)
* [<span data-ttu-id="28ee7-843">Практическое руководство. Мониторинг приложений в Службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-843">How to: Monitor Apps in Azure App Service</span></span>](/azure/app-service/web-sites-monitor)
* [<span data-ttu-id="28ee7-844">Устранение неполадок веб-приложения в службе приложений Azure с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="28ee7-844">Troubleshoot a web app in Azure App Service using Visual Studio</span></span>](/azure/app-service/web-sites-dotnet-troubleshoot-visual-studio)
* [<span data-ttu-id="28ee7-845">Устранение ошибок HTTP "502 — недопустимый шлюз" и "503 — служба недоступна" в веб-приложениях Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-845">Troubleshoot HTTP errors of "502 bad gateway" and "503 service unavailable" in your Azure web apps</span></span>](/azure/app-service/app-service-web-troubleshoot-http-502-http-503)
* [<span data-ttu-id="28ee7-846">Устранение проблем с производительностью медленных веб приложений в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-846">Troubleshoot slow web app performance issues in Azure App Service</span></span>](/azure/app-service/app-service-web-troubleshoot-performance-degradation)
* [<span data-ttu-id="28ee7-847">Вопросы и ответы о производительности приложений для веб-приложений в Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-847">Application performance FAQs for Web Apps in Azure</span></span>](/azure/app-service/app-service-web-availability-performance-application-issues-faq)
* [<span data-ttu-id="28ee7-848">"Песочница" веб-приложений Azure (ограничения работы среды выполнения службы приложений)</span><span class="sxs-lookup"><span data-stu-id="28ee7-848">Azure Web App sandbox (App Service runtime execution limitations)</span></span>](https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox)
* [<span data-ttu-id="28ee7-849">Пятница с Azure. Практика диагностики и устранения неполадок в Службе приложений Azure (12-минутное видео)</span><span class="sxs-lookup"><span data-stu-id="28ee7-849">Azure Friday: Azure App Service Diagnostic and Troubleshooting Experience (12-minute video)</span></span>](https://channel9.msdn.com/Shows/Azure-Friday/Azure-App-Service-Diagnostic-and-Troubleshooting-Experience)

### <a name="visual-studio-documentation"></a><span data-ttu-id="28ee7-850">Документация по Visual Studio</span><span class="sxs-lookup"><span data-stu-id="28ee7-850">Visual Studio documentation</span></span>

* [<span data-ttu-id="28ee7-851">Удаленная отладка ASP.NET Core в IIS в Azure в Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="28ee7-851">Remote Debug ASP.NET Core on IIS in Azure in Visual Studio 2017</span></span>](/visualstudio/debugger/remote-debugging-azure)
* [<span data-ttu-id="28ee7-852">Удаленная отладка ASP.NET Core на удаленном компьютере IIS в Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="28ee7-852">Remote Debug ASP.NET Core on a Remote IIS Computer in Visual Studio 2017</span></span>](/visualstudio/debugger/remote-debugging-aspnet-on-a-remote-iis-computer)
* [<span data-ttu-id="28ee7-853">Сведения об отладке с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="28ee7-853">Learn to debug using Visual Studio</span></span>](/visualstudio/debugger/getting-started-with-the-debugger)

### <a name="visual-studio-code-documentation"></a><span data-ttu-id="28ee7-854">Документация по Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="28ee7-854">Visual Studio Code documentation</span></span>

* [<span data-ttu-id="28ee7-855">Отладка с помощью Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="28ee7-855">Debugging with Visual Studio Code</span></span>](https://code.visualstudio.com/docs/editor/debugging)

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="28ee7-856">В этой статье содержатся сведения об общих ошибках запуска приложений и инструкции по диагностике ошибок при развертывании приложения в Службе приложений Azure или службах IIS:</span><span class="sxs-lookup"><span data-stu-id="28ee7-856">This article provides information on common app startup errors and instructions on how to diagnose errors when an app is deployed to Azure App Service or IIS:</span></span>

[<span data-ttu-id="28ee7-857">Ошибки при запуске приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-857">App startup errors</span></span>](#app-startup-errors)  
<span data-ttu-id="28ee7-858">Описание распространенных сценариев кода состояния HTTP для запуска.</span><span class="sxs-lookup"><span data-stu-id="28ee7-858">Explains common startup HTTP status code scenarios.</span></span>

[<span data-ttu-id="28ee7-859">Устранение неполадок в Службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-859">Troubleshoot on Azure App Service</span></span>](#troubleshoot-on-azure-app-service)  
<span data-ttu-id="28ee7-860">Рекомендации по устранению неполадок для приложений, развернутых в Службе приложений Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-860">Provides troubleshooting advice for apps deployed to Azure App Service.</span></span>

[<span data-ttu-id="28ee7-861">Устранение неполадок в IIS</span><span class="sxs-lookup"><span data-stu-id="28ee7-861">Troubleshoot on IIS</span></span>](#troubleshoot-on-iis)  
<span data-ttu-id="28ee7-862">Рекомендации по устранению неполадок для приложений, развернутых в службах IIS или запущенных на IIS Express локально.</span><span class="sxs-lookup"><span data-stu-id="28ee7-862">Provides troubleshooting advice for apps deployed to IIS or running on IIS Express locally.</span></span> <span data-ttu-id="28ee7-863">Руководство относится к развертываниям Windows Server и Windows Desktop.</span><span class="sxs-lookup"><span data-stu-id="28ee7-863">The guidance applies to both Windows Server and Windows desktop deployments.</span></span>

[<span data-ttu-id="28ee7-864">Очистка кэшей пакетов</span><span class="sxs-lookup"><span data-stu-id="28ee7-864">Clear package caches</span></span>](#clear-package-caches)  
<span data-ttu-id="28ee7-865">Рекомендации о том, что делать, когда несогласованные пакеты нарушают работу приложения при установке основных обновлений или изменении версий пакета.</span><span class="sxs-lookup"><span data-stu-id="28ee7-865">Explains what to do when incoherent packages break an app when performing major upgrades or changing package versions.</span></span>

[<span data-ttu-id="28ee7-866">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="28ee7-866">Additional resources</span></span>](#additional-resources)  
<span data-ttu-id="28ee7-867">Дополнительные статьи по устранению неполадок.</span><span class="sxs-lookup"><span data-stu-id="28ee7-867">Lists additional troubleshooting topics.</span></span>

## <a name="app-startup-errors"></a><span data-ttu-id="28ee7-868">Ошибки при запуске приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-868">App startup errors</span></span>

<span data-ttu-id="28ee7-869">В Visual Studio проект ASP.NET Core по умолчанию использует размещение в [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview) на период отладки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-869">In Visual Studio, an ASP.NET Core project defaults to [IIS Express](/iis/extensions/introduction-to-iis-express/iis-express-overview) hosting during debugging.</span></span> <span data-ttu-id="28ee7-870">Рекомендации в этой статье позволяют диагностировать неполадки, проявляющиеся как *сбой процесса 502.5* при локальной отладке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-870">A *502.5 Process Failure* that occurs when debugging locally can be diagnosed using the advice in this topic.</span></span>

### <a name="40314-forbidden"></a><span data-ttu-id="28ee7-871">403.14 (Запрещено)</span><span class="sxs-lookup"><span data-stu-id="28ee7-871">403.14 Forbidden</span></span>

<span data-ttu-id="28ee7-872">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-872">The app fails to start.</span></span> <span data-ttu-id="28ee7-873">В журнал записывается следующая ошибка:</span><span class="sxs-lookup"><span data-stu-id="28ee7-873">The following error is logged:</span></span>

```
The Web server is configured to not list the contents of this directory.
```

<span data-ttu-id="28ee7-874">Эта ошибка обычно вызвана неработающим развертыванием в системе размещения в следующих сценариях:</span><span class="sxs-lookup"><span data-stu-id="28ee7-874">The error is usually caused by a broken deployment on the hosting system, which includes any of the following scenarios:</span></span>

* <span data-ttu-id="28ee7-875">Приложение развертывается в неверной папке в системе размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-875">The app is deployed to the wrong folder on the hosting system.</span></span>
* <span data-ttu-id="28ee7-876">Процессу развертывания не удалось переместить все файлы и папки приложения в папку развертывания в системе размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-876">The deployment process failed to move all of the app's files and folders to the deployment folder on the hosting system.</span></span>
* <span data-ttu-id="28ee7-877">Файл *web.config* отсутствует в развертывании, или содержимое файла *web.config* имеет неправильную структуру.</span><span class="sxs-lookup"><span data-stu-id="28ee7-877">The *web.config* file is missing from the deployment, or the *web.config* file contents are malformed.</span></span>

<span data-ttu-id="28ee7-878">Выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="28ee7-878">Perform the following steps:</span></span>

1. <span data-ttu-id="28ee7-879">Удалите все файлы и папки из папки развертывания в системе размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-879">Delete all of the files and folders from the deployment folder on the hosting system.</span></span>
1. <span data-ttu-id="28ee7-880">Повторно разверните содержимое папки *publish* приложения в системе размещения с помощью обычного метода развертывания, например Visual Studio, PowerShell или развертывание вручную:</span><span class="sxs-lookup"><span data-stu-id="28ee7-880">Redeploy the contents of the app's *publish* folder to the hosting system using your normal method of deployment, such as Visual Studio, PowerShell, or manual deployment:</span></span>
   * <span data-ttu-id="28ee7-881">Убедитесь, что файл *web.config* находится в развертывании и имеет правильное содержимое.</span><span class="sxs-lookup"><span data-stu-id="28ee7-881">Confirm that the *web.config* file is present in the deployment and that its contents are correct.</span></span>
   * <span data-ttu-id="28ee7-882">При размещении в Службе приложений Azure убедитесь, что приложение развернуто в папке `D:\home\site\wwwroot`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-882">When hosting on Azure App Service, confirm that the app is deployed to the `D:\home\site\wwwroot` folder.</span></span>
   * <span data-ttu-id="28ee7-883">Если приложение размещено в IIS, убедитесь, что оно развернуто по **физическому пути** служб IIS, указанному в **базовых параметрах** в **диспетчере IIS**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-883">When the app is hosted by IIS, confirm that the app is deployed to the IIS **Physical path** shown in **IIS Manager**'s **Basic Settings**.</span></span>
1. <span data-ttu-id="28ee7-884">Убедитесь, что все файлы и папки приложения развернуты путем сравнения развертывания в системе размещения с содержимым папки проекта *publish*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-884">Confirm that all of the app's files and folders are deployed by comparing the deployment on the hosting system to the contents of the project's *publish* folder.</span></span>

<span data-ttu-id="28ee7-885">Дополнительные сведения о макете опубликованного приложения ASP.NET Core см. в разделе <xref:host-and-deploy/directory-structure>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-885">For more information on the layout of a published ASP.NET Core app, see <xref:host-and-deploy/directory-structure>.</span></span> <span data-ttu-id="28ee7-886">Дополнительные сведения о файле *web.config* см. в разделе <xref:host-and-deploy/aspnet-core-module#configuration-with-webconfig>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-886">For more information on the *web.config* file, see <xref:host-and-deploy/aspnet-core-module#configuration-with-webconfig>.</span></span>

### <a name="500-internal-server-error"></a><span data-ttu-id="28ee7-887">500 Internal Server Error (внутренняя ошибка сервера)</span><span class="sxs-lookup"><span data-stu-id="28ee7-887">500 Internal Server Error</span></span>

<span data-ttu-id="28ee7-888">Приложение запускается, но ошибка не позволяет серверу выполнить запрос.</span><span class="sxs-lookup"><span data-stu-id="28ee7-888">The app starts, but an error prevents the server from fulfilling the request.</span></span>

<span data-ttu-id="28ee7-889">Эта ошибка возникает в коде приложения при запуске или при создании ответа.</span><span class="sxs-lookup"><span data-stu-id="28ee7-889">This error occurs within the app's code during startup or while creating a response.</span></span> <span data-ttu-id="28ee7-890">Ответ может не иметь содержимого или ответ в браузере может выглядеть как *500 — внутренняя ошибка сервера*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-890">The response may contain no content, or the response may appear as a *500 Internal Server Error* in the browser.</span></span> <span data-ttu-id="28ee7-891">Как правило, в журнале событий приложения указывается, что приложение запускается в обычном режиме.</span><span class="sxs-lookup"><span data-stu-id="28ee7-891">The Application Event Log usually states that the app started normally.</span></span> <span data-ttu-id="28ee7-892">Сервер действует правильно.</span><span class="sxs-lookup"><span data-stu-id="28ee7-892">From the server's perspective, that's correct.</span></span> <span data-ttu-id="28ee7-893">Приложение запустилось, но оно не может генерировать действительный ответ.</span><span class="sxs-lookup"><span data-stu-id="28ee7-893">The app did start, but it can't generate a valid response.</span></span> <span data-ttu-id="28ee7-894">Чтобы устранить проблему, запустите приложение в командной строке на сервере или включите журнал вывода stdout для модуля ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-894">Run the app at a command prompt on the server or enable the ASP.NET Core Module stdout log to troubleshoot the problem.</span></span>

### <a name="5025-process-failure"></a><span data-ttu-id="28ee7-895">502.5 Process Failure (ошибка процесса)</span><span class="sxs-lookup"><span data-stu-id="28ee7-895">502.5 Process Failure</span></span>

<span data-ttu-id="28ee7-896">Рабочий процесс завершается ошибкой.</span><span class="sxs-lookup"><span data-stu-id="28ee7-896">The worker process fails.</span></span> <span data-ttu-id="28ee7-897">Приложение не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-897">The app doesn't start.</span></span>

<span data-ttu-id="28ee7-898">[Модуль ASP.NET Core](xref:host-and-deploy/aspnet-core-module) пытается запустить рабочий процесс, но он не запускается.</span><span class="sxs-lookup"><span data-stu-id="28ee7-898">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) attempts to start the worker process but it fails to start.</span></span> <span data-ttu-id="28ee7-899">Обычно причину сбоя при запуске процесса можно определить по записям в журнале событий приложения и журнале вывода stdout модуля ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-899">The cause of a process startup failure can usually be determined from entries in the Application Event Log and the ASP.NET Core Module stdout log.</span></span>

<span data-ttu-id="28ee7-900">Распространенной причиной сбоя является неправильная настройка приложения с выбором отсутствующей версии общей платформы ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-900">A common failure condition is the app is misconfigured due to targeting a version of the ASP.NET Core shared framework that isn't present.</span></span> <span data-ttu-id="28ee7-901">Проверьте, какие версии общей платформы ASP.NET Core установлены на целевом компьютере.</span><span class="sxs-lookup"><span data-stu-id="28ee7-901">Check which versions of the ASP.NET Core shared framework are installed on the target machine.</span></span> <span data-ttu-id="28ee7-902">*Общая платформа* — это набор сборок (*DLLl*-файлы), которые установлены на компьютере и на которые ссылается метапакет, например `Microsoft.AspNetCore.App`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-902">The *shared framework* is the set of assemblies (*.dll* files) that are installed on the machine and referenced by a metapackage such as `Microsoft.AspNetCore.App`.</span></span> <span data-ttu-id="28ee7-903">В ссылках метапакета может быть указана минимальная требуемая версия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-903">The metapackage reference can specify a minimum required version.</span></span> <span data-ttu-id="28ee7-904">Дополнительную информацию см. в этой публикации об [общей платформе](https://natemcmaster.com/blog/2018/08/29/netcore-primitives-2/).</span><span class="sxs-lookup"><span data-stu-id="28ee7-904">For more information, see [The shared framework](https://natemcmaster.com/blog/2018/08/29/netcore-primitives-2/).</span></span>

<span data-ttu-id="28ee7-905">Когда ошибки в конфигурации размещения или приложения приводят к сбою рабочего процесса, возвращается страница ошибки *502.5 — ошибка процесса*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-905">The *502.5 Process Failure* error page is returned when a hosting or app misconfiguration causes the worker process to fail:</span></span>

### <a name="failed-to-start-application-errorcode-0x800700c1"></a><span data-ttu-id="28ee7-906">Не удалось запустить приложение (код ошибки "0x800700c1")</span><span class="sxs-lookup"><span data-stu-id="28ee7-906">Failed to start application (ErrorCode '0x800700c1')</span></span>

```
EventID: 1010
Source: IIS AspNetCore Module V2
Failed to start application '/LM/W3SVC/6/ROOT/', ErrorCode '0x800700c1'.
```

<span data-ttu-id="28ee7-907">Не удалось запустить приложение, так как не удалось загрузить сборку приложения ( *.dll*).</span><span class="sxs-lookup"><span data-stu-id="28ee7-907">The app failed to start because the app's assembly (*.dll*) couldn't be loaded.</span></span>

<span data-ttu-id="28ee7-908">Эта ошибка возникает, если существует несоответствие разрядности опубликованного приложения и процесса w3wp/iisexpress.</span><span class="sxs-lookup"><span data-stu-id="28ee7-908">This error occurs when there's a bitness mismatch between the published app and the w3wp/iisexpress process.</span></span>

<span data-ttu-id="28ee7-909">Убедитесь, что параметр 32-разрядности пула приложений указан правильно:</span><span class="sxs-lookup"><span data-stu-id="28ee7-909">Confirm that the app pool's 32-bit setting is correct:</span></span>

1. <span data-ttu-id="28ee7-910">Выберите пул приложений в диспетчере служб IIS в разделе **Пулы приложений**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-910">Select the app pool in IIS Manager's **Application Pools**.</span></span>
1. <span data-ttu-id="28ee7-911">Выберите **Дополнительные параметры** в разделе **Изменение пула приложений** панели **Действия**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-911">Select **Advanced Settings** under **Edit Application Pool** in the **Actions** panel.</span></span>
1. <span data-ttu-id="28ee7-912">Установите параметр **Включить 32-разрядные приложения**:</span><span class="sxs-lookup"><span data-stu-id="28ee7-912">Set **Enable 32-Bit Applications**:</span></span>
   * <span data-ttu-id="28ee7-913">При развертывании 32-разрядного (x86) приложения задайте значение `True`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-913">If deploying a 32-bit (x86) app, set the value to `True`.</span></span>
   * <span data-ttu-id="28ee7-914">При развертывании 64-разрядного (x64) приложения задайте значение `False`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-914">If deploying a 64-bit (x64) app, set the value to `False`.</span></span>

<span data-ttu-id="28ee7-915">Убедитесь в отсутствии конфликта между свойством `<Platform>` MSBuild в файле проекта и опубликованной разрядностью приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-915">Confirm that there isn't a conflict between a `<Platform>` MSBuild property in the project file and the published bitness of the app.</span></span>

### <a name="connection-reset"></a><span data-ttu-id="28ee7-916">Сброс подключения</span><span class="sxs-lookup"><span data-stu-id="28ee7-916">Connection reset</span></span>

<span data-ttu-id="28ee7-917">Если ошибка возникает после отправки заголовков, сервер уже не может отправить страницу **500 — внутренняя ошибка сервера**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-917">If an error occurs after the headers are sent, it's too late for the server to send a **500 Internal Server Error** when an error occurs.</span></span> <span data-ttu-id="28ee7-918">Это часто происходит, когда ошибка возникает во время сериализации составных объектов ответа.</span><span class="sxs-lookup"><span data-stu-id="28ee7-918">This often happens when an error occurs during the serialization of complex objects for a response.</span></span> <span data-ttu-id="28ee7-919">Этот тип ошибки отображается на стороне клиента как ошибка *Сброс подключения*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-919">This type of error appears as a *connection reset* error on the client.</span></span> <span data-ttu-id="28ee7-920">[Ведение журналов для приложений](xref:fundamentals/logging/index) может помочь устранить эти ошибки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-920">[Application logging](xref:fundamentals/logging/index) can help troubleshoot these types of errors.</span></span>

### <a name="default-startup-limits"></a><span data-ttu-id="28ee7-921">Ограничения по умолчанию при запуске</span><span class="sxs-lookup"><span data-stu-id="28ee7-921">Default startup limits</span></span>

<span data-ttu-id="28ee7-922">Для параметра *startupTimeLimit* [модуля ASP.NET Core](xref:host-and-deploy/aspnet-core-module) установлено значение по умолчанию 120 секунд.</span><span class="sxs-lookup"><span data-stu-id="28ee7-922">The [ASP.NET Core Module](xref:host-and-deploy/aspnet-core-module) is configured with a default *startupTimeLimit* of 120 seconds.</span></span> <span data-ttu-id="28ee7-923">Если оставить значение по умолчанию, то прежде чем журнал модуля зарегистрирует ошибку запуска приложения, может пройти до двух минут.</span><span class="sxs-lookup"><span data-stu-id="28ee7-923">When left at the default value, an app may take up to two minutes to start before the module logs a process failure.</span></span> <span data-ttu-id="28ee7-924">Сведения о настройке модуля см. в разделе [Атрибуты элемента aspNetCore](xref:host-and-deploy/aspnet-core-module#attributes-of-the-aspnetcore-element).</span><span class="sxs-lookup"><span data-stu-id="28ee7-924">For information on configuring the module, see [Attributes of the aspNetCore element](xref:host-and-deploy/aspnet-core-module#attributes-of-the-aspnetcore-element).</span></span>

## <a name="troubleshoot-on-azure-app-service"></a><span data-ttu-id="28ee7-925">Устранение неполадок в Службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-925">Troubleshoot on Azure App Service</span></span>

[!INCLUDE [Azure App Service Preview Notice](~/includes/azure-apps-preview-notice.md)]

### <a name="application-event-log-azure-app-service"></a><span data-ttu-id="28ee7-926">Журнал событий приложений (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-926">Application Event Log (Azure App Service)</span></span>

<span data-ttu-id="28ee7-927">Чтобы получить доступ к журналу событий приложения, используйте колонку **Диагностика и решение проблем** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-927">To access the Application Event Log, use the **Diagnose and solve problems** blade in the Azure portal:</span></span>

1. <span data-ttu-id="28ee7-928">На портале Azure откройте приложение в колонке **Службы приложений**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-928">In the Azure portal, open the app in **App Services**.</span></span>
1. <span data-ttu-id="28ee7-929">Выберите колонку **Диагностика и решение проблем**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-929">Select **Diagnose and solve problems**.</span></span>
1. <span data-ttu-id="28ee7-930">Щелкните заголовок **Средства диагностики**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-930">Select the **Diagnostic Tools** heading.</span></span>
1. <span data-ttu-id="28ee7-931">В разделе **Средства поддержки** нажмите кнопку **События приложений**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-931">Under **Support Tools**, select the **Application Events** button.</span></span>
1. <span data-ttu-id="28ee7-932">Изучите последние ошибки из журнала *IIS AspNetCoreModule* или *IIS AspNetCoreModule V2* в столбце **Источник**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-932">Examine the latest error provided by the *IIS AspNetCoreModule* or *IIS AspNetCoreModule V2* entry in the **Source** column.</span></span>

<span data-ttu-id="28ee7-933">Вместо использования колонки **Диагностика и решение проблем** можно изучить файл журнала событий приложения непосредственно с помощью консоли [Kudu](https://github.com/projectkudu/kudu/wiki).</span><span class="sxs-lookup"><span data-stu-id="28ee7-933">An alternative to using the **Diagnose and solve problems** blade is to examine the Application Event Log file directly using [Kudu](https://github.com/projectkudu/kudu/wiki):</span></span>

1. <span data-ttu-id="28ee7-934">В области **Средства разработки** откройте колонку **Дополнительные инструменты**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-934">Open **Advanced Tools** in the **Development Tools** area.</span></span> <span data-ttu-id="28ee7-935">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-935">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-936">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-936">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-937">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-937">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-938">Откройте папку **LogFiles**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-938">Open the **LogFiles** folder.</span></span>
1. <span data-ttu-id="28ee7-939">Выберите значок с карандашом рядом с файлом *eventlog.xml*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-939">Select the pencil icon next to the *eventlog.xml* file.</span></span>
1. <span data-ttu-id="28ee7-940">Изучите журнал.</span><span class="sxs-lookup"><span data-stu-id="28ee7-940">Examine the log.</span></span> <span data-ttu-id="28ee7-941">Прокрутите список до нижней части журнала, чтобы просмотреть последние события.</span><span class="sxs-lookup"><span data-stu-id="28ee7-941">Scroll to the bottom of the log to see the most recent events.</span></span>

### <a name="run-the-app-in-the-kudu-console"></a><span data-ttu-id="28ee7-942">Запуск приложения в консоли Kudu</span><span class="sxs-lookup"><span data-stu-id="28ee7-942">Run the app in the Kudu console</span></span>

<span data-ttu-id="28ee7-943">Многие ошибки запуска не создают полезные сведения в журнале событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-943">Many startup errors don't produce useful information in the Application Event Log.</span></span> <span data-ttu-id="28ee7-944">Чтобы обнаружить ошибку, можно запустить приложение в удаленной консоли выполнения [Kudu](https://github.com/projectkudu/kudu/wiki).</span><span class="sxs-lookup"><span data-stu-id="28ee7-944">You can run the app in the [Kudu](https://github.com/projectkudu/kudu/wiki) Remote Execution Console to discover the error:</span></span>

1. <span data-ttu-id="28ee7-945">В области **Средства разработки** откройте колонку **Дополнительные инструменты**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-945">Open **Advanced Tools** in the **Development Tools** area.</span></span> <span data-ttu-id="28ee7-946">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-946">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-947">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-947">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-948">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-948">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>

#### <a name="test-a-32-bit-x86-app"></a><span data-ttu-id="28ee7-949">Тестирование 32-разрядного (x86) приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-949">Test a 32-bit (x86) app</span></span>

<span data-ttu-id="28ee7-950">**Текущий выпуск**</span><span class="sxs-lookup"><span data-stu-id="28ee7-950">**Current release**</span></span>

1. `cd d:\home\site\wwwroot`
1. <span data-ttu-id="28ee7-951">Запустите приложение:</span><span class="sxs-lookup"><span data-stu-id="28ee7-951">Run the app:</span></span>
   * <span data-ttu-id="28ee7-952">Если развертываемое приложение [зависит от платформы](/dotnet/core/deploying/#framework-dependent-deployments-fdd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-952">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span></span>

     ```dotnetcli
     dotnet .\{ASSEMBLY NAME}.dll
     ```

   * <span data-ttu-id="28ee7-953">Если приложение [развертывается автономно](/dotnet/core/deploying/#self-contained-deployments-scd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-953">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd):</span></span>

     ```console
     {ASSEMBLY NAME}.exe
     ```

<span data-ttu-id="28ee7-954">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-954">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

<span data-ttu-id="28ee7-955">**Зависимое от платформы развертывание, выполняющееся в предварительном выпуске**</span><span class="sxs-lookup"><span data-stu-id="28ee7-955">**Framework-dependent deployment running on a preview release**</span></span>

<span data-ttu-id="28ee7-956">*Требует установки расширения сайта для среды выполнения ASP.NET Core {VERSION} (x86).*</span><span class="sxs-lookup"><span data-stu-id="28ee7-956">*Requires installing the ASP.NET Core {VERSION} (x86) Runtime site extension.*</span></span>

1. <span data-ttu-id="28ee7-957">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x32` (`{X.Y}` — это версия среды выполнения).</span><span class="sxs-lookup"><span data-stu-id="28ee7-957">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x32` (`{X.Y}` is the runtime version)</span></span>
1. <span data-ttu-id="28ee7-958">Запустите приложение: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-958">Run the app: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`</span></span>

<span data-ttu-id="28ee7-959">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-959">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

#### <a name="test-a-64-bit-x64-app"></a><span data-ttu-id="28ee7-960">Тестирование 64-разрядного (x64) приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-960">Test a 64-bit (x64) app</span></span>

<span data-ttu-id="28ee7-961">**Текущий выпуск**</span><span class="sxs-lookup"><span data-stu-id="28ee7-961">**Current release**</span></span>

* <span data-ttu-id="28ee7-962">Если приложение является 64-разрядным (x64) [зависимым от платформы развертыванием](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span><span class="sxs-lookup"><span data-stu-id="28ee7-962">If the app is a 64-bit (x64) [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span></span>
  1. `cd D:\Program Files\dotnet`
  1. <span data-ttu-id="28ee7-963">Запустите приложение: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-963">Run the app: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`</span></span>
* <span data-ttu-id="28ee7-964">Если приложение [развертывается автономно](/dotnet/core/deploying/#self-contained-deployments-scd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-964">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd):</span></span>
  1. `cd D:\home\site\wwwroot`
  1. <span data-ttu-id="28ee7-965">Запустите приложение: `{ASSEMBLY NAME}.exe`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-965">Run the app: `{ASSEMBLY NAME}.exe`</span></span>

<span data-ttu-id="28ee7-966">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-966">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

<span data-ttu-id="28ee7-967">**Зависимое от платформы развертывание, выполняющееся в предварительном выпуске**</span><span class="sxs-lookup"><span data-stu-id="28ee7-967">**Framework-dependent deployment running on a preview release**</span></span>

<span data-ttu-id="28ee7-968">*Требует установки расширения сайта для среды выполнения ASP.NET Core {VERSION} (x64).*</span><span class="sxs-lookup"><span data-stu-id="28ee7-968">*Requires installing the ASP.NET Core {VERSION} (x64) Runtime site extension.*</span></span>

1. <span data-ttu-id="28ee7-969">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x64` (`{X.Y}` — это версия среды выполнения).</span><span class="sxs-lookup"><span data-stu-id="28ee7-969">`cd D:\home\SiteExtensions\AspNetCoreRuntime.{X.Y}.x64` (`{X.Y}` is the runtime version)</span></span>
1. <span data-ttu-id="28ee7-970">Запустите приложение: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-970">Run the app: `dotnet \home\site\wwwroot\{ASSEMBLY NAME}.dll`</span></span>

<span data-ttu-id="28ee7-971">Выходные данные из приложения, отображающие любые ошибки, будут выведены на консоль Kudu.</span><span class="sxs-lookup"><span data-stu-id="28ee7-971">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

### <a name="aspnet-core-module-stdout-log-azure-app-service"></a><span data-ttu-id="28ee7-972">Журнал вывода stdout модуля ASP.NET Core (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-972">ASP.NET Core Module stdout log (Azure App Service)</span></span>

<span data-ttu-id="28ee7-973">В журнале stdout модуля ASP.NET Core часто записываются полезные сообщения, которые не удается найти в журнале событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-973">The ASP.NET Core Module stdout log often records useful error messages not found in the Application Event Log.</span></span> <span data-ttu-id="28ee7-974">Чтобы включить и просмотреть журналы stdout выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-974">To enable and view stdout logs:</span></span>

1. <span data-ttu-id="28ee7-975">Перейдите к колонке **Диагностика и решение проблем** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-975">Navigate to the **Diagnose and solve problems** blade in the Azure portal.</span></span>
1. <span data-ttu-id="28ee7-976">В разделе **Выберите категорию проблемы** нажмите кнопку **Веб-приложение не работает**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-976">Under **SELECT PROBLEM CATEGORY**, select the **Web App Down** button.</span></span>
1. <span data-ttu-id="28ee7-977">В разделе **Предлагаемые решения** > **Включить перенаправление журнала stdout** нажмите кнопку **Открыть консоль Kudu для редактирования файла Web.Config**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-977">Under **Suggested Solutions** > **Enable Stdout Log Redirection**, select the button to **Open Kudu Console to edit Web.Config**.</span></span>
1. <span data-ttu-id="28ee7-978">В **консоли диагностики** Kudu откройте папки на пути **веб-сайт** > **wwwroot**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-978">In the Kudu **Diagnostic Console**, open the folders to the path **site** > **wwwroot**.</span></span> <span data-ttu-id="28ee7-979">Прокрутите список вниз, чтобы в его нижней части показался файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-979">Scroll down to reveal the *web.config* file at the bottom of the list.</span></span>
1. <span data-ttu-id="28ee7-980">Щелкните значок карандаша рядом с файлом *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-980">Click the pencil icon next to the *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-981">Установите для параметра **stdoutLogEnabled** значение `true` и измените путь **stdoutLogFile** на `\\?\%home%\LogFiles\stdout`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-981">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to: `\\?\%home%\LogFiles\stdout`.</span></span>
1. <span data-ttu-id="28ee7-982">Выберите **Сохранить** для сохранения обновленного файла *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-982">Select **Save** to save the updated *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-983">Сделайте запрос к приложению.</span><span class="sxs-lookup"><span data-stu-id="28ee7-983">Make a request to the app.</span></span>
1. <span data-ttu-id="28ee7-984">Вернитесь на портал Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-984">Return to the Azure portal.</span></span> <span data-ttu-id="28ee7-985">Выберите колонку **Дополнительные инструменты** в области **Средства разработки**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-985">Select the **Advanced Tools** blade in the **DEVELOPMENT TOOLS** area.</span></span> <span data-ttu-id="28ee7-986">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-986">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-987">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-987">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-988">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-988">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-989">Выберите папку **LogFiles**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-989">Select the **LogFiles** folder.</span></span>
1. <span data-ttu-id="28ee7-990">Изучите столбец **Изменено** и выберите значок карандаша, чтобы отредактировать журнал stdout для последней даты изменения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-990">Inspect the **Modified** column and select the pencil icon to edit the stdout log with the latest modification date.</span></span>
1. <span data-ttu-id="28ee7-991">При открытии файла журнала отображается сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-991">When the log file opens, the error is displayed.</span></span>

<span data-ttu-id="28ee7-992">Завершив устранение неполадок, отключите ведение журнала stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-992">Disable stdout logging when troubleshooting is complete:</span></span>

1. <span data-ttu-id="28ee7-993">В **консоли диагностики** Kudu вернитесь к пути **веб-сайт** > **wwwroot**, чтобы открыть файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-993">In the Kudu **Diagnostic Console**, return to the path **site** > **wwwroot** to reveal the *web.config* file.</span></span> <span data-ttu-id="28ee7-994">Выбрав значок карандаша, снова откройте файл **web.config**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-994">Open the **web.config** file again by selecting the pencil icon.</span></span>
1. <span data-ttu-id="28ee7-995">Задайте параметру **stdoutLogEnabled** значение `false`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-995">Set **stdoutLogEnabled** to `false`.</span></span>
1. <span data-ttu-id="28ee7-996">Нажмите кнопку **Сохранить** для сохранения файла.</span><span class="sxs-lookup"><span data-stu-id="28ee7-996">Select **Save** to save the file.</span></span>

<span data-ttu-id="28ee7-997">Для получения дополнительной информации см. <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-997">For more information, see <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-998">Ошибка при отключении журнала stdout может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-998">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-999">Ни размер файла журнала, ни количество создаваемых файлов журналов ничем не ограничены.</span><span class="sxs-lookup"><span data-stu-id="28ee7-999">There's no limit on log file size or the number of log files created.</span></span> <span data-ttu-id="28ee7-1000">Для устранения неполадок при запуске приложения используйте только журнал stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1000">Only use stdout logging to troubleshoot app startup problems.</span></span>
>
> <span data-ttu-id="28ee7-1001">После запуска в приложении ASP.NET Core для ведения общего журнала используйте библиотеку ведения журналов, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1001">For general logging in an ASP.NET Core app after startup, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-1002">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1002">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

### <a name="slow-or-hanging-app-azure-app-service"></a><span data-ttu-id="28ee7-1003">Медленное или зависающее приложение (Служба приложений Azure)</span><span class="sxs-lookup"><span data-stu-id="28ee7-1003">Slow or hanging app (Azure App Service)</span></span>

<span data-ttu-id="28ee7-1004">Если приложение медленно реагирует на запрос или зависает при его обработке, см. следующие статьи:</span><span class="sxs-lookup"><span data-stu-id="28ee7-1004">When an app responds slowly or hangs on a request, see the following articles:</span></span>

* [<span data-ttu-id="28ee7-1005">Устранение проблем с производительностью медленных веб приложений в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-1005">Troubleshoot slow web app performance issues in Azure App Service</span></span>](/azure/app-service/app-service-web-troubleshoot-performance-degradation)
* <span data-ttu-id="28ee7-1006">[Use Crash Diagnoser Site Extension to Capture Dump for Intermittent Exception issues or performance issues on Azure Web App (Использование расширения сайта средства диагностики сбоев для записи дампа при периодических проблемах с исключением или проблемах с производительностью в веб-приложении Azure)](https://blogs.msdn.microsoft.com/asiatech/2015/12/28/use-crash-diagnoser-site-extension-to-capture-dump-for-intermittent-exception-issues-or-performance-issues-on-azure-web-app/).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1006">[Use Crash Diagnoser Site Extension to Capture Dump for Intermittent Exception issues or performance issues on Azure Web App](https://blogs.msdn.microsoft.com/asiatech/2015/12/28/use-crash-diagnoser-site-extension-to-capture-dump-for-intermittent-exception-issues-or-performance-issues-on-azure-web-app/)</span></span>

### <a name="monitoring-blades"></a><span data-ttu-id="28ee7-1007">Мониторинг колонок</span><span class="sxs-lookup"><span data-stu-id="28ee7-1007">Monitoring blades</span></span>

<span data-ttu-id="28ee7-1008">Мониторинг колонок обеспечивает альтернативный поиск неисправностей методам, описанным ранее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1008">Monitoring blades provide an alternative troubleshooting experience to the methods described earlier in the topic.</span></span> <span data-ttu-id="28ee7-1009">Эти колонки можно использовать для диагностики ошибок 500-й серии.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1009">These blades can be used to diagnose 500-series errors.</span></span>

<span data-ttu-id="28ee7-1010">Убедитесь, что установлены расширения ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1010">Confirm that the ASP.NET Core Extensions are installed.</span></span> <span data-ttu-id="28ee7-1011">Если расширения не установлены, установите их вручную, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1011">If the extensions aren't installed, install them manually:</span></span>

1. <span data-ttu-id="28ee7-1012">В колонке **Средства разработки** выберите колонку **Расширения**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1012">In the **DEVELOPMENT TOOLS** blade section, select the **Extensions** blade.</span></span>
1. <span data-ttu-id="28ee7-1013">В списке должны появиться **Расширения ASP.NET Core**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1013">The **ASP.NET Core Extensions** should appear in the list.</span></span>
1. <span data-ttu-id="28ee7-1014">Если расширения не установлены, нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1014">If the extensions aren't installed, select the **Add** button.</span></span>
1. <span data-ttu-id="28ee7-1015">Выберите из списка **Расширения ASP.NET Core**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1015">Choose the **ASP.NET Core Extensions** from the list.</span></span>
1. <span data-ttu-id="28ee7-1016">Для принятия условий нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1016">Select **OK** to accept the legal terms.</span></span>
1. <span data-ttu-id="28ee7-1017">Нажмите кнопку **ОК** в колонке **Добавить расширение**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1017">Select **OK** on the **Add extension** blade.</span></span>
1. <span data-ttu-id="28ee7-1018">Информационное всплывающее сообщение указывает, когда расширения успешно установятся.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1018">An informational pop-up message indicates when the extensions are successfully installed.</span></span>

<span data-ttu-id="28ee7-1019">Если ведение журнала stdout не включено, выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1019">If stdout logging isn't enabled, follow these steps:</span></span>

1. <span data-ttu-id="28ee7-1020">На портале Azure выберите колонку **Дополнительные инструменты** в области **Средства разработки**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1020">In the Azure portal, select the **Advanced Tools** blade in the **DEVELOPMENT TOOLS** area.</span></span> <span data-ttu-id="28ee7-1021">Нажмите кнопку **Перейти&rarr;** .</span><span class="sxs-lookup"><span data-stu-id="28ee7-1021">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="28ee7-1022">Консоль Kudu открывается в новой вкладке или в окне браузера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1022">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="28ee7-1023">С помощью панели навигации в верхней части страницы откройте **Консоль отладки** и выберите **CMD**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1023">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="28ee7-1024">Откройте папки на пути **сайт** > **wwwroot** и прокрутите список вниз, пока в нижней части не появится файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1024">Open the folders to the path **site** > **wwwroot** and scroll down to reveal the *web.config* file at the bottom of the list.</span></span>
1. <span data-ttu-id="28ee7-1025">Щелкните значок карандаша рядом с файлом *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1025">Click the pencil icon next to the *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-1026">Установите для параметра **stdoutLogEnabled** значение `true` и измените путь **stdoutLogFile** на `\\?\%home%\LogFiles\stdout`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1026">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to: `\\?\%home%\LogFiles\stdout`.</span></span>
1. <span data-ttu-id="28ee7-1027">Выберите **Сохранить** для сохранения обновленного файла *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1027">Select **Save** to save the updated *web.config* file.</span></span>

<span data-ttu-id="28ee7-1028">Перейдите к активации ведения журнала диагностики, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1028">Proceed to activate diagnostic logging:</span></span>

1. <span data-ttu-id="28ee7-1029">На портале Azure выберите колонку **Журналы диагностики**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1029">In the Azure portal, select the **Diagnostics logs** blade.</span></span>
1. <span data-ttu-id="28ee7-1030">Выберите положение переключателя **Вкл.** для **Вход в приложения (файловая система)** и **Подробные сообщения об ошибках**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1030">Select the **On** switch for **Application Logging (Filesystem)** and **Detailed error messages**.</span></span> <span data-ttu-id="28ee7-1031">В верхней части колонки нажмите кнопку **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1031">Select the **Save** button at the top of the blade.</span></span>
1. <span data-ttu-id="28ee7-1032">Чтобы включить трассировку неудачно завершенных запросов, также известную как ведение журнала буферизации событий неудачных запросов (FREB), установите положение переключателя **Вкл.** для **Трассировки неудачно завершенных запросов**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1032">To include failed request tracing, also known as Failed Request Event Buffering (FREB) logging, select the **On** switch for **Failed request tracing**.</span></span>
1. <span data-ttu-id="28ee7-1033">На портале выберите колонку **Поток журнала**, которая в списке отображается сразу под колонкой **Журналы диагностики**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1033">Select the **Log stream** blade, which is listed immediately under the **Diagnostics logs** blade in the portal.</span></span>
1. <span data-ttu-id="28ee7-1034">Сделайте запрос к приложению.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1034">Make a request to the app.</span></span>
1. <span data-ttu-id="28ee7-1035">В пределах данных потока журнала указывается причина ошибки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1035">Within the log stream data, the cause of the error is indicated.</span></span>

<span data-ttu-id="28ee7-1036">После завершения устранения неполадок обязательно отключите ведение журнала stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1036">Be sure to disable stdout logging when troubleshooting is complete.</span></span>

<span data-ttu-id="28ee7-1037">Чтобы просмотреть журналы трассировки неудачно завершенных запросов (журналы FREB), выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1037">To view the failed request tracing logs (FREB logs):</span></span>

1. <span data-ttu-id="28ee7-1038">Перейдите к колонке **Диагностика и решение проблем** на портале Azure.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1038">Navigate to the **Diagnose and solve problems** blade in the Azure portal.</span></span>
1. <span data-ttu-id="28ee7-1039">Выберите **Журналы трассировки неудачно завершенных запросов** из области боковой панели **Средства поддержки**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1039">Select **Failed Request Tracing Logs** from the **SUPPORT TOOLS** area of the sidebar.</span></span>

<span data-ttu-id="28ee7-1040">Для получения дополнительной информации см. [Раздел "Трассировка неудачно завершенных запросов" раздела "Включение ведения журналов диагностики для веб-приложений в службе приложений Azure"](/azure/app-service/web-sites-enable-diagnostic-log#failed-request-traces) и ["Вопросы и ответы о производительности приложений для веб-приложений в Azure: как включить трассировку неудачно завершенных запросов?"](/azure/app-service/app-service-web-availability-performance-application-issues-faq#how-do-i-turn-on-failed-request-tracing)</span><span class="sxs-lookup"><span data-stu-id="28ee7-1040">See [Failed request traces section of the Enable diagnostics logging for web apps in Azure App Service topic](/azure/app-service/web-sites-enable-diagnostic-log#failed-request-traces) and the [Application performance FAQs for Web Apps in Azure: How do I turn on failed request tracing?](/azure/app-service/app-service-web-availability-performance-application-issues-faq#how-do-i-turn-on-failed-request-tracing) for more information.</span></span>

<span data-ttu-id="28ee7-1041">Дополнительные сведения см. в разделе [Включение функции ведения журналов диагностики для веб-приложений в службе приложений Azure](/azure/app-service/web-sites-enable-diagnostic-log).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1041">For more information, see [Enable diagnostics logging for web apps in Azure App Service](/azure/app-service/web-sites-enable-diagnostic-log).</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-1042">Ошибка при отключении журнала stdout может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1042">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-1043">Ни размер файла журнала, ни количество создаваемых файлов журналов ничем не ограничены.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1043">There's no limit on log file size or the number of log files created.</span></span>
>
> <span data-ttu-id="28ee7-1044">Для обычного ведения журналов для приложения ASP.NET Core используйте библиотеку, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1044">For routine logging in an ASP.NET Core app, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-1045">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1045">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

## <a name="troubleshoot-on-iis"></a><span data-ttu-id="28ee7-1046">Устранение неполадок в IIS</span><span class="sxs-lookup"><span data-stu-id="28ee7-1046">Troubleshoot on IIS</span></span>

### <a name="application-event-log-iis"></a><span data-ttu-id="28ee7-1047">Журнал событий приложений (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-1047">Application Event Log (IIS)</span></span>

<span data-ttu-id="28ee7-1048">Доступ к журналу событий приложений</span><span class="sxs-lookup"><span data-stu-id="28ee7-1048">Access the Application Event Log:</span></span>

1. <span data-ttu-id="28ee7-1049">Откройте меню "Пуск", выполните поиск по фразе *Просмотр событий* и выберите приложение **Просмотр событий**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1049">Open the Start menu, search for *Event Viewer*, and select the **Event Viewer** app.</span></span>
1. <span data-ttu-id="28ee7-1050">В **средстве просмотра событий** откройте узел **Журналы Windows**.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1050">In **Event Viewer**, open the **Windows Logs** node.</span></span>
1. <span data-ttu-id="28ee7-1051">Выберите **Приложение**, чтобы открыть журнал событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1051">Select **Application** to open the Application Event Log.</span></span>
1. <span data-ttu-id="28ee7-1052">Проверьте здесь наличие ошибок, связанных с проблемным приложением.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1052">Search for errors associated with the failing app.</span></span> <span data-ttu-id="28ee7-1053">Нам нужны ошибки со значениями *Модуль IIS AspNetCore* или *Модуль IIS Express AspNetCore* в столбце *Источник*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1053">Errors have a value of *IIS AspNetCore Module* or *IIS Express AspNetCore Module* in the *Source* column.</span></span>

### <a name="run-the-app-at-a-command-prompt"></a><span data-ttu-id="28ee7-1054">Запуск приложения в командной строке</span><span class="sxs-lookup"><span data-stu-id="28ee7-1054">Run the app at a command prompt</span></span>

<span data-ttu-id="28ee7-1055">Многие ошибки запуска не создают полезные сведения в журнале событий приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1055">Many startup errors don't produce useful information in the Application Event Log.</span></span> <span data-ttu-id="28ee7-1056">Для некоторых ошибок можно найти причину, запустив приложение в командной строке на компьютере размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1056">You can find the cause of some errors by running the app at a command prompt on the hosting system.</span></span>

#### <a name="framework-dependent-deployment"></a><span data-ttu-id="28ee7-1057">развертывание, зависящее от платформы;</span><span class="sxs-lookup"><span data-stu-id="28ee7-1057">Framework-dependent deployment</span></span>

<span data-ttu-id="28ee7-1058">Если развертываемое приложение [зависит от платформы](/dotnet/core/deploying/#framework-dependent-deployments-fdd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-1058">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd):</span></span>

1. <span data-ttu-id="28ee7-1059">В командной строке перейдите в папку развертывания и запустите приложение, выполнив команду *dotnet.exe* для сборки приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1059">At a command prompt, navigate to the deployment folder and run the app by executing the app's assembly with *dotnet.exe*.</span></span> <span data-ttu-id="28ee7-1060">В следующей команде укажите нужное имя сборки вместо заполнителя \<assembly_name>: `dotnet .\<assembly_name>.dll`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1060">In the following command, substitute the name of the app's assembly for \<assembly_name>: `dotnet .\<assembly_name>.dll`.</span></span>
1. <span data-ttu-id="28ee7-1061">Выходные данные приложения, в том числе любые ошибки, будут выведены в окно консоли.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1061">The console output from the app, showing any errors, is written to the console window.</span></span>
1. <span data-ttu-id="28ee7-1062">Если ошибки возникают при выполнении запроса к приложению, выполните запрос к узлу и порту, где Kestrel ожидает передачи данных.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1062">If the errors occur when making a request to the app, make a request to the host and port where Kestrel listens.</span></span> <span data-ttu-id="28ee7-1063">Создайте запрос к `http://localhost:5000/`, используя узел и порт по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1063">Using the default host and post, make a request to `http://localhost:5000/`.</span></span> <span data-ttu-id="28ee7-1064">Если приложение отвечает на запросы по адресу конечной точки Kestrel как обычно, то проблема, вероятнее, связана с конфигурацией размещения, а не с самим приложением.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1064">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the hosting configuration and less likely within the app.</span></span>

#### <a name="self-contained-deployment"></a><span data-ttu-id="28ee7-1065">автономное развертывание;</span><span class="sxs-lookup"><span data-stu-id="28ee7-1065">Self-contained deployment</span></span>

<span data-ttu-id="28ee7-1066">Если приложение [развертывается автономно](/dotnet/core/deploying/#self-contained-deployments-scd), сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-1066">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd):</span></span>

1. <span data-ttu-id="28ee7-1067">В командной строке перейдите в папку развертывания и запустите исполняемый файл приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1067">At a command prompt, navigate to the deployment folder and run the app's executable.</span></span> <span data-ttu-id="28ee7-1068">В следующей команде укажите нужное имя сборки вместо заполнителя \<assembly_name>: `<assembly_name>.exe`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1068">In the following command, substitute the name of the app's assembly for \<assembly_name>: `<assembly_name>.exe`.</span></span>
1. <span data-ttu-id="28ee7-1069">Выходные данные приложения, в том числе любые ошибки, будут выведены в окно консоли.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1069">The console output from the app, showing any errors, is written to the console window.</span></span>
1. <span data-ttu-id="28ee7-1070">Если ошибки возникают при выполнении запроса к приложению, выполните запрос к узлу и порту, где Kestrel ожидает передачи данных.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1070">If the errors occur when making a request to the app, make a request to the host and port where Kestrel listens.</span></span> <span data-ttu-id="28ee7-1071">Создайте запрос к `http://localhost:5000/`, используя узел и порт по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1071">Using the default host and post, make a request to `http://localhost:5000/`.</span></span> <span data-ttu-id="28ee7-1072">Если приложение отвечает на запросы по адресу конечной точки Kestrel как обычно, то проблема, вероятнее, связана с конфигурацией размещения, а не с самим приложением.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1072">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the hosting configuration and less likely within the app.</span></span>

### <a name="aspnet-core-module-stdout-log-iis"></a><span data-ttu-id="28ee7-1073">Журнал вывода stdout модуля ASP.NET Core (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-1073">ASP.NET Core Module stdout log (IIS)</span></span>

<span data-ttu-id="28ee7-1074">Чтобы включить и просмотреть журналы stdout, сделайте следующее:</span><span class="sxs-lookup"><span data-stu-id="28ee7-1074">To enable and view stdout logs:</span></span>

1. <span data-ttu-id="28ee7-1075">Перейдите в папку развертывания сайта на компьютере размещения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1075">Navigate to the site's deployment folder on the hosting system.</span></span>
1. <span data-ttu-id="28ee7-1076">Если здесь нет папки *logs*, создайте ее.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1076">If the *logs* folder isn't present, create the folder.</span></span> <span data-ttu-id="28ee7-1077">Сведения о том, как настроить в MSBuild автоматическое создание папки *logs* в развертывании, см. в статье [о структуре каталогов](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1077">For instructions on how to enable MSBuild to create the *logs* folder in the deployment automatically, see the [Directory structure](xref:host-and-deploy/directory-structure) topic.</span></span>
1. <span data-ttu-id="28ee7-1078">Измените файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1078">Edit the *web.config* file.</span></span> <span data-ttu-id="28ee7-1079">Задайте для параметра **stdoutLogEnabled** значение `true` и измените путь **stdoutLogFile** так, чтобы он указывал на папку *logs* (например, `.\logs\stdout`).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1079">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to point to the *logs* folder (for example, `.\logs\stdout`).</span></span> <span data-ttu-id="28ee7-1080">В этом пути `stdout` обозначает префикс имени для файла журнала.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1080">`stdout` in the path is the log file name prefix.</span></span> <span data-ttu-id="28ee7-1081">При создании файла журнала автоматически добавляются метка времени, идентификатор процесса и расширение файла.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1081">A timestamp, process id, and file extension are added automatically when the log is created.</span></span> <span data-ttu-id="28ee7-1082">Если указан префикс файла `stdout`, стандартный файл журнала будет иметь примерно такое имя: *stdout_20180205184032_5412.log*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1082">Using `stdout` as the file name prefix, a typical log file is named *stdout_20180205184032_5412.log*.</span></span>
1. <span data-ttu-id="28ee7-1083">Убедитесь, что удостоверение пула приложений имеет разрешения на запись в папку *logs*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1083">Ensure your application pool's identity has write permissions to the *logs* folder.</span></span>
1. <span data-ttu-id="28ee7-1084">Сохраните обновленный файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1084">Save the updated *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-1085">Сделайте запрос к приложению.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1085">Make a request to the app.</span></span>
1. <span data-ttu-id="28ee7-1086">Перейдите в папку *logs*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1086">Navigate to the *logs* folder.</span></span> <span data-ttu-id="28ee7-1087">Найдите и откройте последний журнал вывода stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1087">Find and open the most recent stdout log.</span></span>
1. <span data-ttu-id="28ee7-1088">Проверьте, нет ли в нем ошибок.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1088">Study the log for errors.</span></span>

<span data-ttu-id="28ee7-1089">Завершив устранение неполадок, отключите ведение журнала stdout.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1089">Disable stdout logging when troubleshooting is complete:</span></span>

1. <span data-ttu-id="28ee7-1090">Измените файл *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1090">Edit the *web.config* file.</span></span>
1. <span data-ttu-id="28ee7-1091">Задайте параметру **stdoutLogEnabled** значение `false`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1091">Set **stdoutLogEnabled** to `false`.</span></span>
1. <span data-ttu-id="28ee7-1092">Сохраните файл.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1092">Save the file.</span></span>

<span data-ttu-id="28ee7-1093">Для получения дополнительной информации см. <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1093">For more information, see <xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection>.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-1094">Ошибка при отключении журнала stdout может привести к сбоям приложения или сервера.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1094">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="28ee7-1095">Ни размер файла журнала, ни количество создаваемых файлов журналов ничем не ограничены.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1095">There's no limit on log file size or the number of log files created.</span></span>
>
> <span data-ttu-id="28ee7-1096">Для обычного ведения журналов для приложения ASP.NET Core используйте библиотеку, которая ограничивает размер файла журнала и выполняет циклический сдвиг журналов.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1096">For routine logging in an ASP.NET Core app, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="28ee7-1097">Дополнительные сведения см. в разделе [Сторонние поставщики ведения журналов](xref:fundamentals/logging/index#third-party-logging-providers).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1097">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

### <a name="enable-the-developer-exception-page"></a><span data-ttu-id="28ee7-1098">Включение страницы исключений для разработчика</span><span class="sxs-lookup"><span data-stu-id="28ee7-1098">Enable the Developer Exception Page</span></span>

<span data-ttu-id="28ee7-1099">Можно добавить переменную среды `ASPNETCORE_ENVIRONMENT` [в файл web.config](xref:host-and-deploy/aspnet-core-module#setting-environment-variables), чтобы запустить приложение в среде разработки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1099">The `ASPNETCORE_ENVIRONMENT` [environment variable can be added to web.config](xref:host-and-deploy/aspnet-core-module#setting-environment-variables) to run the app in the Development environment.</span></span> <span data-ttu-id="28ee7-1100">Если среда не переопределяется при запуске приложения использованием `UseEnvironment` в конструкторе узла, эта переменная среды позволяет отображать [страницу исключения для разработчика](xref:fundamentals/error-handling) при запуске приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1100">As long as the environment isn't overridden in app startup by `UseEnvironment` on the host builder, setting the environment variable allows the [Developer Exception Page](xref:fundamentals/error-handling) to appear when the app is run.</span></span>

```xml
<aspNetCore processPath="dotnet"
      arguments=".\MyApp.dll"
      stdoutLogEnabled="false"
      stdoutLogFile=".\logs\stdout">
  <environmentVariables>
    <environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Development" />
  </environmentVariables>
</aspNetCore>
```

<span data-ttu-id="28ee7-1101">Настройка переменной среды `ASPNETCORE_ENVIRONMENT` рекомендуется только на промежуточных и тестовых серверах, доступ к которым из Интернета закрыт.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1101">Setting the environment variable for `ASPNETCORE_ENVIRONMENT` is only recommended for use on staging and testing servers that aren't exposed to the Internet.</span></span> <span data-ttu-id="28ee7-1102">Завершив устранение неполадок, удалите эту переменную среды из файла *web.config*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1102">Remove the environment variable from the *web.config* file after troubleshooting.</span></span> <span data-ttu-id="28ee7-1103">Сведения о настройке переменных среды в файле *web.config* см. в статье о [дочернем элементе environmentVariables в aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1103">For information on setting environment variables in *web.config*, see [environmentVariables child element of aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span></span>

### <a name="obtain-data-from-an-app"></a><span data-ttu-id="28ee7-1104">Получение данных из приложения</span><span class="sxs-lookup"><span data-stu-id="28ee7-1104">Obtain data from an app</span></span>

<span data-ttu-id="28ee7-1105">Если приложение способно отвечать на запросы, получите данные о запросе, подключении и дополнительные данные из приложений с помощью встроенного терминала ПО промежуточного слоя.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1105">If an app is capable of responding to requests, obtain request, connection, and additional data from the app using terminal inline middleware.</span></span> <span data-ttu-id="28ee7-1106">Дополнительные сведения и примеры с кодом см. здесь: <xref:test/troubleshoot#obtain-data-from-an-app>.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1106">For more information and sample code, see <xref:test/troubleshoot#obtain-data-from-an-app>.</span></span>

### <a name="slow-or-hanging-app-iis"></a><span data-ttu-id="28ee7-1107">Медленное или зависающее приложение (IIS)</span><span class="sxs-lookup"><span data-stu-id="28ee7-1107">Slow or hanging app (IIS)</span></span>

<span data-ttu-id="28ee7-1108">*Аварийный дамп* — это моментальный снимок системной памяти, который может помочь определить причину аварийного завершения, сбоя запуска или медленной работы приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1108">A *crash dump* is a snapshot of the system's memory and can help determine the cause of an app crash, startup failure, or slow app.</span></span>

#### <a name="app-crashes-or-encounters-an-exception"></a><span data-ttu-id="28ee7-1109">Аварийное завершение работы приложения или исключение</span><span class="sxs-lookup"><span data-stu-id="28ee7-1109">App crashes or encounters an exception</span></span>

<span data-ttu-id="28ee7-1110">Получите и проанализируйте дамп из [отчетов об ошибках Windows (WER)](/windows/desktop/wer/windows-error-reporting):</span><span class="sxs-lookup"><span data-stu-id="28ee7-1110">Obtain and analyze a dump from [Windows Error Reporting (WER)](/windows/desktop/wer/windows-error-reporting):</span></span>

1. <span data-ttu-id="28ee7-1111">Создайте папку для хранения файлов аварийного дампа в `c:\dumps`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1111">Create a folder to hold crash dump files at `c:\dumps`.</span></span> <span data-ttu-id="28ee7-1112">Пул приложений должен иметь доступ на запись к папке.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1112">The app pool must have write access to the folder.</span></span>
1. <span data-ttu-id="28ee7-1113">Запустите [скрипт PowerShell EnableDumps](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/EnableDumps.ps1):</span><span class="sxs-lookup"><span data-stu-id="28ee7-1113">Run the [EnableDumps PowerShell script](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/EnableDumps.ps1):</span></span>
   * <span data-ttu-id="28ee7-1114">Если приложение использует [модель размещения в процессе](xref:host-and-deploy/iis/index#in-process-hosting-model), выполните скрипт для *w3wp.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-1114">If the app uses the [in-process hosting model](xref:host-and-deploy/iis/index#in-process-hosting-model), run the script for *w3wp.exe*:</span></span>

     ```console
     .\EnableDumps w3wp.exe c:\dumps
     ```

   * <span data-ttu-id="28ee7-1115">Если приложение использует [модель размещения вне процесса](xref:host-and-deploy/iis/index#out-of-process-hosting-model), выполните скрипт для *dotnet.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-1115">If the app uses the [out-of-process hosting model](xref:host-and-deploy/iis/index#out-of-process-hosting-model), run the script for *dotnet.exe*:</span></span>

     ```console
     .\EnableDumps dotnet.exe c:\dumps
     ```

1. <span data-ttu-id="28ee7-1116">Запустите приложение в условиях, вызывающих аварийное завершение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1116">Run the app under the conditions that cause the crash to occur.</span></span>
1. <span data-ttu-id="28ee7-1117">После аварийного завершения запустите [скрипт PowerShell DisableDumps](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/DisableDumps.ps1):</span><span class="sxs-lookup"><span data-stu-id="28ee7-1117">After the crash has occurred, run the [DisableDumps PowerShell script](https://github.com/dotnet/AspNetCore.Docs/blob/master/aspnetcore/test/troubleshoot-azure-iis/scripts/DisableDumps.ps1):</span></span>
   * <span data-ttu-id="28ee7-1118">Если приложение использует [модель размещения в процессе](xref:host-and-deploy/iis/index#in-process-hosting-model), выполните скрипт для *w3wp.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-1118">If the app uses the [in-process hosting model](xref:host-and-deploy/iis/index#in-process-hosting-model), run the script for *w3wp.exe*:</span></span>

     ```console
     .\DisableDumps w3wp.exe
     ```

   * <span data-ttu-id="28ee7-1119">Если приложение использует [модель размещения вне процесса](xref:host-and-deploy/iis/index#out-of-process-hosting-model), выполните скрипт для *dotnet.exe*:</span><span class="sxs-lookup"><span data-stu-id="28ee7-1119">If the app uses the [out-of-process hosting model](xref:host-and-deploy/iis/index#out-of-process-hosting-model), run the script for *dotnet.exe*:</span></span>

     ```console
     .\DisableDumps dotnet.exe
     ```

<span data-ttu-id="28ee7-1120">Когда приложение аварийно завершит работу и сбор дампов будет выполнен, приложение сможет завершить работу обычным образом.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1120">After an app crashes and dump collection is complete, the app is allowed to terminate normally.</span></span> <span data-ttu-id="28ee7-1121">Скрипт PowerShell настраивает отчеты об ошибках Windows для сбора до пяти дампов для приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1121">The PowerShell script configures WER to collect up to five dumps per app.</span></span>

> [!WARNING]
> <span data-ttu-id="28ee7-1122">Аварийные дампы могут занимать много места на диске (до нескольких гигабайтов каждый).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1122">Crash dumps might take up a large amount of disk space (up to several gigabytes each).</span></span>

#### <a name="app-hangs-fails-during-startup-or-runs-normally"></a><span data-ttu-id="28ee7-1123">Приложение перестает отвечать на запросы, не запускается или работает в обычном режиме</span><span class="sxs-lookup"><span data-stu-id="28ee7-1123">App hangs, fails during startup, or runs normally</span></span>

<span data-ttu-id="28ee7-1124">Когда приложение *перестает отвечать на запросы* (но аварийное завершение не происходит), не запускается или работает в обычном режиме, см. раздел [Файлы дампа пользовательского режима: выбор лучшего инструмента](/windows-hardware/drivers/debugger/user-mode-dump-files#choosing-the-best-tool), чтобы выбрать подходящий инструмент для создания дампа.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1124">When an app *hangs* (stops responding but doesn't crash), fails during startup, or runs normally, see [User-Mode Dump Files: Choosing the Best Tool](/windows-hardware/drivers/debugger/user-mode-dump-files#choosing-the-best-tool) to select an appropriate tool to produce the dump.</span></span>

#### <a name="analyze-the-dump"></a><span data-ttu-id="28ee7-1125">Анализ дампа</span><span class="sxs-lookup"><span data-stu-id="28ee7-1125">Analyze the dump</span></span>

<span data-ttu-id="28ee7-1126">Дамп можно проанализировать несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1126">A dump can be analyzed using several approaches.</span></span> <span data-ttu-id="28ee7-1127">Дополнительные сведения см. в разделе [Анализ файла дампа пользовательского режима](/windows-hardware/drivers/debugger/analyzing-a-user-mode-dump-file).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1127">For more information, see [Analyzing a User-Mode Dump File](/windows-hardware/drivers/debugger/analyzing-a-user-mode-dump-file).</span></span>

## <a name="clear-package-caches"></a><span data-ttu-id="28ee7-1128">Очистка кэшей пакетов</span><span class="sxs-lookup"><span data-stu-id="28ee7-1128">Clear package caches</span></span>

<span data-ttu-id="28ee7-1129">Приложения-функции могут перестать работать сразу после обновления пакета SDK для .NET Core на компьютере разработки или обновления версии пакетов в самом приложении.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1129">A functioning app may fail immediately after upgrading either the .NET Core SDK on the development machine or changing package versions within the app.</span></span> <span data-ttu-id="28ee7-1130">В некоторых случаях в результате важного обновления несогласованные версии пакетов могут привести к нарушению работы приложения.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1130">In some cases, incoherent packages may break an app when performing major upgrades.</span></span> <span data-ttu-id="28ee7-1131">Большинство этих проблем можно исправить следующим образом:</span><span class="sxs-lookup"><span data-stu-id="28ee7-1131">Most of these issues can be fixed by following these instructions:</span></span>

1. <span data-ttu-id="28ee7-1132">Удалите папки *bin* и *obj*.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1132">Delete the *bin* and *obj* folders.</span></span>
1. <span data-ttu-id="28ee7-1133">Очистите кэши пакетов, выполнив команду [dotnet nuget locals all --clear](/dotnet/core/tools/dotnet-nuget-locals) из командной оболочки.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1133">Clear the package caches by executing [dotnet nuget locals all --clear](/dotnet/core/tools/dotnet-nuget-locals) from a command shell.</span></span>

   <span data-ttu-id="28ee7-1134">Очистку кэшей пакетов также можно выполнить с помощью средства [nuget.exe](https://www.nuget.org/downloads) или команды `nuget locals all -clear`.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1134">Clearing package caches can also be accomplished with the [nuget.exe](https://www.nuget.org/downloads) tool and executing the command `nuget locals all -clear`.</span></span> <span data-ttu-id="28ee7-1135">*NuGet.exe* не входит в пакет установки операционной системы Windows для настольных компьютеров и его нужно получить отдельно на [веб-сайте NuGet](https://www.nuget.org/downloads).</span><span class="sxs-lookup"><span data-stu-id="28ee7-1135">*nuget.exe* isn't a bundled install with the Windows desktop operating system and must be obtained separately from the [NuGet website](https://www.nuget.org/downloads).</span></span>

1. <span data-ttu-id="28ee7-1136">Восстановите и перестройте проект.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1136">Restore and rebuild the project.</span></span>
1. <span data-ttu-id="28ee7-1137">Удалите все файлы из папки развертывания на сервере, прежде чем повторно развернуть приложение.</span><span class="sxs-lookup"><span data-stu-id="28ee7-1137">Delete all of the files in the deployment folder on the server prior to redeploying the app.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="28ee7-1138">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="28ee7-1138">Additional resources</span></span>

* <xref:test/troubleshoot>
* <xref:host-and-deploy/azure-iis-errors-reference>
* <xref:fundamentals/error-handling>
* <xref:host-and-deploy/aspnet-core-module>

### <a name="azure-documentation"></a><span data-ttu-id="28ee7-1139">Документация по Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-1139">Azure documentation</span></span>

* [<span data-ttu-id="28ee7-1140">Application Insights для ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="28ee7-1140">Application Insights for ASP.NET Core</span></span>](/azure/application-insights/app-insights-asp-net-core)
* [<span data-ttu-id="28ee7-1141">Раздел "Веб-приложения удаленной отладки" статьи "Устранение неполадок веб-приложения в Службе приложений Azure с помощью Visual Studio"</span><span class="sxs-lookup"><span data-stu-id="28ee7-1141">Remote debugging web apps section of Troubleshoot a web app in Azure App Service using Visual Studio</span></span>](/azure/app-service/web-sites-dotnet-troubleshoot-visual-studio#remotedebug)
* [<span data-ttu-id="28ee7-1142">Общие сведения о диагностике в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-1142">Azure App Service diagnostics overview</span></span>](/azure/app-service/app-service-diagnostics)
* [<span data-ttu-id="28ee7-1143">Практическое руководство. Мониторинг приложений в Службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-1143">How to: Monitor Apps in Azure App Service</span></span>](/azure/app-service/web-sites-monitor)
* [<span data-ttu-id="28ee7-1144">Устранение неполадок веб-приложения в службе приложений Azure с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="28ee7-1144">Troubleshoot a web app in Azure App Service using Visual Studio</span></span>](/azure/app-service/web-sites-dotnet-troubleshoot-visual-studio)
* [<span data-ttu-id="28ee7-1145">Устранение ошибок HTTP "502 — недопустимый шлюз" и "503 — служба недоступна" в веб-приложениях Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-1145">Troubleshoot HTTP errors of "502 bad gateway" and "503 service unavailable" in your Azure web apps</span></span>](/azure/app-service/app-service-web-troubleshoot-http-502-http-503)
* [<span data-ttu-id="28ee7-1146">Устранение проблем с производительностью медленных веб приложений в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-1146">Troubleshoot slow web app performance issues in Azure App Service</span></span>](/azure/app-service/app-service-web-troubleshoot-performance-degradation)
* [<span data-ttu-id="28ee7-1147">Вопросы и ответы о производительности приложений для веб-приложений в Azure</span><span class="sxs-lookup"><span data-stu-id="28ee7-1147">Application performance FAQs for Web Apps in Azure</span></span>](/azure/app-service/app-service-web-availability-performance-application-issues-faq)
* [<span data-ttu-id="28ee7-1148">"Песочница" веб-приложений Azure (ограничения работы среды выполнения службы приложений)</span><span class="sxs-lookup"><span data-stu-id="28ee7-1148">Azure Web App sandbox (App Service runtime execution limitations)</span></span>](https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox)
* [<span data-ttu-id="28ee7-1149">Пятница с Azure. Практика диагностики и устранения неполадок в Службе приложений Azure (12-минутное видео)</span><span class="sxs-lookup"><span data-stu-id="28ee7-1149">Azure Friday: Azure App Service Diagnostic and Troubleshooting Experience (12-minute video)</span></span>](https://channel9.msdn.com/Shows/Azure-Friday/Azure-App-Service-Diagnostic-and-Troubleshooting-Experience)

### <a name="visual-studio-documentation"></a><span data-ttu-id="28ee7-1150">Документация по Visual Studio</span><span class="sxs-lookup"><span data-stu-id="28ee7-1150">Visual Studio documentation</span></span>

* [<span data-ttu-id="28ee7-1151">Удаленная отладка ASP.NET Core в IIS в Azure в Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="28ee7-1151">Remote Debug ASP.NET Core on IIS in Azure in Visual Studio 2017</span></span>](/visualstudio/debugger/remote-debugging-azure)
* [<span data-ttu-id="28ee7-1152">Удаленная отладка ASP.NET Core на удаленном компьютере IIS в Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="28ee7-1152">Remote Debug ASP.NET Core on a Remote IIS Computer in Visual Studio 2017</span></span>](/visualstudio/debugger/remote-debugging-aspnet-on-a-remote-iis-computer)
* [<span data-ttu-id="28ee7-1153">Сведения об отладке с помощью Visual Studio</span><span class="sxs-lookup"><span data-stu-id="28ee7-1153">Learn to debug using Visual Studio</span></span>](/visualstudio/debugger/getting-started-with-the-debugger)

### <a name="visual-studio-code-documentation"></a><span data-ttu-id="28ee7-1154">Документация по Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="28ee7-1154">Visual Studio Code documentation</span></span>

* [<span data-ttu-id="28ee7-1155">Отладка с помощью Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="28ee7-1155">Debugging with Visual Studio Code</span></span>](https://code.visualstudio.com/docs/editor/debugging)

::: moniker-end
